[{"data":1,"prerenderedAt":15932},["ShallowReactive",2],{"navigation":3,"/tutorials/ecommerce-pipeline":23,"/tutorials/ecommerce-pipeline-surround":15929},[4,13],{"title":5,"path":6,"stem":7,"children":8,"icon":12},"Getting Started","/getting-started","1.getting-started/1.index",[9],{"title":10,"path":6,"stem":7,"icon":11},"Introduction","i-lucide-house",false,{"title":14,"path":15,"stem":16,"children":17,"page":12},"Tutorials","/tutorials","2.tutorials",[18],{"title":19,"path":20,"stem":21,"icon":22},"E-commerce Showcase","/tutorials/ecommerce-pipeline","2.tutorials/1.ecommerce-pipeline","i-lucide-shopping-cart",{"id":24,"title":19,"body":25,"description":15922,"extension":15923,"links":15924,"meta":15925,"navigation":15926,"path":20,"seo":15927,"stem":21,"__hash__":15928},"docs/2.tutorials/1.ecommerce-pipeline.md",{"type":26,"value":27,"toc":15911},"minimark",[28,31,35,1916,1924,1959,1966,1970,1995,2022,2025,2052,2055,2059,2070,2077,2151,2154,2157,2160,2218,2939,2942,2956,2959,3080,3083,3087,3090,3199,3202,3258,3269,3273,3276,3279,3286,3289,3306,3309,8115,8118,8154,8157,8391,8394,8574,8587,8591,8594,8597,8600,8622,8625,8697,8711,8714,8718,8725,8736,8742,9320,9323,9355,9358,9361,9408,9411,9430,9433,9714,9723,9727,9734,9749,12908,12914,13109,13114,13251,13269,13272,13277,13420,13423,13450,13457,13682,13685,13708,13711,14096,14099,14103,14106,14109,15897,15900,15907],[29,30],"prose-pre",{},[32,33,34],"p",{},":",[36,37,39,197,856,952,1054,1137,1407,1760],"code-tree",{"default-value":38},".bruin.yml",[40,41,46],"pre",{"className":42,"code":43,"filename":38,"language":44,"meta":45,"style":45},"language-yaml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","default_environment: default\nenvironments:\n    default:\n        connections:\n            postgres:\n                - name: pg-default\n                  username: postgres\n                  password: postgres\n                  host: localhost\n                  port: 5432\n                  database: postgres\n            duckdb:\n                - name: duckdb-default\n                  path: duckdb.db\n","yaml","",[47,48,49,65,74,82,90,98,112,123,133,144,156,166,174,186],"code",{"__ignoreMap":45},[50,51,54,58,61],"span",{"class":52,"line":53},"line",1,[50,55,57],{"class":56},"swJcz","default_environment",[50,59,34],{"class":60},"sMK4o",[50,62,64],{"class":63},"sfazB"," default\n",[50,66,68,71],{"class":52,"line":67},2,[50,69,70],{"class":56},"environments",[50,72,73],{"class":60},":\n",[50,75,77,80],{"class":52,"line":76},3,[50,78,79],{"class":56},"    default",[50,81,73],{"class":60},[50,83,85,88],{"class":52,"line":84},4,[50,86,87],{"class":56},"        connections",[50,89,73],{"class":60},[50,91,93,96],{"class":52,"line":92},5,[50,94,95],{"class":56},"            postgres",[50,97,73],{"class":60},[50,99,101,104,107,109],{"class":52,"line":100},6,[50,102,103],{"class":60},"                -",[50,105,106],{"class":56}," name",[50,108,34],{"class":60},[50,110,111],{"class":63}," pg-default\n",[50,113,115,118,120],{"class":52,"line":114},7,[50,116,117],{"class":56},"                  username",[50,119,34],{"class":60},[50,121,122],{"class":63}," postgres\n",[50,124,126,129,131],{"class":52,"line":125},8,[50,127,128],{"class":56},"                  password",[50,130,34],{"class":60},[50,132,122],{"class":63},[50,134,136,139,141],{"class":52,"line":135},9,[50,137,138],{"class":56},"                  host",[50,140,34],{"class":60},[50,142,143],{"class":63}," localhost\n",[50,145,147,150,152],{"class":52,"line":146},10,[50,148,149],{"class":56},"                  port",[50,151,34],{"class":60},[50,153,155],{"class":154},"sbssI"," 5432\n",[50,157,159,162,164],{"class":52,"line":158},11,[50,160,161],{"class":56},"                  database",[50,163,34],{"class":60},[50,165,122],{"class":63},[50,167,169,172],{"class":52,"line":168},12,[50,170,171],{"class":56},"            duckdb",[50,173,73],{"class":60},[50,175,177,179,181,183],{"class":52,"line":176},13,[50,178,103],{"class":60},[50,180,106],{"class":56},[50,182,34],{"class":60},[50,184,185],{"class":63}," duckdb-default\n",[50,187,189,192,194],{"class":52,"line":188},14,[50,190,191],{"class":56},"                  path",[50,193,34],{"class":60},[50,195,196],{"class":63}," duckdb.db\n",[40,198,201],{"className":42,"code":199,"filename":200,"language":44,"meta":45,"style":45},"domains:\n  customer-management:\n    description: All aspects related to customer data, registration, and account management\n    owners:\n      - \"Data Team\"\n    tags:\n      - customer\n  product-catalog:\n    description: Product and catalog data including variants and SKUs\n    owners:\n      - \"Data Team\"\n    tags:\n      - product\n      - catalog\n  sales:\n    description: Orders and order items lifecycle data\n    owners:\n      - \"Data Team\"\n    tags:\n      - sales\n\nentities:\n  Base:\n    description: Required fields for every Ingestion/Staging step.\n    attributes:\n      ID:\n        name: id\n        type: integer\n        primary_key: true\n        description: The unique identifier in our systems.\n        checks:\n          - name: not_null\n          - name: unique\n      CreatedAt:\n        name: created_at\n        type: timestamp\n        description: Timestamp when the record was created.\n        checks:\n          - name: not_null\n      UpdatedAt:\n        name: updated_at\n        type: timestamp\n        description: Timestamp when the record was last updated.\n        checks:\n          - name: not_null\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      ID:\n        name: customer_id\n        type: integer\n        checks:\n          - name: not_null\n          - name: unique\n      Email:\n        name: email\n        type: string\n        checks:\n          - name: not_null\n      FullName:\n        name: full_name\n        type: string\n      Country:\n        name: country\n        type: string\n      Age:\n        name: age\n        type: integer\n        checks:\n          - name: range\n            min: 0\n","glossary.yml",[47,202,203,210,217,227,234,248,255,262,269,278,284,294,300,307,314,322,332,339,350,357,365,372,380,388,398,406,414,425,436,448,459,467,480,492,500,510,520,530,537,548,556,566,575,585,592,603,611,621,629,637,644,651,661,670,677,688,699,707,717,727,734,745,753,763,772,780,790,799,807,817,826,833,845],{"__ignoreMap":45},[50,204,205,208],{"class":52,"line":53},[50,206,207],{"class":56},"domains",[50,209,73],{"class":60},[50,211,212,215],{"class":52,"line":67},[50,213,214],{"class":56},"  customer-management",[50,216,73],{"class":60},[50,218,219,222,224],{"class":52,"line":76},[50,220,221],{"class":56},"    description",[50,223,34],{"class":60},[50,225,226],{"class":63}," All aspects related to customer data, registration, and account management\n",[50,228,229,232],{"class":52,"line":84},[50,230,231],{"class":56},"    owners",[50,233,73],{"class":60},[50,235,236,239,242,245],{"class":52,"line":92},[50,237,238],{"class":60},"      -",[50,240,241],{"class":60}," \"",[50,243,244],{"class":63},"Data Team",[50,246,247],{"class":60},"\"\n",[50,249,250,253],{"class":52,"line":100},[50,251,252],{"class":56},"    tags",[50,254,73],{"class":60},[50,256,257,259],{"class":52,"line":114},[50,258,238],{"class":60},[50,260,261],{"class":63}," customer\n",[50,263,264,267],{"class":52,"line":125},[50,265,266],{"class":56},"  product-catalog",[50,268,73],{"class":60},[50,270,271,273,275],{"class":52,"line":135},[50,272,221],{"class":56},[50,274,34],{"class":60},[50,276,277],{"class":63}," Product and catalog data including variants and SKUs\n",[50,279,280,282],{"class":52,"line":146},[50,281,231],{"class":56},[50,283,73],{"class":60},[50,285,286,288,290,292],{"class":52,"line":158},[50,287,238],{"class":60},[50,289,241],{"class":60},[50,291,244],{"class":63},[50,293,247],{"class":60},[50,295,296,298],{"class":52,"line":168},[50,297,252],{"class":56},[50,299,73],{"class":60},[50,301,302,304],{"class":52,"line":176},[50,303,238],{"class":60},[50,305,306],{"class":63}," product\n",[50,308,309,311],{"class":52,"line":188},[50,310,238],{"class":60},[50,312,313],{"class":63}," catalog\n",[50,315,317,320],{"class":52,"line":316},15,[50,318,319],{"class":56},"  sales",[50,321,73],{"class":60},[50,323,325,327,329],{"class":52,"line":324},16,[50,326,221],{"class":56},[50,328,34],{"class":60},[50,330,331],{"class":63}," Orders and order items lifecycle data\n",[50,333,335,337],{"class":52,"line":334},17,[50,336,231],{"class":56},[50,338,73],{"class":60},[50,340,342,344,346,348],{"class":52,"line":341},18,[50,343,238],{"class":60},[50,345,241],{"class":60},[50,347,244],{"class":63},[50,349,247],{"class":60},[50,351,353,355],{"class":52,"line":352},19,[50,354,252],{"class":56},[50,356,73],{"class":60},[50,358,360,362],{"class":52,"line":359},20,[50,361,238],{"class":60},[50,363,364],{"class":63}," sales\n",[50,366,368],{"class":52,"line":367},21,[50,369,371],{"emptyLinePlaceholder":370},true,"\n",[50,373,375,378],{"class":52,"line":374},22,[50,376,377],{"class":56},"entities",[50,379,73],{"class":60},[50,381,383,386],{"class":52,"line":382},23,[50,384,385],{"class":56},"  Base",[50,387,73],{"class":60},[50,389,391,393,395],{"class":52,"line":390},24,[50,392,221],{"class":56},[50,394,34],{"class":60},[50,396,397],{"class":63}," Required fields for every Ingestion/Staging step.\n",[50,399,401,404],{"class":52,"line":400},25,[50,402,403],{"class":56},"    attributes",[50,405,73],{"class":60},[50,407,409,412],{"class":52,"line":408},26,[50,410,411],{"class":56},"      ID",[50,413,73],{"class":60},[50,415,417,420,422],{"class":52,"line":416},27,[50,418,419],{"class":56},"        name",[50,421,34],{"class":60},[50,423,424],{"class":63}," id\n",[50,426,428,431,433],{"class":52,"line":427},28,[50,429,430],{"class":56},"        type",[50,432,34],{"class":60},[50,434,435],{"class":63}," integer\n",[50,437,439,442,444],{"class":52,"line":438},29,[50,440,441],{"class":56},"        primary_key",[50,443,34],{"class":60},[50,445,447],{"class":446},"sfNiH"," true\n",[50,449,451,454,456],{"class":52,"line":450},30,[50,452,453],{"class":56},"        description",[50,455,34],{"class":60},[50,457,458],{"class":63}," The unique identifier in our systems.\n",[50,460,462,465],{"class":52,"line":461},31,[50,463,464],{"class":56},"        checks",[50,466,73],{"class":60},[50,468,470,473,475,477],{"class":52,"line":469},32,[50,471,472],{"class":60},"          -",[50,474,106],{"class":56},[50,476,34],{"class":60},[50,478,479],{"class":63}," not_null\n",[50,481,483,485,487,489],{"class":52,"line":482},33,[50,484,472],{"class":60},[50,486,106],{"class":56},[50,488,34],{"class":60},[50,490,491],{"class":63}," unique\n",[50,493,495,498],{"class":52,"line":494},34,[50,496,497],{"class":56},"      CreatedAt",[50,499,73],{"class":60},[50,501,503,505,507],{"class":52,"line":502},35,[50,504,419],{"class":56},[50,506,34],{"class":60},[50,508,509],{"class":63}," created_at\n",[50,511,513,515,517],{"class":52,"line":512},36,[50,514,430],{"class":56},[50,516,34],{"class":60},[50,518,519],{"class":63}," timestamp\n",[50,521,523,525,527],{"class":52,"line":522},37,[50,524,453],{"class":56},[50,526,34],{"class":60},[50,528,529],{"class":63}," Timestamp when the record was created.\n",[50,531,533,535],{"class":52,"line":532},38,[50,534,464],{"class":56},[50,536,73],{"class":60},[50,538,540,542,544,546],{"class":52,"line":539},39,[50,541,472],{"class":60},[50,543,106],{"class":56},[50,545,34],{"class":60},[50,547,479],{"class":63},[50,549,551,554],{"class":52,"line":550},40,[50,552,553],{"class":56},"      UpdatedAt",[50,555,73],{"class":60},[50,557,559,561,563],{"class":52,"line":558},41,[50,560,419],{"class":56},[50,562,34],{"class":60},[50,564,565],{"class":63}," updated_at\n",[50,567,569,571,573],{"class":52,"line":568},42,[50,570,430],{"class":56},[50,572,34],{"class":60},[50,574,519],{"class":63},[50,576,578,580,582],{"class":52,"line":577},43,[50,579,453],{"class":56},[50,581,34],{"class":60},[50,583,584],{"class":63}," Timestamp when the record was last updated.\n",[50,586,588,590],{"class":52,"line":587},44,[50,589,464],{"class":56},[50,591,73],{"class":60},[50,593,595,597,599,601],{"class":52,"line":594},45,[50,596,472],{"class":60},[50,598,106],{"class":56},[50,600,34],{"class":60},[50,602,479],{"class":63},[50,604,606,609],{"class":52,"line":605},46,[50,607,608],{"class":56},"  Customer",[50,610,73],{"class":60},[50,612,614,616,618],{"class":52,"line":613},47,[50,615,221],{"class":56},[50,617,34],{"class":60},[50,619,620],{"class":63}," Customer is an individual/business registered on our platform.\n",[50,622,624,627],{"class":52,"line":623},48,[50,625,626],{"class":56},"    domains",[50,628,73],{"class":60},[50,630,632,634],{"class":52,"line":631},49,[50,633,238],{"class":60},[50,635,636],{"class":63}," customer-management\n",[50,638,640,642],{"class":52,"line":639},50,[50,641,403],{"class":56},[50,643,73],{"class":60},[50,645,647,649],{"class":52,"line":646},51,[50,648,411],{"class":56},[50,650,73],{"class":60},[50,652,654,656,658],{"class":52,"line":653},52,[50,655,419],{"class":56},[50,657,34],{"class":60},[50,659,660],{"class":63}," customer_id\n",[50,662,664,666,668],{"class":52,"line":663},53,[50,665,430],{"class":56},[50,667,34],{"class":60},[50,669,435],{"class":63},[50,671,673,675],{"class":52,"line":672},54,[50,674,464],{"class":56},[50,676,73],{"class":60},[50,678,680,682,684,686],{"class":52,"line":679},55,[50,681,472],{"class":60},[50,683,106],{"class":56},[50,685,34],{"class":60},[50,687,479],{"class":63},[50,689,691,693,695,697],{"class":52,"line":690},56,[50,692,472],{"class":60},[50,694,106],{"class":56},[50,696,34],{"class":60},[50,698,491],{"class":63},[50,700,702,705],{"class":52,"line":701},57,[50,703,704],{"class":56},"      Email",[50,706,73],{"class":60},[50,708,710,712,714],{"class":52,"line":709},58,[50,711,419],{"class":56},[50,713,34],{"class":60},[50,715,716],{"class":63}," email\n",[50,718,720,722,724],{"class":52,"line":719},59,[50,721,430],{"class":56},[50,723,34],{"class":60},[50,725,726],{"class":63}," string\n",[50,728,730,732],{"class":52,"line":729},60,[50,731,464],{"class":56},[50,733,73],{"class":60},[50,735,737,739,741,743],{"class":52,"line":736},61,[50,738,472],{"class":60},[50,740,106],{"class":56},[50,742,34],{"class":60},[50,744,479],{"class":63},[50,746,748,751],{"class":52,"line":747},62,[50,749,750],{"class":56},"      FullName",[50,752,73],{"class":60},[50,754,756,758,760],{"class":52,"line":755},63,[50,757,419],{"class":56},[50,759,34],{"class":60},[50,761,762],{"class":63}," full_name\n",[50,764,766,768,770],{"class":52,"line":765},64,[50,767,430],{"class":56},[50,769,34],{"class":60},[50,771,726],{"class":63},[50,773,775,778],{"class":52,"line":774},65,[50,776,777],{"class":56},"      Country",[50,779,73],{"class":60},[50,781,783,785,787],{"class":52,"line":782},66,[50,784,419],{"class":56},[50,786,34],{"class":60},[50,788,789],{"class":63}," country\n",[50,791,793,795,797],{"class":52,"line":792},67,[50,794,430],{"class":56},[50,796,34],{"class":60},[50,798,726],{"class":63},[50,800,802,805],{"class":52,"line":801},68,[50,803,804],{"class":56},"      Age",[50,806,73],{"class":60},[50,808,810,812,814],{"class":52,"line":809},69,[50,811,419],{"class":56},[50,813,34],{"class":60},[50,815,816],{"class":63}," age\n",[50,818,820,822,824],{"class":52,"line":819},70,[50,821,430],{"class":56},[50,823,34],{"class":60},[50,825,435],{"class":63},[50,827,829,831],{"class":52,"line":828},71,[50,830,464],{"class":56},[50,832,73],{"class":60},[50,834,836,838,840,842],{"class":52,"line":835},72,[50,837,472],{"class":60},[50,839,106],{"class":56},[50,841,34],{"class":60},[50,843,844],{"class":63}," range\n",[50,846,848,851,853],{"class":52,"line":847},73,[50,849,850],{"class":56},"            min",[50,852,34],{"class":60},[50,854,855],{"class":154}," 0\n",[40,857,860],{"className":42,"code":858,"filename":859,"language":44,"meta":45,"style":45},"name: ecommerce_pg_to_duckdb\n\ndefault_connections:\n  duckdb: \"duckdb-default\"\n  postgres: \"pg-default\"\n\nvariables:\n  all_time:\n    type: int\n    default: 1 # 0 for all time - 1 to enable start_date and end_date\n","orders-performance/pipeline.yml",[47,861,862,872,876,883,897,911,915,922,929,939],{"__ignoreMap":45},[50,863,864,867,869],{"class":52,"line":53},[50,865,866],{"class":56},"name",[50,868,34],{"class":60},[50,870,871],{"class":63}," ecommerce_pg_to_duckdb\n",[50,873,874],{"class":52,"line":67},[50,875,371],{"emptyLinePlaceholder":370},[50,877,878,881],{"class":52,"line":76},[50,879,880],{"class":56},"default_connections",[50,882,73],{"class":60},[50,884,885,888,890,892,895],{"class":52,"line":84},[50,886,887],{"class":56},"  duckdb",[50,889,34],{"class":60},[50,891,241],{"class":60},[50,893,894],{"class":63},"duckdb-default",[50,896,247],{"class":60},[50,898,899,902,904,906,909],{"class":52,"line":92},[50,900,901],{"class":56},"  postgres",[50,903,34],{"class":60},[50,905,241],{"class":60},[50,907,908],{"class":63},"pg-default",[50,910,247],{"class":60},[50,912,913],{"class":52,"line":100},[50,914,371],{"emptyLinePlaceholder":370},[50,916,917,920],{"class":52,"line":114},[50,918,919],{"class":56},"variables",[50,921,73],{"class":60},[50,923,924,927],{"class":52,"line":125},[50,925,926],{"class":56},"  all_time",[50,928,73],{"class":60},[50,930,931,934,936],{"class":52,"line":135},[50,932,933],{"class":56},"    type",[50,935,34],{"class":60},[50,937,938],{"class":63}," int\n",[50,940,941,943,945,948],{"class":52,"line":146},[50,942,79],{"class":56},[50,944,34],{"class":60},[50,946,947],{"class":154}," 1",[50,949,951],{"class":950},"sHwdD"," # 0 for all time - 1 to enable start_date and end_date\n",[40,953,956],{"className":42,"code":954,"filename":955,"language":44,"meta":45,"style":45},"name: raw.customers\ntype: ingestr\n\ndescription: Ingest OLTP customers from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  source_connection: pg-default\n  source_table: \"public.customers\"\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.customers.asset.yml",[47,957,958,967,977,981,991,995,1002,1010,1014,1021,1030,1044],{"__ignoreMap":45},[50,959,960,962,964],{"class":52,"line":53},[50,961,866],{"class":56},[50,963,34],{"class":60},[50,965,966],{"class":63}," raw.customers\n",[50,968,969,972,974],{"class":52,"line":67},[50,970,971],{"class":56},"type",[50,973,34],{"class":60},[50,975,976],{"class":63}," ingestr\n",[50,978,979],{"class":52,"line":76},[50,980,371],{"emptyLinePlaceholder":370},[50,982,983,986,988],{"class":52,"line":84},[50,984,985],{"class":56},"description",[50,987,34],{"class":60},[50,989,990],{"class":63}," Ingest OLTP customers from Postgres into DuckDB raw layer.\n",[50,992,993],{"class":52,"line":92},[50,994,371],{"emptyLinePlaceholder":370},[50,996,997,1000],{"class":52,"line":100},[50,998,999],{"class":56},"tags",[50,1001,73],{"class":60},[50,1003,1004,1007],{"class":52,"line":114},[50,1005,1006],{"class":60},"  -",[50,1008,1009],{"class":63}," raw\n",[50,1011,1012],{"class":52,"line":125},[50,1013,371],{"emptyLinePlaceholder":370},[50,1015,1016,1019],{"class":52,"line":135},[50,1017,1018],{"class":56},"parameters",[50,1020,73],{"class":60},[50,1022,1023,1026,1028],{"class":52,"line":146},[50,1024,1025],{"class":56},"  source_connection",[50,1027,34],{"class":60},[50,1029,111],{"class":63},[50,1031,1032,1035,1037,1039,1042],{"class":52,"line":158},[50,1033,1034],{"class":56},"  source_table",[50,1036,34],{"class":60},[50,1038,241],{"class":60},[50,1040,1041],{"class":63},"public.customers",[50,1043,247],{"class":60},[50,1045,1046,1049,1051],{"class":52,"line":168},[50,1047,1048],{"class":56},"  destination",[50,1050,34],{"class":60},[50,1052,1053],{"class":63}," duckdb\n",[40,1055,1058],{"className":42,"code":1056,"filename":1057,"language":44,"meta":45,"style":45},"name: raw.orders\ntype: ingestr\ndescription: Ingest OLTP orders from Postgres into DuckDB raw layer.\n\ntags:\n  - raw\n\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.orders\n","orders-performance/assets/ingestion/raw.orders.asset.yml",[47,1059,1060,1069,1077,1086,1090,1096,1102,1106,1112,1120,1128],{"__ignoreMap":45},[50,1061,1062,1064,1066],{"class":52,"line":53},[50,1063,866],{"class":56},[50,1065,34],{"class":60},[50,1067,1068],{"class":63}," raw.orders\n",[50,1070,1071,1073,1075],{"class":52,"line":67},[50,1072,971],{"class":56},[50,1074,34],{"class":60},[50,1076,976],{"class":63},[50,1078,1079,1081,1083],{"class":52,"line":76},[50,1080,985],{"class":56},[50,1082,34],{"class":60},[50,1084,1085],{"class":63}," Ingest OLTP orders from Postgres into DuckDB raw layer.\n",[50,1087,1088],{"class":52,"line":84},[50,1089,371],{"emptyLinePlaceholder":370},[50,1091,1092,1094],{"class":52,"line":92},[50,1093,999],{"class":56},[50,1095,73],{"class":60},[50,1097,1098,1100],{"class":52,"line":100},[50,1099,1006],{"class":60},[50,1101,1009],{"class":63},[50,1103,1104],{"class":52,"line":114},[50,1105,371],{"emptyLinePlaceholder":370},[50,1107,1108,1110],{"class":52,"line":125},[50,1109,1018],{"class":56},[50,1111,73],{"class":60},[50,1113,1114,1116,1118],{"class":52,"line":135},[50,1115,1048],{"class":56},[50,1117,34],{"class":60},[50,1119,1053],{"class":63},[50,1121,1122,1124,1126],{"class":52,"line":146},[50,1123,1025],{"class":56},[50,1125,34],{"class":60},[50,1127,111],{"class":63},[50,1129,1130,1132,1134],{"class":52,"line":158},[50,1131,1034],{"class":56},[50,1133,34],{"class":60},[50,1135,1136],{"class":63}," public.orders\n",[40,1138,1143],{"className":1139,"code":1140,"filename":1141,"language":1142,"meta":45,"style":45},"language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","/* @bruin\nname: mart.customers_by_age\ntype: duckdb.sql\ntags:\n  - mart\n  - amazing-tag\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - stg.customers\nowner: danielhe4rt@gmail.com\n@bruin */\n\nWITH src AS (\n  SELECT CASE\n            WHEN age \u003C 25 THEN '18-24'\n            WHEN age BETWEEN 25 AND 34 THEN '25-34'\n            WHEN age BETWEEN 35 AND 49 THEN '35-49'\n            ELSE '50+'\n         END AS age_group\n  FROM stg.customers\n)\nSELECT age_group,\n       COUNT(*) AS total_customers\nFROM src\nGROUP BY age_group\nORDER BY total_customers DESC;\n","orders-performance/assets/mart/customers/mart.customers_by_age.asset.sql","sql",[47,1144,1145,1150,1155,1160,1165,1170,1175,1180,1185,1190,1195,1200,1205,1210,1214,1229,1237,1263,1289,1314,1326,1337,1345,1350,1358,1378,1386,1393],{"__ignoreMap":45},[50,1146,1147],{"class":52,"line":53},[50,1148,1149],{"class":950},"/* @bruin\n",[50,1151,1152],{"class":52,"line":67},[50,1153,1154],{"class":950},"name: mart.customers_by_age\n",[50,1156,1157],{"class":52,"line":76},[50,1158,1159],{"class":950},"type: duckdb.sql\n",[50,1161,1162],{"class":52,"line":84},[50,1163,1164],{"class":950},"tags:\n",[50,1166,1167],{"class":52,"line":92},[50,1168,1169],{"class":950},"  - mart\n",[50,1171,1172],{"class":52,"line":100},[50,1173,1174],{"class":950},"  - amazing-tag\n",[50,1176,1177],{"class":52,"line":114},[50,1178,1179],{"class":950},"materialization:\n",[50,1181,1182],{"class":52,"line":125},[50,1183,1184],{"class":950},"  type: table\n",[50,1186,1187],{"class":52,"line":135},[50,1188,1189],{"class":950},"  strategy: create+replace\n",[50,1191,1192],{"class":52,"line":146},[50,1193,1194],{"class":950},"depends:\n",[50,1196,1197],{"class":52,"line":158},[50,1198,1199],{"class":950},"  - stg.customers\n",[50,1201,1202],{"class":52,"line":168},[50,1203,1204],{"class":950},"owner: danielhe4rt@gmail.com\n",[50,1206,1207],{"class":52,"line":176},[50,1208,1209],{"class":950},"@bruin */\n",[50,1211,1212],{"class":52,"line":188},[50,1213,371],{"emptyLinePlaceholder":370},[50,1215,1216,1219,1223,1226],{"class":52,"line":316},[50,1217,1218],{"class":154},"WITH",[50,1220,1222],{"class":1221},"sTEyZ"," src ",[50,1224,1225],{"class":154},"AS",[50,1227,1228],{"class":1221}," (\n",[50,1230,1231,1234],{"class":52,"line":324},[50,1232,1233],{"class":154},"  SELECT",[50,1235,1236],{"class":154}," CASE\n",[50,1238,1239,1242,1245,1248,1251,1254,1257,1260],{"class":52,"line":334},[50,1240,1241],{"class":154},"            WHEN",[50,1243,1244],{"class":1221}," age ",[50,1246,1247],{"class":60},"\u003C",[50,1249,1250],{"class":154}," 25",[50,1252,1253],{"class":154}," THEN",[50,1255,1256],{"class":60}," '",[50,1258,1259],{"class":63},"18-24",[50,1261,1262],{"class":60},"'\n",[50,1264,1265,1267,1269,1272,1274,1277,1280,1282,1284,1287],{"class":52,"line":341},[50,1266,1241],{"class":154},[50,1268,1244],{"class":1221},[50,1270,1271],{"class":154},"BETWEEN",[50,1273,1250],{"class":154},[50,1275,1276],{"class":154}," AND",[50,1278,1279],{"class":154}," 34",[50,1281,1253],{"class":154},[50,1283,1256],{"class":60},[50,1285,1286],{"class":63},"25-34",[50,1288,1262],{"class":60},[50,1290,1291,1293,1295,1297,1300,1302,1305,1307,1309,1312],{"class":52,"line":352},[50,1292,1241],{"class":154},[50,1294,1244],{"class":1221},[50,1296,1271],{"class":154},[50,1298,1299],{"class":154}," 35",[50,1301,1276],{"class":154},[50,1303,1304],{"class":154}," 49",[50,1306,1253],{"class":154},[50,1308,1256],{"class":60},[50,1310,1311],{"class":63},"35-49",[50,1313,1262],{"class":60},[50,1315,1316,1319,1321,1324],{"class":52,"line":359},[50,1317,1318],{"class":154},"            ELSE",[50,1320,1256],{"class":60},[50,1322,1323],{"class":63},"50+",[50,1325,1262],{"class":60},[50,1327,1328,1331,1334],{"class":52,"line":367},[50,1329,1330],{"class":154},"         END",[50,1332,1333],{"class":154}," AS",[50,1335,1336],{"class":1221}," age_group\n",[50,1338,1339,1342],{"class":52,"line":374},[50,1340,1341],{"class":154},"  FROM",[50,1343,1344],{"class":1221}," stg.customers\n",[50,1346,1347],{"class":52,"line":382},[50,1348,1349],{"class":1221},")\n",[50,1351,1352,1355],{"class":52,"line":390},[50,1353,1354],{"class":154},"SELECT",[50,1356,1357],{"class":1221}," age_group,\n",[50,1359,1360,1364,1367,1370,1373,1375],{"class":52,"line":400},[50,1361,1363],{"class":1362},"s2Zo4","       COUNT",[50,1365,1366],{"class":1221},"(",[50,1368,1369],{"class":60},"*",[50,1371,1372],{"class":1221},") ",[50,1374,1225],{"class":154},[50,1376,1377],{"class":1221}," total_customers\n",[50,1379,1380,1383],{"class":52,"line":408},[50,1381,1382],{"class":154},"FROM",[50,1384,1385],{"class":1221}," src\n",[50,1387,1388,1391],{"class":52,"line":416},[50,1389,1390],{"class":154},"GROUP BY",[50,1392,1336],{"class":1221},[50,1394,1395,1398,1401,1404],{"class":52,"line":427},[50,1396,1397],{"class":154},"ORDER BY",[50,1399,1400],{"class":1221}," total_customers ",[50,1402,1403],{"class":154},"DESC",[50,1405,1406],{"class":1221},";\n",[40,1408,1411],{"className":1139,"code":1409,"filename":1410,"language":1142,"meta":45,"style":45},"/* @bruin\nname: mart.product_performance\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - stg.products\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n),\nitems_with_product AS (\n  SELECT\n    v.product_id,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n)\nSELECT\n  p.product_id,\n  p.name AS product_name,\n  p.category,\n  SUM(i.quantity) AS items_sold,\n  SUM(i.total_price) AS gross_revenue,\n  CASE WHEN SUM(i.quantity) = 0 THEN 0 ELSE SUM(i.total_price) / SUM(i.quantity) END AS avg_item_price\nFROM items_with_product i\nJOIN stg.products p ON p.product_id = i.product_id\nGROUP BY 1,2,3\nORDER BY gross_revenue DESC;\n","orders-performance/assets/mart/products/mart.product_performance.asset.sql",[47,1412,1413,1417,1422,1426,1430,1434,1438,1442,1447,1452,1457,1462,1466,1470,1481,1491,1498,1518,1552,1557,1566,1571,1576,1581,1586,1593,1610,1614,1619,1624,1634,1639,1652,1664,1708,1715,1733,1749],{"__ignoreMap":45},[50,1414,1415],{"class":52,"line":53},[50,1416,1149],{"class":950},[50,1418,1419],{"class":52,"line":67},[50,1420,1421],{"class":950},"name: mart.product_performance\n",[50,1423,1424],{"class":52,"line":76},[50,1425,1159],{"class":950},[50,1427,1428],{"class":52,"line":84},[50,1429,1179],{"class":950},[50,1431,1432],{"class":52,"line":92},[50,1433,1184],{"class":950},[50,1435,1436],{"class":52,"line":100},[50,1437,1189],{"class":950},[50,1439,1440],{"class":52,"line":114},[50,1441,1194],{"class":950},[50,1443,1444],{"class":52,"line":125},[50,1445,1446],{"class":950},"  - stg.products\n",[50,1448,1449],{"class":52,"line":135},[50,1450,1451],{"class":950},"  - stg.product_variants\n",[50,1453,1454],{"class":52,"line":146},[50,1455,1456],{"class":950},"  - stg.order_items\n",[50,1458,1459],{"class":52,"line":158},[50,1460,1461],{"class":950},"  - stg.orders\n",[50,1463,1464],{"class":52,"line":168},[50,1465,1209],{"class":950},[50,1467,1468],{"class":52,"line":176},[50,1469,371],{"emptyLinePlaceholder":370},[50,1471,1472,1474,1477,1479],{"class":52,"line":188},[50,1473,1218],{"class":154},[50,1475,1476],{"class":1221}," paid_items ",[50,1478,1225],{"class":154},[50,1480,1228],{"class":1221},[50,1482,1483,1485,1488],{"class":52,"line":316},[50,1484,1233],{"class":154},[50,1486,1487],{"class":1221}," oi.",[50,1489,1490],{"class":60},"*\n",[50,1492,1493,1495],{"class":52,"line":324},[50,1494,1341],{"class":154},[50,1496,1497],{"class":1221}," stg.order_items oi\n",[50,1499,1500,1503,1506,1509,1512,1515],{"class":52,"line":334},[50,1501,1502],{"class":154},"  JOIN",[50,1504,1505],{"class":1221}," stg.orders o ",[50,1507,1508],{"class":154},"ON",[50,1510,1511],{"class":1221}," o.order_id ",[50,1513,1514],{"class":60},"=",[50,1516,1517],{"class":1221}," oi.order_id\n",[50,1519,1520,1523,1526,1529,1532,1535,1538,1540,1543,1545,1548,1550],{"class":52,"line":341},[50,1521,1522],{"class":154},"  WHERE",[50,1524,1525],{"class":1221}," o.status ",[50,1527,1528],{"class":154},"IN",[50,1530,1531],{"class":1221}," (",[50,1533,1534],{"class":60},"'",[50,1536,1537],{"class":63},"paid",[50,1539,1534],{"class":60},[50,1541,1542],{"class":1221},",",[50,1544,1534],{"class":60},[50,1546,1547],{"class":63},"shipped",[50,1549,1534],{"class":60},[50,1551,1349],{"class":1221},[50,1553,1554],{"class":52,"line":352},[50,1555,1556],{"class":1221},"),\n",[50,1558,1559,1562,1564],{"class":52,"line":359},[50,1560,1561],{"class":1221},"items_with_product ",[50,1563,1225],{"class":154},[50,1565,1228],{"class":1221},[50,1567,1568],{"class":52,"line":367},[50,1569,1570],{"class":154},"  SELECT\n",[50,1572,1573],{"class":52,"line":374},[50,1574,1575],{"class":1221},"    v.product_id,\n",[50,1577,1578],{"class":52,"line":382},[50,1579,1580],{"class":1221},"    oi.quantity,\n",[50,1582,1583],{"class":52,"line":390},[50,1584,1585],{"class":1221},"    oi.total_price\n",[50,1587,1588,1590],{"class":52,"line":400},[50,1589,1341],{"class":154},[50,1591,1592],{"class":1221}," paid_items oi\n",[50,1594,1595,1597,1600,1602,1605,1607],{"class":52,"line":408},[50,1596,1502],{"class":154},[50,1598,1599],{"class":1221}," stg.product_variants v ",[50,1601,1508],{"class":154},[50,1603,1604],{"class":1221}," v.variant_id ",[50,1606,1514],{"class":60},[50,1608,1609],{"class":1221}," oi.variant_id\n",[50,1611,1612],{"class":52,"line":416},[50,1613,1349],{"class":1221},[50,1615,1616],{"class":52,"line":427},[50,1617,1618],{"class":154},"SELECT\n",[50,1620,1621],{"class":52,"line":438},[50,1622,1623],{"class":1221},"  p.product_id,\n",[50,1625,1626,1629,1631],{"class":52,"line":450},[50,1627,1628],{"class":1221},"  p.name ",[50,1630,1225],{"class":154},[50,1632,1633],{"class":1221}," product_name,\n",[50,1635,1636],{"class":52,"line":461},[50,1637,1638],{"class":1221},"  p.category,\n",[50,1640,1641,1644,1647,1649],{"class":52,"line":469},[50,1642,1643],{"class":1362},"  SUM",[50,1645,1646],{"class":1221},"(i.quantity) ",[50,1648,1225],{"class":154},[50,1650,1651],{"class":1221}," items_sold,\n",[50,1653,1654,1656,1659,1661],{"class":52,"line":482},[50,1655,1643],{"class":1362},[50,1657,1658],{"class":1221},"(i.total_price) ",[50,1660,1225],{"class":154},[50,1662,1663],{"class":1221}," gross_revenue,\n",[50,1665,1666,1669,1672,1675,1677,1679,1682,1684,1686,1689,1691,1693,1696,1698,1700,1703,1705],{"class":52,"line":494},[50,1667,1668],{"class":154},"  CASE",[50,1670,1671],{"class":154}," WHEN",[50,1673,1674],{"class":1362}," SUM",[50,1676,1646],{"class":1221},[50,1678,1514],{"class":60},[50,1680,1681],{"class":154}," 0",[50,1683,1253],{"class":154},[50,1685,1681],{"class":154},[50,1687,1688],{"class":154}," ELSE",[50,1690,1674],{"class":1362},[50,1692,1658],{"class":1221},[50,1694,1695],{"class":60},"/",[50,1697,1674],{"class":1362},[50,1699,1646],{"class":1221},[50,1701,1702],{"class":154},"END",[50,1704,1333],{"class":154},[50,1706,1707],{"class":1221}," avg_item_price\n",[50,1709,1710,1712],{"class":52,"line":502},[50,1711,1382],{"class":154},[50,1713,1714],{"class":1221}," items_with_product i\n",[50,1716,1717,1720,1723,1725,1728,1730],{"class":52,"line":512},[50,1718,1719],{"class":154},"JOIN",[50,1721,1722],{"class":1221}," stg.products p ",[50,1724,1508],{"class":154},[50,1726,1727],{"class":1221}," p.product_id ",[50,1729,1514],{"class":60},[50,1731,1732],{"class":1221}," i.product_id\n",[50,1734,1735,1737,1739,1741,1744,1746],{"class":52,"line":522},[50,1736,1390],{"class":154},[50,1738,947],{"class":154},[50,1740,1542],{"class":1221},[50,1742,1743],{"class":154},"2",[50,1745,1542],{"class":1221},[50,1747,1748],{"class":154},"3\n",[50,1750,1751,1753,1756,1758],{"class":52,"line":532},[50,1752,1397],{"class":154},[50,1754,1755],{"class":1221}," gross_revenue ",[50,1757,1403],{"class":154},[50,1759,1406],{"class":1221},[40,1761,1764],{"className":1139,"code":1762,"filename":1763,"language":1142,"meta":45,"style":45},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.customers\n@bruin */\n\nSELECT\n  id::INT AS customer_id,\n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n","orders-performance/assets/staging/stg.customers.asset.sql",[47,1765,1766,1770,1775,1779,1783,1787,1791,1796,1800,1804,1808,1822,1845,1870,1887,1892,1897,1903],{"__ignoreMap":45},[50,1767,1768],{"class":52,"line":53},[50,1769,1149],{"class":950},[50,1771,1772],{"class":52,"line":67},[50,1773,1774],{"class":950},"name: stg.customers\n",[50,1776,1777],{"class":52,"line":76},[50,1778,1159],{"class":950},[50,1780,1781],{"class":52,"line":84},[50,1782,1179],{"class":950},[50,1784,1785],{"class":52,"line":92},[50,1786,1184],{"class":950},[50,1788,1789],{"class":52,"line":100},[50,1790,1194],{"class":950},[50,1792,1793],{"class":52,"line":114},[50,1794,1795],{"class":950},"  - raw.customers\n",[50,1797,1798],{"class":52,"line":125},[50,1799,1209],{"class":950},[50,1801,1802],{"class":52,"line":135},[50,1803,371],{"emptyLinePlaceholder":370},[50,1805,1806],{"class":52,"line":146},[50,1807,1618],{"class":154},[50,1809,1810,1813,1817,1819],{"class":52,"line":158},[50,1811,1812],{"class":1221},"  id::",[50,1814,1816],{"class":1815},"spNyl","INT",[50,1818,1333],{"class":154},[50,1820,1821],{"class":1221}," customer_id,\n",[50,1823,1824,1827,1829,1832,1835,1838,1840,1842],{"class":52,"line":168},[50,1825,1826],{"class":1362},"  COALESCE",[50,1828,1366],{"class":1221},[50,1830,1831],{"class":1362},"TRIM",[50,1833,1834],{"class":1221},"(email), ",[50,1836,1837],{"class":60},"''",[50,1839,1372],{"class":1221},[50,1841,1225],{"class":154},[50,1843,1844],{"class":1221}," email,\n",[50,1846,1847,1849,1851,1853,1856,1858,1861,1863,1865,1867],{"class":52,"line":176},[50,1848,1826],{"class":1362},[50,1850,1366],{"class":1221},[50,1852,1831],{"class":1362},[50,1854,1855],{"class":1221},"(country), ",[50,1857,1534],{"class":60},[50,1859,1860],{"class":63},"Unknown",[50,1862,1534],{"class":60},[50,1864,1372],{"class":1221},[50,1866,1225],{"class":154},[50,1868,1869],{"class":1221}," country,\n",[50,1871,1872,1874,1877,1880,1882,1884],{"class":52,"line":188},[50,1873,1826],{"class":1362},[50,1875,1876],{"class":1221},"(age, ",[50,1878,1879],{"class":154},"0",[50,1881,1372],{"class":1221},[50,1883,1225],{"class":154},[50,1885,1886],{"class":1221}," age,\n",[50,1888,1889],{"class":52,"line":316},[50,1890,1891],{"class":1221},"  created_at,\n",[50,1893,1894],{"class":52,"line":324},[50,1895,1896],{"class":1221},"  updated_at\n",[50,1898,1899,1901],{"class":52,"line":334},[50,1900,1382],{"class":154},[50,1902,966],{"class":1221},[50,1904,1905,1908,1911,1914],{"class":52,"line":341},[50,1906,1907],{"class":154},"WHERE",[50,1909,1910],{"class":1221}," email ",[50,1912,1913],{"class":154},"IS NOT NULL",[50,1915,1406],{"class":1221},[1917,1918,1920],"h2",{"id":1919},"what-this-hands-on-tutorial-covers",[1921,1922,1923],"strong",{},"What this hands-on tutorial covers",[1925,1926,1929,1938,1945,1952],"card-group",{"className":1927},[1928],"w-full",[1930,1931,1935],"card",{"icon":1932,"target":1933,"title":1934},"i-tabler-database-import","_blank","Ingestion Layer",[32,1936,1937],{},"Learn how to configure Bruin assets for incremental ingestion from Postgres into DuckDB.",[1930,1939,1942],{"icon":1940,"target":1933,"title":1941},"i-tabler-transform","Transformation Layer",[32,1943,1944],{},"Explore staging and mart patterns that turn raw e-commerce data into usable analytics.",[1930,1946,1949],{"icon":1947,"target":1933,"title":1948},"i-tabler-shield-check","Quality Checks",[32,1950,1951],{},"Implement column-level and business logic validations to ensure data integrity.",[1930,1953,1956],{"icon":1954,"target":1933,"title":1955},"i-tabler-chart-bar","Analytics & Insights",[32,1957,1958],{},"Build daily revenue and customer lifetime value dashboards from validated datasets.",[32,1960,1961,1962,1965],{},"This tutorial is structured to give you a ",[1921,1963,1964],{},"straightforward, engineering-first path"," to building a production-ready analytics pipeline. It’s about understanding how each component — ingestion, transformation, validation, and analysis — fits together under Bruin’s unified workflow.",[1917,1967,1969],{"id":1968},"_1-prerequisites-setup","1) Prerequisites & Setup",[1971,1972,1973,1977,1980,1992],"ul",{},[1974,1975,1976],"li",{},"Docker (for Postgres)",[1974,1978,1979],{},"Python 3.11+",[1974,1981,1982,1985,1986],{},[47,1983,1984],{},"uv"," (fast Python toolchain manager) → ",[1987,1988,1989],"a",{"href":1989,"rel":1990},"https://docs.astral.sh/uv/",[1991],"nofollow",[1974,1993,1994],{},"Git, Bash",[40,1996,2000],{"className":1997,"code":1998,"language":1999,"meta":45,"style":45},"language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","git clone https://github.com/danielhe4rt/bruin-ecommerce-pipeline\ncd bruin-ecommerce-pipeline\n","bash",[47,2001,2002,2014],{"__ignoreMap":45},[50,2003,2004,2008,2011],{"class":52,"line":53},[50,2005,2007],{"class":2006},"sBMFI","git",[50,2009,2010],{"class":63}," clone",[50,2012,2013],{"class":63}," https://github.com/danielhe4rt/bruin-ecommerce-pipeline\n",[50,2015,2016,2019],{"class":52,"line":67},[50,2017,2018],{"class":1362},"cd",[50,2020,2021],{"class":63}," bruin-ecommerce-pipeline\n",[32,2023,2024],{},"Or use the bruin templates directly from the CLI:",[40,2026,2028],{"className":1997,"code":2027,"language":1999,"meta":45,"style":45},"bruin init ecommerce\n\ncd bruin\n",[47,2029,2030,2041,2045],{"__ignoreMap":45},[50,2031,2032,2035,2038],{"class":52,"line":53},[50,2033,2034],{"class":2006},"bruin",[50,2036,2037],{"class":63}," init",[50,2039,2040],{"class":63}," ecommerce\n",[50,2042,2043],{"class":52,"line":67},[50,2044,371],{"emptyLinePlaceholder":370},[50,2046,2047,2049],{"class":52,"line":76},[50,2048,2018],{"class":1362},[50,2050,2051],{"class":63}," bruin\n",[32,2053,2054],{},"Then, open the project in your favorite code editor and let's get started!",[1917,2056,2058],{"id":2057},"_2-understanding-the-data-model-oltp-analytics","2) Understanding the Data Model (OLTP → Analytics)",[32,2060,2061,2062,2065,2066,2069],{},"In e-commerce — and most analytics-driven businesses — data pipelines are typically organized into ",[1921,2063,2064],{},"layers",", each\nserving a specific purpose. This layered structure keeps data ",[1921,2067,2068],{},"reliable, interpretable, and adaptable"," as the business\nscales.",[32,2071,2072,2073,2076],{},"The ultimate goal is to make data analysis effortless and focused on ",[1921,2074,2075],{},"answering real business questions"," across key\ndomains, such as:",[2078,2079,2080,2093],"table",{},[2081,2082,2083],"thead",{},[2084,2085,2086,2090],"tr",{},[2087,2088,2089],"th",{},"Domain",[2087,2091,2092],{},"Analysis Focus",[2094,2095,2096,2107,2117,2127],"tbody",{},[2084,2097,2098,2104],{},[2099,2100,2101],"td",{},[1921,2102,2103],{},"Customers",[2099,2105,2106],{},"Segmentation by age, geography, and behavior patterns",[2084,2108,2109,2114],{},[2099,2110,2111],{},[1921,2112,2113],{},"Products and Product Variants",[2099,2115,2116],{},"Performance by category, profitability, and pricing insights",[2084,2118,2119,2124],{},[2099,2120,2121],{},[1921,2122,2123],{},"Orders and Order Items",[2099,2125,2126],{},"Daily revenue, order volume, and purchasing trends",[2084,2128,2129,2134],{},[2099,2130,2131],{},[1921,2132,2133],{},"KPI layer",[2099,2135,2136,2137,2140,2141,2140,2144,2147,2148],{},"Metrics like ",[1921,2138,2139],{},"AOV",", ",[1921,2142,2143],{},"units per order",[1921,2145,2146],{},"top SKUs",", and ",[1921,2149,2150],{},"repeat purchase rate",[32,2152,2153],{},"By structuring data this way, teams can move from raw information to actionable insights with clarity and confidence.",[32,2155,2156],{},"At this tutorial, it's important to understand the data relationships that form the backbone of most e-commerce\nsystems. These relationships define how information flows across entities — from customers placing orders to\nproducts being sold and analyzed.",[32,2158,2159],{},"Here’s the simplified schema we’ll use throughout this tutorial:",[2078,2161,2162,2175],{},[2081,2163,2164],{},[2084,2165,2166,2169,2172],{},[2087,2167,2168],{},"From",[2087,2170,2171],{},"To",[2087,2173,2174],{},"Relationship Type",[2094,2176,2177,2188,2198,2208],{},[2084,2178,2179,2182,2185],{},[2099,2180,2181],{},"customers(id)",[2099,2183,2184],{},"orders(customer_id)",[2099,2186,2187],{},"1:N (One-to-Many)",[2084,2189,2190,2193,2196],{},[2099,2191,2192],{},"orders(id)",[2099,2194,2195],{},"order_items(order_id)",[2099,2197,2187],{},[2084,2199,2200,2203,2206],{},[2099,2201,2202],{},"products(id)",[2099,2204,2205],{},"product_variants(product_id)",[2099,2207,2187],{},[2084,2209,2210,2213,2216],{},[2099,2211,2212],{},"product_variants(id)",[2099,2214,2215],{},"order_items(variant_id)",[2099,2217,2187],{},[36,2219,2221,2365,2466,2662,2791],{"default-value":2220},"customers.sql",[40,2222,2224],{"className":1139,"code":2223,"filename":2220,"language":1142,"meta":45,"style":45},"CREATE TABLE IF NOT EXISTS customers (\n    id          BIGSERIAL PRIMARY KEY,\n    full_name   TEXT        NOT NULL,\n    email       TEXT        NOT NULL UNIQUE,\n    country     TEXT        NOT NULL,\n    age         INTEGER     NOT NULL CHECK (age >= 0),\n    created_at  TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at  TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n",[47,2225,2226,2246,2260,2273,2287,2298,2322,2344,2360],{"__ignoreMap":45},[50,2227,2228,2231,2234,2237,2240,2243],{"class":52,"line":53},[50,2229,2230],{"class":154},"CREATE",[50,2232,2233],{"class":154}," TABLE",[50,2235,2236],{"class":1362}," IF",[50,2238,2239],{"class":154}," NOT",[50,2241,2242],{"class":154}," EXISTS",[50,2244,2245],{"class":1221}," customers (\n",[50,2247,2248,2251,2254,2257],{"class":52,"line":67},[50,2249,2250],{"class":1221},"    id          ",[50,2252,2253],{"class":1815},"BIGSERIAL",[50,2255,2256],{"class":1815}," PRIMARY KEY",[50,2258,2259],{"class":1221},",\n",[50,2261,2262,2265,2268,2271],{"class":52,"line":76},[50,2263,2264],{"class":1221},"    full_name   ",[50,2266,2267],{"class":1815},"TEXT",[50,2269,2270],{"class":154},"        NOT NULL",[50,2272,2259],{"class":1221},[50,2274,2275,2278,2280,2282,2285],{"class":52,"line":84},[50,2276,2277],{"class":1221},"    email       ",[50,2279,2267],{"class":1815},[50,2281,2270],{"class":154},[50,2283,2284],{"class":154}," UNIQUE",[50,2286,2259],{"class":1221},[50,2288,2289,2292,2294,2296],{"class":52,"line":92},[50,2290,2291],{"class":1221},"    country     ",[50,2293,2267],{"class":1815},[50,2295,2270],{"class":154},[50,2297,2259],{"class":1221},[50,2299,2300,2303,2306,2309,2312,2315,2318,2320],{"class":52,"line":100},[50,2301,2302],{"class":1221},"    age         ",[50,2304,2305],{"class":1815},"INTEGER",[50,2307,2308],{"class":154},"     NOT NULL",[50,2310,2311],{"class":1815}," CHECK",[50,2313,2314],{"class":1221}," (age ",[50,2316,2317],{"class":60},">=",[50,2319,1681],{"class":154},[50,2321,1556],{"class":1221},[50,2323,2324,2327,2330,2333,2336,2339,2342],{"class":52,"line":114},[50,2325,2326],{"class":1221},"    created_at  ",[50,2328,2329],{"class":1815},"TIMESTAMPTZ",[50,2331,2332],{"class":154}," NOT NULL",[50,2334,2335],{"class":1815}," DEFAULT",[50,2337,2338],{"class":154}," now",[50,2340,2341],{"class":60},"()",[50,2343,2259],{"class":1221},[50,2345,2346,2349,2351,2353,2355,2357],{"class":52,"line":125},[50,2347,2348],{"class":1221},"    updated_at  ",[50,2350,2329],{"class":1815},[50,2352,2332],{"class":154},[50,2354,2335],{"class":1815},[50,2356,2338],{"class":154},[50,2358,2359],{"class":60},"()\n",[50,2361,2362],{"class":52,"line":135},[50,2363,2364],{"class":1221},");\n",[40,2366,2369],{"className":1139,"code":2367,"filename":2368,"language":1142,"meta":45,"style":45},"CREATE TABLE IF NOT EXISTS products (\n    id          BIGSERIAL PRIMARY KEY,\n    name        TEXT        NOT NULL,\n    category    TEXT        NOT NULL,\n    sku         TEXT        NOT NULL UNIQUE,\n    created_at  TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at  TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n","products.sql",[47,2370,2371,2386,2396,2408,2419,2432,2448,2462],{"__ignoreMap":45},[50,2372,2373,2375,2377,2379,2381,2383],{"class":52,"line":53},[50,2374,2230],{"class":154},[50,2376,2233],{"class":154},[50,2378,2236],{"class":1362},[50,2380,2239],{"class":154},[50,2382,2242],{"class":154},[50,2384,2385],{"class":1221}," products (\n",[50,2387,2388,2390,2392,2394],{"class":52,"line":67},[50,2389,2250],{"class":1221},[50,2391,2253],{"class":1815},[50,2393,2256],{"class":1815},[50,2395,2259],{"class":1221},[50,2397,2398,2401,2404,2406],{"class":52,"line":76},[50,2399,2400],{"class":154},"    name",[50,2402,2403],{"class":1815},"        TEXT",[50,2405,2270],{"class":154},[50,2407,2259],{"class":1221},[50,2409,2410,2413,2415,2417],{"class":52,"line":84},[50,2411,2412],{"class":1221},"    category    ",[50,2414,2267],{"class":1815},[50,2416,2270],{"class":154},[50,2418,2259],{"class":1221},[50,2420,2421,2424,2426,2428,2430],{"class":52,"line":92},[50,2422,2423],{"class":1221},"    sku         ",[50,2425,2267],{"class":1815},[50,2427,2270],{"class":154},[50,2429,2284],{"class":154},[50,2431,2259],{"class":1221},[50,2433,2434,2436,2438,2440,2442,2444,2446],{"class":52,"line":100},[50,2435,2326],{"class":1221},[50,2437,2329],{"class":1815},[50,2439,2332],{"class":154},[50,2441,2335],{"class":1815},[50,2443,2338],{"class":154},[50,2445,2341],{"class":60},[50,2447,2259],{"class":1221},[50,2449,2450,2452,2454,2456,2458,2460],{"class":52,"line":114},[50,2451,2348],{"class":1221},[50,2453,2329],{"class":1815},[50,2455,2332],{"class":154},[50,2457,2335],{"class":1815},[50,2459,2338],{"class":154},[50,2461,2359],{"class":60},[50,2463,2464],{"class":52,"line":125},[50,2465,2364],{"class":1221},[40,2467,2470],{"className":1139,"code":2468,"filename":2469,"language":1142,"meta":45,"style":45},"CREATE TABLE IF NOT EXISTS product_variants (\n    id                  BIGSERIAL PRIMARY KEY,\n    product_id          BIGINT         NOT NULL REFERENCES products(id) ON DELETE CASCADE,\n    variant_sku         TEXT           NOT NULL UNIQUE,\n    color               TEXT,\n    size                TEXT,\n    manufacturing_price NUMERIC(10,2)  NOT NULL,\n    selling_price       NUMERIC(10,2)  NOT NULL,\n    stock_quantity      INTEGER        NOT NULL,\n    is_active           BOOLEAN        NOT NULL DEFAULT TRUE,\n    created_at          TIMESTAMPTZ    NOT NULL DEFAULT now(),\n    updated_at          TIMESTAMPTZ    NOT NULL DEFAULT now()\n);\n","product_variants.sql",[47,2471,2472,2487,2498,2520,2534,2543,2553,2578,2599,2610,2625,2643,2658],{"__ignoreMap":45},[50,2473,2474,2476,2478,2480,2482,2484],{"class":52,"line":53},[50,2475,2230],{"class":154},[50,2477,2233],{"class":154},[50,2479,2236],{"class":1362},[50,2481,2239],{"class":154},[50,2483,2242],{"class":154},[50,2485,2486],{"class":1221}," product_variants (\n",[50,2488,2489,2492,2494,2496],{"class":52,"line":67},[50,2490,2491],{"class":1221},"    id                  ",[50,2493,2253],{"class":1815},[50,2495,2256],{"class":1815},[50,2497,2259],{"class":1221},[50,2499,2500,2503,2506,2509,2512,2515,2518],{"class":52,"line":76},[50,2501,2502],{"class":1221},"    product_id          ",[50,2504,2505],{"class":1815},"BIGINT",[50,2507,2508],{"class":154},"         NOT NULL",[50,2510,2511],{"class":1815}," REFERENCES",[50,2513,2514],{"class":1221}," products(id) ",[50,2516,2517],{"class":1815},"ON DELETE CASCADE",[50,2519,2259],{"class":1221},[50,2521,2522,2525,2527,2530,2532],{"class":52,"line":84},[50,2523,2524],{"class":1221},"    variant_sku         ",[50,2526,2267],{"class":1815},[50,2528,2529],{"class":154},"           NOT NULL",[50,2531,2284],{"class":154},[50,2533,2259],{"class":1221},[50,2535,2536,2539,2541],{"class":52,"line":92},[50,2537,2538],{"class":1221},"    color               ",[50,2540,2267],{"class":1815},[50,2542,2259],{"class":1221},[50,2544,2545,2548,2551],{"class":52,"line":100},[50,2546,2547],{"class":154},"    size",[50,2549,2550],{"class":1815},"                TEXT",[50,2552,2259],{"class":1221},[50,2554,2555,2558,2561,2563,2566,2568,2570,2573,2576],{"class":52,"line":114},[50,2556,2557],{"class":1221},"    manufacturing_price ",[50,2559,2560],{"class":1815},"NUMERIC",[50,2562,1366],{"class":1221},[50,2564,2565],{"class":154},"10",[50,2567,1542],{"class":1221},[50,2569,1743],{"class":154},[50,2571,2572],{"class":1221},")  ",[50,2574,2575],{"class":154},"NOT NULL",[50,2577,2259],{"class":1221},[50,2579,2580,2583,2585,2587,2589,2591,2593,2595,2597],{"class":52,"line":125},[50,2581,2582],{"class":1221},"    selling_price       ",[50,2584,2560],{"class":1815},[50,2586,1366],{"class":1221},[50,2588,2565],{"class":154},[50,2590,1542],{"class":1221},[50,2592,1743],{"class":154},[50,2594,2572],{"class":1221},[50,2596,2575],{"class":154},[50,2598,2259],{"class":1221},[50,2600,2601,2604,2606,2608],{"class":52,"line":135},[50,2602,2603],{"class":1221},"    stock_quantity      ",[50,2605,2305],{"class":1815},[50,2607,2270],{"class":154},[50,2609,2259],{"class":1221},[50,2611,2612,2615,2618,2620,2622],{"class":52,"line":146},[50,2613,2614],{"class":1221},"    is_active           ",[50,2616,2617],{"class":1815},"BOOLEAN",[50,2619,2270],{"class":154},[50,2621,2335],{"class":1815},[50,2623,2624],{"class":1221}," TRUE,\n",[50,2626,2627,2630,2632,2635,2637,2639,2641],{"class":52,"line":158},[50,2628,2629],{"class":1221},"    created_at          ",[50,2631,2329],{"class":1815},[50,2633,2634],{"class":154},"    NOT NULL",[50,2636,2335],{"class":1815},[50,2638,2338],{"class":154},[50,2640,2341],{"class":60},[50,2642,2259],{"class":1221},[50,2644,2645,2648,2650,2652,2654,2656],{"class":52,"line":168},[50,2646,2647],{"class":1221},"    updated_at          ",[50,2649,2329],{"class":1815},[50,2651,2634],{"class":154},[50,2653,2335],{"class":1815},[50,2655,2338],{"class":154},[50,2657,2359],{"class":60},[50,2659,2660],{"class":52,"line":176},[50,2661,2364],{"class":1221},[40,2663,2666],{"className":1139,"code":2664,"filename":2665,"language":1142,"meta":45,"style":45},"CREATE TABLE IF NOT EXISTS orders (\n    id            BIGSERIAL PRIMARY KEY,\n    customer_id   BIGINT      NOT NULL REFERENCES customers(id),\n    order_date    TIMESTAMPTZ NOT NULL DEFAULT now(),\n    status        TEXT        NOT NULL,\n    total_amount  NUMERIC(12,2),\n    created_at    TIMESTAMPTZ NOT NULL DEFAULT now(),\n    updated_at    TIMESTAMPTZ NOT NULL DEFAULT now()\n);\n","orders.sql",[47,2667,2668,2683,2694,2709,2726,2737,2755,2772,2787],{"__ignoreMap":45},[50,2669,2670,2672,2674,2676,2678,2680],{"class":52,"line":53},[50,2671,2230],{"class":154},[50,2673,2233],{"class":154},[50,2675,2236],{"class":1362},[50,2677,2239],{"class":154},[50,2679,2242],{"class":154},[50,2681,2682],{"class":1221}," orders (\n",[50,2684,2685,2688,2690,2692],{"class":52,"line":67},[50,2686,2687],{"class":1221},"    id            ",[50,2689,2253],{"class":1815},[50,2691,2256],{"class":1815},[50,2693,2259],{"class":1221},[50,2695,2696,2699,2701,2704,2706],{"class":52,"line":76},[50,2697,2698],{"class":1221},"    customer_id   ",[50,2700,2505],{"class":1815},[50,2702,2703],{"class":154},"      NOT NULL",[50,2705,2511],{"class":1815},[50,2707,2708],{"class":1221}," customers(id),\n",[50,2710,2711,2714,2716,2718,2720,2722,2724],{"class":52,"line":84},[50,2712,2713],{"class":1221},"    order_date    ",[50,2715,2329],{"class":1815},[50,2717,2332],{"class":154},[50,2719,2335],{"class":1815},[50,2721,2338],{"class":154},[50,2723,2341],{"class":60},[50,2725,2259],{"class":1221},[50,2727,2728,2731,2733,2735],{"class":52,"line":92},[50,2729,2730],{"class":154},"    status",[50,2732,2403],{"class":1815},[50,2734,2270],{"class":154},[50,2736,2259],{"class":1221},[50,2738,2739,2742,2744,2746,2749,2751,2753],{"class":52,"line":100},[50,2740,2741],{"class":1221},"    total_amount  ",[50,2743,2560],{"class":1815},[50,2745,1366],{"class":1221},[50,2747,2748],{"class":154},"12",[50,2750,1542],{"class":1221},[50,2752,1743],{"class":154},[50,2754,1556],{"class":1221},[50,2756,2757,2760,2762,2764,2766,2768,2770],{"class":52,"line":114},[50,2758,2759],{"class":1221},"    created_at    ",[50,2761,2329],{"class":1815},[50,2763,2332],{"class":154},[50,2765,2335],{"class":1815},[50,2767,2338],{"class":154},[50,2769,2341],{"class":60},[50,2771,2259],{"class":1221},[50,2773,2774,2777,2779,2781,2783,2785],{"class":52,"line":125},[50,2775,2776],{"class":1221},"    updated_at    ",[50,2778,2329],{"class":1815},[50,2780,2332],{"class":154},[50,2782,2335],{"class":1815},[50,2784,2338],{"class":154},[50,2786,2359],{"class":60},[50,2788,2789],{"class":52,"line":135},[50,2790,2364],{"class":1221},[40,2792,2795],{"className":1139,"code":2793,"filename":2794,"language":1142,"meta":45,"style":45},"CREATE TABLE IF NOT EXISTS order_items (\n    id           BIGSERIAL PRIMARY KEY,\n    order_id     BIGINT         NOT NULL REFERENCES orders(id) ON DELETE CASCADE,\n    variant_id   BIGINT         NOT NULL REFERENCES product_variants(id),\n    quantity     INTEGER        NOT NULL,\n    unit_price   NUMERIC(10,2)  NOT NULL,\n    total_price  NUMERIC(12,2)  GENERATED ALWAYS AS (quantity * unit_price) STORED,\n    created_at   TIMESTAMPTZ    NOT NULL DEFAULT now()\n);\n","order_items.sql",[47,2796,2797,2812,2823,2841,2855,2866,2887,2920,2935],{"__ignoreMap":45},[50,2798,2799,2801,2803,2805,2807,2809],{"class":52,"line":53},[50,2800,2230],{"class":154},[50,2802,2233],{"class":154},[50,2804,2236],{"class":1362},[50,2806,2239],{"class":154},[50,2808,2242],{"class":154},[50,2810,2811],{"class":1221}," order_items (\n",[50,2813,2814,2817,2819,2821],{"class":52,"line":67},[50,2815,2816],{"class":1221},"    id           ",[50,2818,2253],{"class":1815},[50,2820,2256],{"class":1815},[50,2822,2259],{"class":1221},[50,2824,2825,2828,2830,2832,2834,2837,2839],{"class":52,"line":76},[50,2826,2827],{"class":1221},"    order_id     ",[50,2829,2505],{"class":1815},[50,2831,2508],{"class":154},[50,2833,2511],{"class":1815},[50,2835,2836],{"class":1221}," orders(id) ",[50,2838,2517],{"class":1815},[50,2840,2259],{"class":1221},[50,2842,2843,2846,2848,2850,2852],{"class":52,"line":84},[50,2844,2845],{"class":1221},"    variant_id   ",[50,2847,2505],{"class":1815},[50,2849,2508],{"class":154},[50,2851,2511],{"class":1815},[50,2853,2854],{"class":1221}," product_variants(id),\n",[50,2856,2857,2860,2862,2864],{"class":52,"line":92},[50,2858,2859],{"class":1221},"    quantity     ",[50,2861,2305],{"class":1815},[50,2863,2270],{"class":154},[50,2865,2259],{"class":1221},[50,2867,2868,2871,2873,2875,2877,2879,2881,2883,2885],{"class":52,"line":100},[50,2869,2870],{"class":1221},"    unit_price   ",[50,2872,2560],{"class":1815},[50,2874,1366],{"class":1221},[50,2876,2565],{"class":154},[50,2878,1542],{"class":1221},[50,2880,1743],{"class":154},[50,2882,2572],{"class":1221},[50,2884,2575],{"class":154},[50,2886,2259],{"class":1221},[50,2888,2889,2892,2894,2896,2898,2900,2902,2904,2907,2910,2912,2915,2917],{"class":52,"line":114},[50,2890,2891],{"class":1221},"    total_price  ",[50,2893,2560],{"class":1815},[50,2895,1366],{"class":1221},[50,2897,2748],{"class":154},[50,2899,1542],{"class":1221},[50,2901,1743],{"class":154},[50,2903,2572],{"class":1221},[50,2905,2906],{"class":154},"GENERATED",[50,2908,2909],{"class":154}," ALWAYS",[50,2911,1333],{"class":154},[50,2913,2914],{"class":1221}," (quantity ",[50,2916,1369],{"class":60},[50,2918,2919],{"class":1221}," unit_price) STORED,\n",[50,2921,2922,2925,2927,2929,2931,2933],{"class":52,"line":125},[50,2923,2924],{"class":1221},"    created_at   ",[50,2926,2329],{"class":1815},[50,2928,2634],{"class":154},[50,2930,2335],{"class":1815},[50,2932,2338],{"class":154},[50,2934,2359],{"class":60},[50,2936,2937],{"class":52,"line":135},[50,2938,2364],{"class":1221},[32,2940,2941],{},"This model mirrors a real-world e-commerce workflow:",[1971,2943,2944,2947,2950,2953],{},[1974,2945,2946],{},"A customer makes one or more orders.",[1974,2948,2949],{},"Each order contains one or more items.",[1974,2951,2952],{},"Each item points to a specific product variant (like a red T-shirt, size M).",[1974,2954,2955],{},"Each variant belongs to a broader product (e.g., “Classic T-Shirt”).",[32,2957,2958],{},"These foreign key relationships allow us to join datasets efficiently and enable downstream analytics like:",[2078,2960,2961,2974],{},[2081,2962,2963],{},[2084,2964,2965,2968,2971],{},[2087,2966,2089],{"align":2967},"left",[2087,2969,2970],{},"Materialized Table",[2087,2972,2973],{},"Depends On",[2094,2975,2976,2990,3003,3024,3041,3064],{},[2084,2977,2978,2980,2985],{},[2099,2979,2103],{"align":2967},[2099,2981,2982],{},[47,2983,2984],{},"mart.customers_by_age",[2099,2986,2987],{},[47,2988,2989],{},"stg.customers",[2084,2991,2992,2994,2999],{},[2099,2993,2103],{"align":2967},[2099,2995,2996],{},[47,2997,2998],{},"mart.customers_by_country",[2099,3000,3001],{},[47,3002,2989],{},[2084,3004,3005,3008,3013],{},[2099,3006,3007],{"align":2967},"Products",[2099,3009,3010],{},[47,3011,3012],{},"mart.revenue_by_product",[2099,3014,3015,2140,3018,2140,3021],{},[47,3016,3017],{},"raw.order_items",[47,3019,3020],{},"raw.product_variants",[47,3022,3023],{},"raw.products",[2084,3025,3026,3028,3033],{},[2099,3027,3007],{"align":2967},[2099,3029,3030],{},[47,3031,3032],{},"mart.revenue_by_category",[2099,3034,3035,2140,3037,2140,3039],{},[47,3036,3017],{},[47,3038,3020],{},[47,3040,3023],{},[2084,3042,3043,3045,3050],{},[2099,3044,3007],{"align":2967},[2099,3046,3047],{},[47,3048,3049],{},"mart.revenue_by_product_variant",[2099,3051,3052,2140,3055,2140,3058,2140,3061],{},[47,3053,3054],{},"stg.product_variants",[47,3056,3057],{},"stg.order_items",[47,3059,3060],{},"stg.orders",[47,3062,3063],{},"stg.products",[2084,3065,3066,3069,3074],{},[2099,3067,3068],{"align":2967},"Sales",[2099,3070,3071],{},[47,3072,3073],{},"mart.sales_daily",[2099,3075,3076,2140,3078],{},[47,3077,3057],{},[47,3079,3060],{},[32,3081,3082],{},"By establishing these links early, every layer of the pipeline — raw, staging, and mart — can remain consistent and\ntraceable across transformations.",[1917,3084,3086],{"id":3085},"_3-setting-up-the-source-database-docker-postgres","3) Setting Up the Source Database (Docker + Postgres)",[32,3088,3089],{},"First, let's spin up our PostgreSQL instance:",[3091,3092,3093,3166,3185],"code-group",{},[40,3094,3097],{"className":1997,"code":3095,"filename":3096,"language":1999,"meta":45,"style":45},"docker run -d \\\n  --name bruin-postgres \\\n  -e POSTGRES_USER=postgres \\\n  -e POSTGRES_PASSWORD=postgres \\\n  -e POSTGRES_DB=postgres \\\n  -p 5432:5432 \\\n  postgres:18-alpine\n","Docker Run",[47,3098,3099,3113,3123,3133,3142,3151,3161],{"__ignoreMap":45},[50,3100,3101,3104,3107,3110],{"class":52,"line":53},[50,3102,3103],{"class":2006},"docker",[50,3105,3106],{"class":63}," run",[50,3108,3109],{"class":63}," -d",[50,3111,3112],{"class":1221}," \\\n",[50,3114,3115,3118,3121],{"class":52,"line":67},[50,3116,3117],{"class":63},"  --name",[50,3119,3120],{"class":63}," bruin-postgres",[50,3122,3112],{"class":1221},[50,3124,3125,3128,3131],{"class":52,"line":76},[50,3126,3127],{"class":63},"  -e",[50,3129,3130],{"class":63}," POSTGRES_USER=postgres",[50,3132,3112],{"class":1221},[50,3134,3135,3137,3140],{"class":52,"line":84},[50,3136,3127],{"class":63},[50,3138,3139],{"class":63}," POSTGRES_PASSWORD=postgres",[50,3141,3112],{"class":1221},[50,3143,3144,3146,3149],{"class":52,"line":92},[50,3145,3127],{"class":63},[50,3147,3148],{"class":63}," POSTGRES_DB=postgres",[50,3150,3112],{"class":1221},[50,3152,3153,3156,3159],{"class":52,"line":100},[50,3154,3155],{"class":63},"  -p",[50,3157,3158],{"class":63}," 5432:5432",[50,3160,3112],{"class":1221},[50,3162,3163],{"class":52,"line":114},[50,3164,3165],{"class":63},"  postgres:18-alpine\n",[40,3167,3170],{"className":1997,"code":3168,"filename":3169,"language":1999,"meta":45,"style":45},"docker compose up -d\n","Docker Compose",[47,3171,3172],{"__ignoreMap":45},[50,3173,3174,3176,3179,3182],{"class":52,"line":53},[50,3175,3103],{"class":2006},[50,3177,3178],{"class":63}," compose",[50,3180,3181],{"class":63}," up",[50,3183,3184],{"class":63}," -d\n",[40,3186,3189],{"className":1997,"code":3187,"filename":3188,"language":1999,"meta":45,"style":45},"make docker-up\n","Makefile",[47,3190,3191],{"__ignoreMap":45},[50,3192,3193,3196],{"class":52,"line":53},[50,3194,3195],{"class":2006},"make",[50,3197,3198],{"class":63}," docker-up\n",[32,3200,3201],{},"Now, we must ingest the DDL inside the PostgresSQL instance:",[3091,3203,3204,3246],{},[40,3205,3208],{"className":1997,"code":3206,"filename":3207,"language":1999,"meta":45,"style":45},"cat sql/ddl.sql | docker exec -i bruin-ecommerce psql -U postgres -d postgres\n","Docker Exec",[47,3209,3210],{"__ignoreMap":45},[50,3211,3212,3215,3218,3221,3224,3227,3230,3233,3236,3239,3242,3244],{"class":52,"line":53},[50,3213,3214],{"class":2006},"cat",[50,3216,3217],{"class":63}," sql/ddl.sql",[50,3219,3220],{"class":60}," |",[50,3222,3223],{"class":2006}," docker",[50,3225,3226],{"class":63}," exec",[50,3228,3229],{"class":63}," -i",[50,3231,3232],{"class":63}," bruin-ecommerce",[50,3234,3235],{"class":63}," psql",[50,3237,3238],{"class":63}," -U",[50,3240,3241],{"class":63}," postgres",[50,3243,3109],{"class":63},[50,3245,122],{"class":63},[40,3247,3249],{"className":1997,"code":3248,"filename":3188,"language":1999,"meta":45,"style":45},"make db-migrate\n",[47,3250,3251],{"__ignoreMap":45},[50,3252,3253,3255],{"class":52,"line":53},[50,3254,3195],{"class":2006},[50,3256,3257],{"class":63}," db-migrate\n",[3259,3260,3263],"note",{"className":3261},[1928,3262],"my-0",[32,3264,3265,3266],{},"If you're using Makefile, check the commands available using ",[47,3267,3268],{},"make help",[1917,3270,3272],{"id":3271},"_4-populating-test-data","4) Populating Test Data",[32,3274,3275],{},"We’ll use Python with uv— a fast, lightweight Python environment manager — to handle dependencies and execution.\nThis approach lets us install only what’s needed (no global dependencies, no virtualenv folders), and it’s fully idempotent.",[32,3277,3278],{},"Dependencies",[32,3280,3281,3282,3285],{},"Inside the project, you’ll find a script called ",[47,3283,3284],{},"generate_data.py",".\nThis script populates our five main tables (customers, products, product_variants, orders, and order_items) with realistic, time-distributed data that mimics an actual e-commerce platform.",[32,3287,3288],{},"To make this possible, we rely on two lightweight Python libraries:",[40,3290,3294],{"className":3291,"code":3292,"language":3293,"meta":45,"style":45},"language-diff shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","+ faker==37     # For realistic names, emails, and categorical data\n+ psycopg==3    # For direct PostgreSQL database access\n","diff",[47,3295,3296,3301],{"__ignoreMap":45},[50,3297,3298],{"class":52,"line":53},[50,3299,3300],{},"+ faker==37     # For realistic names, emails, and categorical data\n",[50,3302,3303],{"class":52,"line":67},[50,3304,3305],{},"+ psycopg==3    # For direct PostgreSQL database access\n",[32,3307,3308],{},"These are automatically handled when running with uv.",[3310,3311,3312],"code-collapse",{},[40,3313,3317],{"className":3314,"code":3315,"filename":3284,"language":3316,"meta":45,"style":45},"language-python shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","#!/usr/bin/env python3\n\"\"\"\nE-commerce demo data generator (Postgres).\n\nUsage:\n    uv run generate-data --dsn postgresql://user:pass@host:5432/db\n\"\"\"\n\nimport argparse, random\nfrom datetime import datetime, timedelta, timezone\nfrom faker import Faker\nimport psycopg\n\n# -------------------------------------------------------------------\n# GLOBAL CONFIGURATION\n# -------------------------------------------------------------------\n\nfake = Faker()\n\n# --- Static categorical constants ---\nPRODUCT_CATEGORIES = [\"t-shirts\", \"hoodies\", \"shoes\", \"accessories\", \"jackets\"]\nCOLORS = [\"Red\", \"Blue\", \"Black\", \"White\", \"Green\"]\nSIZES_APPAREL = [\"S\", \"M\", \"L\", \"XL\"]\nSIZES_SHOES = [36, 38, 40, 42, 44]\nORDER_STATUSES = [\"pending\", \"paid\", \"cancelled\", \"shipped\"]\nORDER_STATUS_WEIGHTS = [0.2, 0.5, 0.1, 0.2]\n\n# --- SQL Statements ---\nSQL_INSERT_CUSTOMERS = \"\"\"\n                       INSERT INTO customers(full_name, email, country, age, created_at, updated_at)\n                       VALUES (%s, %s, %s, %s, %s, %s) ON CONFLICT (email) DO\n                       UPDATE\n                           SET full_name=EXCLUDED.full_name, country=EXCLUDED.country,\n                           age=EXCLUDED.age, updated_at=EXCLUDED.updated_at; \\\n                       \"\"\"\n\nSQL_INSERT_PRODUCTS = \"\"\"\n                      INSERT INTO products(name, category, sku, created_at, updated_at)\n                      VALUES (%s, %s, %s, %s, %s) ON CONFLICT (sku) DO\n                      UPDATE\n                          SET name=EXCLUDED.name, category=EXCLUDED.category,\n                          updated_at=EXCLUDED.updated_at; \\\n                      \"\"\"\n\nSQL_INSERT_VARIANTS = \"\"\"\n                      INSERT INTO product_variants\n                      (product_id, variant_sku, color, size, manufacturing_price, selling_price,\n                       stock_quantity, is_active, created_at, updated_at)\n                      VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s) ON CONFLICT (variant_sku) DO\n                      UPDATE\n                          SET color=EXCLUDED.color, size =EXCLUDED.size,\n                          manufacturing_price=EXCLUDED.manufacturing_price,\n                          selling_price=EXCLUDED.selling_price,\n                          stock_quantity=EXCLUDED.stock_quantity,\n                          updated_at=EXCLUDED.updated_at; \\\n                      \"\"\"\n\nSQL_DELETE_ORDERS_IN_WINDOW = \"DELETE FROM orders WHERE order_date BETWEEN %s AND %s;\"\n\nSQL_INSERT_ORDERS = \"\"\"\n                    INSERT INTO orders(customer_id, order_date, status, total_amount, created_at, updated_at)\n                    VALUES (%s, %s, %s, %s, %s, %s); \\\n                    \"\"\"\n\nSQL_INSERT_ORDER_ITEMS = \"\"\"\n                         INSERT INTO order_items(order_id, variant_id, quantity, unit_price, created_at)\n                         VALUES (%s, %s, %s, %s, %s); \\\n                         \"\"\"\n\nSQL_UPDATE_ORDER_TOTALS = \"\"\"\n                          UPDATE orders o\n                          SET total_amount = COALESCE(oi.sum_total, 0) FROM (\n  SELECT order_id, SUM(total_price) sum_total\n  FROM order_items GROUP BY order_id\n) oi\n                          WHERE o.id = oi.order_id\n                            AND o.order_date BETWEEN %s\n                            AND %s; \\\n                          \"\"\"\n\nSQL_STATS_COUNTS = {\n    \"customers\": \"SELECT COUNT(*) FROM customers\",\n    \"products\": \"SELECT COUNT(*) FROM products\",\n    \"variants\": \"SELECT COUNT(*) FROM product_variants\",\n    \"orders\": \"SELECT COUNT(*) FROM orders WHERE order_date BETWEEN %s AND %s\",\n    \"items\": \"\"\"\n             SELECT COUNT(*)\n             FROM order_items oi\n                      JOIN orders o ON o.id = oi.order_id\n             WHERE o.order_date BETWEEN %s AND %s;\n             \"\"\",\n}\n\nSQL_CHAOS_VALIDATION = \"\"\"\n                       SELECT p.category,\n                              SUM(CASE\n                                      WHEN (p.category = 'shoes' AND v.size !~ '^[0-9]+$')\n                                          OR (p.category \u003C> 'shoes' AND v.size NOT IN ('S', 'M', 'L', 'XL'))\n                                          THEN 1\n                                      ELSE 0 END) invalid\n                       FROM product_variants v\n                                JOIN products p ON p.id = v.product_id\n                       GROUP BY 1\n                       ORDER BY 1; \\\n                       \"\"\"\n\n\ndef parse_args():\n    now = datetime.now(timezone.utc)\n    day_start = now.replace(hour=0, minute=0, second=0, microsecond=0)\n    day_end = now.replace(hour=23, minute=59, second=59, microsecond=999999)\n\n    p = argparse.ArgumentParser(description=\"Generate demo ecommerce data (idempotent).\")\n    p.add_argument(\"--dsn\", required=True, help=\"PostgreSQL DSN\")\n    p.add_argument(\"--customers\", type=int, default=100)\n    p.add_argument(\"--products\", type=int, default=50)\n    p.add_argument(\"--orders\", type=int, default=500)\n    p.add_argument(\"--max-items-per-order\", type=int, default=5)\n    p.add_argument(\"--chaos-percent\", type=float, default=0.0, help=\"%% of variants with invalid sizes\")\n    p.add_argument(\"--scale\", type=int, default=1, help=\"Multiply base volumes\")\n    p.add_argument(\"--seed\", type=int, default=42, help=\"Deterministic RNG seed\")\n    p.add_argument(\"--starting-at\", type=str, help=\"ISO start (e.g. 2024-01-01)\")\n    p.add_argument(\"--ending-at\", type=str, help=\"ISO end (e.g. 2024-06-30)\")\n\n    a = p.parse_args()\n    a.starting_at = a.starting_at or day_start.isoformat()\n    a.ending_at = a.ending_at or day_end.isoformat()\n    return a\n\n\ndef iso(dt):\n    return datetime.fromisoformat(dt).astimezone(timezone.utc)\n\n\ndef rdate(s, e):\n    \"\"\"Return random datetime between s and e.\"\"\"\n    return s + timedelta(seconds=random.randint(0, int((e - s).total_seconds())))\n\n\ndef execmany(conn, sql, rows):\n    with conn.cursor() as cur:\n        cur.executemany(sql, rows)\n    conn.commit()\n\ndef gen_customers(n):\n    for _ in range(n):\n        yield (\n            fake.name(),\n            fake.unique.email(),\n            fake.country(),\n            random.randint(18, 70),\n            datetime.now(timezone.utc),\n            datetime.now(timezone.utc),\n        )\n\n\ndef gen_products(n):\n    for _ in range(n):\n        cat = random.choice(PRODUCT_CATEGORIES)\n        yield (\n            f\"{fake.word().capitalize()} {cat}\",\n            cat,\n            fake.unique.bothify(\"SKU-####-??\").upper(),\n            datetime.now(timezone.utc),\n            datetime.now(timezone.utc),\n        )\n\n\ndef gen_variants(prod_rows, chaos):\n    for pid, cat in prod_rows:\n        for _ in range(random.randint(1, 4)):\n            sku = fake.unique.bothify(\"VAR-####-??\").upper()\n            color = random.choice(COLORS)\n            size = str(random.choice(SIZES_SHOES)) if cat == \"shoes\" else random.choice(SIZES_APPAREL)\n\n            # Chaos mode\n            if chaos > 0 and random.random() \u003C (chaos / 100):\n                if cat == \"shoes\":\n                    size = random.choice(SIZES_APPAREL)\n                else:\n                    size = str(random.choice(SIZES_SHOES))\n\n            manuf = round(random.uniform(10, 80), 2)\n            sell = round(manuf * random.uniform(1.2, 2.0), 2)\n            yield (\n                pid, sku, color, size, manuf, sell,\n                random.randint(0, 200), True,\n                datetime.now(timezone.utc), datetime.now(timezone.utc),\n            )\n\n\ndef gen_orders(cust_ids, n, s, e):\n    for _ in range(n):\n        yield (random.choice(cust_ids), rdate(s, e), random.choices(ORDER_STATUSES, ORDER_STATUS_WEIGHTS)[0], 0.0,\n               datetime.now(timezone.utc), datetime.now(timezone.utc),)\n\n\ndef gen_items(order_ids, variant_ids, max_items):\n    for oid in order_ids:\n        for vid in random.sample(variant_ids, random.randint(1, max(1, max_items))):\n            yield (oid, vid, random.randint(1, 3), round(random.uniform(20, 200), 2), datetime.now(timezone.utc))\n\n\ndef print_box_summary(S, E, c_cnt, p_cnt, v_cnt, o_cnt, i_cnt, max_items, bad_by_cat):\n    print(\"\\n✅ Data generation complete (idempotent window load)\")\n    print(f\"Window: {S.isoformat()} → {E.isoformat()}\")\n    print(f\"Counts — Customers: {c_cnt:,} | Products: {p_cnt:,} | Variants: {v_cnt:,}\")\n    print(f\"Window Facts — Orders: {o_cnt:,} | Items: {i_cnt:,} | MaxItems/Order: {max_items}\")\n    print(\"Chaos check (invalid sizes per category):\")\n    for cat, bad in bad_by_cat:\n        print(f\"  • {cat}: {bad:,} invalid\")\n\n\ndef main():\n    args = parse_args()\n    random.seed(args.seed)\n    Faker.seed(args.seed)\n    S, E = iso(args.starting_at), iso(args.ending_at)\n\n    print(\"\\n=== Generating E-commerce Demo Data ===\")\n    print(f\"Window: {S.isoformat()} → {E.isoformat()}\")\n    print(f\"Scale x{args.scale} | Seed {args.seed} | Chaos {args.chaos_percent:.1f}%\\n\")\n\n    base_c, base_p, base_o = args.customers, args.products, args.orders\n    n_c, n_p, n_o = base_c * args.scale, base_p * args.scale, base_o * args.scale\n\n    with psycopg.connect(args.dsn) as conn:\n        execmany(conn, SQL_INSERT_CUSTOMERS, gen_customers(n_c))\n        execmany(conn, SQL_INSERT_PRODUCTS, gen_products(n_p))\n\n        prod_rows = list(conn.execute(\"SELECT id, category FROM products\"))\n        execmany(conn, SQL_INSERT_VARIANTS, gen_variants(prod_rows, args.chaos_percent))\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_DELETE_ORDERS_IN_WINDOW, (S, E))\n        conn.commit()\n\n        cust_ids = [r[0] for r in conn.execute(\"SELECT id FROM customers\")]\n        execmany(conn, SQL_INSERT_ORDERS, gen_orders(cust_ids, n_o, S, E))\n\n        order_ids = [r[0] for r in conn.execute(\"SELECT id FROM orders WHERE order_date BETWEEN %s AND %s\", (S, E))]\n        variant_ids = [r[0] for r in conn.execute(\"SELECT id FROM product_variants\")]\n        execmany(conn, SQL_INSERT_ORDER_ITEMS, gen_items(order_ids, variant_ids, args.max_items_per_order))\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_UPDATE_ORDER_TOTALS, (S, E))\n        conn.commit()\n\n        with conn.cursor() as cur:\n            cur.execute(SQL_STATS_COUNTS[\"customers\"]);\n            c_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"products\"]);\n            p_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"variants\"]);\n            v_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"orders\"], (S, E));\n            o_cnt = cur.fetchone()[0]\n            cur.execute(SQL_STATS_COUNTS[\"items\"], (S, E));\n            i_cnt = cur.fetchone()[0]\n            cur.execute(SQL_CHAOS_VALIDATION);\n            bad_by_cat = cur.fetchall()\n\n    print_box_summary(S, E, c_cnt, p_cnt, v_cnt, o_cnt, i_cnt, args.max_items_per_order, bad_by_cat)\n\n\nif __name__ == \"__main__\":\n    main()\n","python",[47,3318,3319,3324,3330,3335,3339,3344,3349,3353,3357,3370,3393,3405,3412,3416,3421,3426,3430,3434,3446,3450,3455,3512,3566,3611,3645,3688,3717,3721,3726,3736,3741,3772,3777,3782,3790,3795,3799,3808,3813,3839,3844,3849,3856,3861,3865,3874,3879,3884,3889,3934,3938,3943,3948,3953,3958,3964,3968,3972,3996,4000,4009,4014,4046,4051,4055,4064,4069,4096,4101,4105,4114,4119,4124,4129,4135,4141,4147,4156,4169,4175,4180,4191,4213,4234,4255,4282,4296,4302,4308,4314,4328,4336,4342,4347,4357,4363,4369,4375,4381,4387,4393,4399,4405,4411,4419,4424,4429,4434,4446,4474,4528,4579,4584,4614,4656,4696,4733,4770,4807,4861,4911,4961,5003,5044,5049,5067,5101,5130,5139,5144,5149,5165,5197,5202,5207,5227,5238,5295,5300,5305,5330,5354,5375,5388,5393,5408,5429,5437,5450,5467,5479,5501,5521,5540,5546,5551,5556,5570,5587,5610,5617,5658,5666,5696,5715,5734,5739,5744,5749,5769,5789,5821,5855,5876,5933,5938,5944,5984,6002,6022,6030,6054,6059,6096,6135,6143,6176,6200,6236,6242,6247,6252,6280,6297,6358,6395,6400,6405,6430,6445,6495,6570,6575,6580,6633,6653,6698,6748,6795,6811,6830,6866,6871,6876,6886,6898,6920,6940,6977,6982,7000,7041,7103,7108,7150,7205,7210,7241,7267,7292,7297,7328,7360,7365,7385,7412,7424,7429,7476,7514,7519,7577,7618,7655,7660,7679,7705,7716,7721,7740,7767,7789,7814,7834,7859,7879,7914,7934,7969,7989,8007,8024,8029,8077,8082,8087,8107],{"__ignoreMap":45},[50,3320,3321],{"class":52,"line":53},[50,3322,3323],{"class":950},"#!/usr/bin/env python3\n",[50,3325,3326],{"class":52,"line":67},[50,3327,3329],{"class":3328},"s7zQu","\"\"\"\n",[50,3331,3332],{"class":52,"line":76},[50,3333,3334],{"class":950},"E-commerce demo data generator (Postgres).\n",[50,3336,3337],{"class":52,"line":84},[50,3338,371],{"emptyLinePlaceholder":370},[50,3340,3341],{"class":52,"line":92},[50,3342,3343],{"class":950},"Usage:\n",[50,3345,3346],{"class":52,"line":100},[50,3347,3348],{"class":950},"    uv run generate-data --dsn postgresql://user:pass@host:5432/db\n",[50,3350,3351],{"class":52,"line":114},[50,3352,3329],{"class":3328},[50,3354,3355],{"class":52,"line":125},[50,3356,371],{"emptyLinePlaceholder":370},[50,3358,3359,3362,3365,3367],{"class":52,"line":135},[50,3360,3361],{"class":3328},"import",[50,3363,3364],{"class":1221}," argparse",[50,3366,1542],{"class":60},[50,3368,3369],{"class":1221}," random\n",[50,3371,3372,3375,3378,3380,3383,3385,3388,3390],{"class":52,"line":146},[50,3373,3374],{"class":3328},"from",[50,3376,3377],{"class":1221}," datetime ",[50,3379,3361],{"class":3328},[50,3381,3382],{"class":1221}," datetime",[50,3384,1542],{"class":60},[50,3386,3387],{"class":1221}," timedelta",[50,3389,1542],{"class":60},[50,3391,3392],{"class":1221}," timezone\n",[50,3394,3395,3397,3400,3402],{"class":52,"line":158},[50,3396,3374],{"class":3328},[50,3398,3399],{"class":1221}," faker ",[50,3401,3361],{"class":3328},[50,3403,3404],{"class":1221}," Faker\n",[50,3406,3407,3409],{"class":52,"line":168},[50,3408,3361],{"class":3328},[50,3410,3411],{"class":1221}," psycopg\n",[50,3413,3414],{"class":52,"line":176},[50,3415,371],{"emptyLinePlaceholder":370},[50,3417,3418],{"class":52,"line":188},[50,3419,3420],{"class":950},"# -------------------------------------------------------------------\n",[50,3422,3423],{"class":52,"line":316},[50,3424,3425],{"class":950},"# GLOBAL CONFIGURATION\n",[50,3427,3428],{"class":52,"line":324},[50,3429,3420],{"class":950},[50,3431,3432],{"class":52,"line":334},[50,3433,371],{"emptyLinePlaceholder":370},[50,3435,3436,3439,3441,3444],{"class":52,"line":341},[50,3437,3438],{"class":1221},"fake ",[50,3440,1514],{"class":60},[50,3442,3443],{"class":1362}," Faker",[50,3445,2359],{"class":60},[50,3447,3448],{"class":52,"line":352},[50,3449,371],{"emptyLinePlaceholder":370},[50,3451,3452],{"class":52,"line":359},[50,3453,3454],{"class":950},"# --- Static categorical constants ---\n",[50,3456,3457,3460,3462,3465,3468,3471,3473,3475,3477,3480,3482,3484,3486,3489,3491,3493,3495,3498,3500,3502,3504,3507,3509],{"class":52,"line":367},[50,3458,3459],{"class":1221},"PRODUCT_CATEGORIES ",[50,3461,1514],{"class":60},[50,3463,3464],{"class":60}," [",[50,3466,3467],{"class":60},"\"",[50,3469,3470],{"class":63},"t-shirts",[50,3472,3467],{"class":60},[50,3474,1542],{"class":60},[50,3476,241],{"class":60},[50,3478,3479],{"class":63},"hoodies",[50,3481,3467],{"class":60},[50,3483,1542],{"class":60},[50,3485,241],{"class":60},[50,3487,3488],{"class":63},"shoes",[50,3490,3467],{"class":60},[50,3492,1542],{"class":60},[50,3494,241],{"class":60},[50,3496,3497],{"class":63},"accessories",[50,3499,3467],{"class":60},[50,3501,1542],{"class":60},[50,3503,241],{"class":60},[50,3505,3506],{"class":63},"jackets",[50,3508,3467],{"class":60},[50,3510,3511],{"class":60},"]\n",[50,3513,3514,3517,3519,3521,3523,3526,3528,3530,3532,3535,3537,3539,3541,3544,3546,3548,3550,3553,3555,3557,3559,3562,3564],{"class":52,"line":374},[50,3515,3516],{"class":1221},"COLORS ",[50,3518,1514],{"class":60},[50,3520,3464],{"class":60},[50,3522,3467],{"class":60},[50,3524,3525],{"class":63},"Red",[50,3527,3467],{"class":60},[50,3529,1542],{"class":60},[50,3531,241],{"class":60},[50,3533,3534],{"class":63},"Blue",[50,3536,3467],{"class":60},[50,3538,1542],{"class":60},[50,3540,241],{"class":60},[50,3542,3543],{"class":63},"Black",[50,3545,3467],{"class":60},[50,3547,1542],{"class":60},[50,3549,241],{"class":60},[50,3551,3552],{"class":63},"White",[50,3554,3467],{"class":60},[50,3556,1542],{"class":60},[50,3558,241],{"class":60},[50,3560,3561],{"class":63},"Green",[50,3563,3467],{"class":60},[50,3565,3511],{"class":60},[50,3567,3568,3571,3573,3575,3577,3580,3582,3584,3586,3589,3591,3593,3595,3598,3600,3602,3604,3607,3609],{"class":52,"line":382},[50,3569,3570],{"class":1221},"SIZES_APPAREL ",[50,3572,1514],{"class":60},[50,3574,3464],{"class":60},[50,3576,3467],{"class":60},[50,3578,3579],{"class":63},"S",[50,3581,3467],{"class":60},[50,3583,1542],{"class":60},[50,3585,241],{"class":60},[50,3587,3588],{"class":63},"M",[50,3590,3467],{"class":60},[50,3592,1542],{"class":60},[50,3594,241],{"class":60},[50,3596,3597],{"class":63},"L",[50,3599,3467],{"class":60},[50,3601,1542],{"class":60},[50,3603,241],{"class":60},[50,3605,3606],{"class":63},"XL",[50,3608,3467],{"class":60},[50,3610,3511],{"class":60},[50,3612,3613,3616,3618,3620,3623,3625,3628,3630,3633,3635,3638,3640,3643],{"class":52,"line":390},[50,3614,3615],{"class":1221},"SIZES_SHOES ",[50,3617,1514],{"class":60},[50,3619,3464],{"class":60},[50,3621,3622],{"class":154},"36",[50,3624,1542],{"class":60},[50,3626,3627],{"class":154}," 38",[50,3629,1542],{"class":60},[50,3631,3632],{"class":154}," 40",[50,3634,1542],{"class":60},[50,3636,3637],{"class":154}," 42",[50,3639,1542],{"class":60},[50,3641,3642],{"class":154}," 44",[50,3644,3511],{"class":60},[50,3646,3647,3650,3652,3654,3656,3659,3661,3663,3665,3667,3669,3671,3673,3676,3678,3680,3682,3684,3686],{"class":52,"line":400},[50,3648,3649],{"class":1221},"ORDER_STATUSES ",[50,3651,1514],{"class":60},[50,3653,3464],{"class":60},[50,3655,3467],{"class":60},[50,3657,3658],{"class":63},"pending",[50,3660,3467],{"class":60},[50,3662,1542],{"class":60},[50,3664,241],{"class":60},[50,3666,1537],{"class":63},[50,3668,3467],{"class":60},[50,3670,1542],{"class":60},[50,3672,241],{"class":60},[50,3674,3675],{"class":63},"cancelled",[50,3677,3467],{"class":60},[50,3679,1542],{"class":60},[50,3681,241],{"class":60},[50,3683,1547],{"class":63},[50,3685,3467],{"class":60},[50,3687,3511],{"class":60},[50,3689,3690,3693,3695,3697,3700,3702,3705,3707,3710,3712,3715],{"class":52,"line":408},[50,3691,3692],{"class":1221},"ORDER_STATUS_WEIGHTS ",[50,3694,1514],{"class":60},[50,3696,3464],{"class":60},[50,3698,3699],{"class":154},"0.2",[50,3701,1542],{"class":60},[50,3703,3704],{"class":154}," 0.5",[50,3706,1542],{"class":60},[50,3708,3709],{"class":154}," 0.1",[50,3711,1542],{"class":60},[50,3713,3714],{"class":154}," 0.2",[50,3716,3511],{"class":60},[50,3718,3719],{"class":52,"line":416},[50,3720,371],{"emptyLinePlaceholder":370},[50,3722,3723],{"class":52,"line":427},[50,3724,3725],{"class":950},"# --- SQL Statements ---\n",[50,3727,3728,3731,3733],{"class":52,"line":438},[50,3729,3730],{"class":1221},"SQL_INSERT_CUSTOMERS ",[50,3732,1514],{"class":60},[50,3734,3735],{"class":60}," \"\"\"\n",[50,3737,3738],{"class":52,"line":450},[50,3739,3740],{"class":63},"                       INSERT INTO customers(full_name, email, country, age, created_at, updated_at)\n",[50,3742,3743,3746,3749,3751,3753,3755,3757,3759,3761,3763,3765,3767,3769],{"class":52,"line":461},[50,3744,3745],{"class":63},"                       VALUES (",[50,3747,3748],{"class":154},"%s",[50,3750,2140],{"class":63},[50,3752,3748],{"class":154},[50,3754,2140],{"class":63},[50,3756,3748],{"class":154},[50,3758,2140],{"class":63},[50,3760,3748],{"class":154},[50,3762,2140],{"class":63},[50,3764,3748],{"class":154},[50,3766,2140],{"class":63},[50,3768,3748],{"class":154},[50,3770,3771],{"class":63},") ON CONFLICT (email) DO\n",[50,3773,3774],{"class":52,"line":469},[50,3775,3776],{"class":63},"                       UPDATE\n",[50,3778,3779],{"class":52,"line":482},[50,3780,3781],{"class":63},"                           SET full_name=EXCLUDED.full_name, country=EXCLUDED.country,\n",[50,3783,3784,3787],{"class":52,"line":494},[50,3785,3786],{"class":63},"                           age=EXCLUDED.age, updated_at=EXCLUDED.updated_at; ",[50,3788,3789],{"class":60},"\\\n",[50,3791,3792],{"class":52,"line":502},[50,3793,3794],{"class":60},"                       \"\"\"\n",[50,3796,3797],{"class":52,"line":512},[50,3798,371],{"emptyLinePlaceholder":370},[50,3800,3801,3804,3806],{"class":52,"line":522},[50,3802,3803],{"class":1221},"SQL_INSERT_PRODUCTS ",[50,3805,1514],{"class":60},[50,3807,3735],{"class":60},[50,3809,3810],{"class":52,"line":532},[50,3811,3812],{"class":63},"                      INSERT INTO products(name, category, sku, created_at, updated_at)\n",[50,3814,3815,3818,3820,3822,3824,3826,3828,3830,3832,3834,3836],{"class":52,"line":539},[50,3816,3817],{"class":63},"                      VALUES (",[50,3819,3748],{"class":154},[50,3821,2140],{"class":63},[50,3823,3748],{"class":154},[50,3825,2140],{"class":63},[50,3827,3748],{"class":154},[50,3829,2140],{"class":63},[50,3831,3748],{"class":154},[50,3833,2140],{"class":63},[50,3835,3748],{"class":154},[50,3837,3838],{"class":63},") ON CONFLICT (sku) DO\n",[50,3840,3841],{"class":52,"line":550},[50,3842,3843],{"class":63},"                      UPDATE\n",[50,3845,3846],{"class":52,"line":558},[50,3847,3848],{"class":63},"                          SET name=EXCLUDED.name, category=EXCLUDED.category,\n",[50,3850,3851,3854],{"class":52,"line":568},[50,3852,3853],{"class":63},"                          updated_at=EXCLUDED.updated_at; ",[50,3855,3789],{"class":60},[50,3857,3858],{"class":52,"line":577},[50,3859,3860],{"class":60},"                      \"\"\"\n",[50,3862,3863],{"class":52,"line":587},[50,3864,371],{"emptyLinePlaceholder":370},[50,3866,3867,3870,3872],{"class":52,"line":594},[50,3868,3869],{"class":1221},"SQL_INSERT_VARIANTS ",[50,3871,1514],{"class":60},[50,3873,3735],{"class":60},[50,3875,3876],{"class":52,"line":605},[50,3877,3878],{"class":63},"                      INSERT INTO product_variants\n",[50,3880,3881],{"class":52,"line":613},[50,3882,3883],{"class":63},"                      (product_id, variant_sku, color, size, manufacturing_price, selling_price,\n",[50,3885,3886],{"class":52,"line":623},[50,3887,3888],{"class":63},"                       stock_quantity, is_active, created_at, updated_at)\n",[50,3890,3891,3893,3895,3897,3899,3901,3903,3905,3907,3909,3911,3913,3915,3917,3919,3921,3923,3925,3927,3929,3931],{"class":52,"line":631},[50,3892,3817],{"class":63},[50,3894,3748],{"class":154},[50,3896,2140],{"class":63},[50,3898,3748],{"class":154},[50,3900,2140],{"class":63},[50,3902,3748],{"class":154},[50,3904,2140],{"class":63},[50,3906,3748],{"class":154},[50,3908,2140],{"class":63},[50,3910,3748],{"class":154},[50,3912,2140],{"class":63},[50,3914,3748],{"class":154},[50,3916,2140],{"class":63},[50,3918,3748],{"class":154},[50,3920,2140],{"class":63},[50,3922,3748],{"class":154},[50,3924,2140],{"class":63},[50,3926,3748],{"class":154},[50,3928,2140],{"class":63},[50,3930,3748],{"class":154},[50,3932,3933],{"class":63},") ON CONFLICT (variant_sku) DO\n",[50,3935,3936],{"class":52,"line":639},[50,3937,3843],{"class":63},[50,3939,3940],{"class":52,"line":646},[50,3941,3942],{"class":63},"                          SET color=EXCLUDED.color, size =EXCLUDED.size,\n",[50,3944,3945],{"class":52,"line":653},[50,3946,3947],{"class":63},"                          manufacturing_price=EXCLUDED.manufacturing_price,\n",[50,3949,3950],{"class":52,"line":663},[50,3951,3952],{"class":63},"                          selling_price=EXCLUDED.selling_price,\n",[50,3954,3955],{"class":52,"line":672},[50,3956,3957],{"class":63},"                          stock_quantity=EXCLUDED.stock_quantity,\n",[50,3959,3960,3962],{"class":52,"line":679},[50,3961,3853],{"class":63},[50,3963,3789],{"class":60},[50,3965,3966],{"class":52,"line":690},[50,3967,3860],{"class":60},[50,3969,3970],{"class":52,"line":701},[50,3971,371],{"emptyLinePlaceholder":370},[50,3973,3974,3977,3979,3981,3984,3986,3989,3991,3994],{"class":52,"line":709},[50,3975,3976],{"class":1221},"SQL_DELETE_ORDERS_IN_WINDOW ",[50,3978,1514],{"class":60},[50,3980,241],{"class":60},[50,3982,3983],{"class":63},"DELETE FROM orders WHERE order_date BETWEEN ",[50,3985,3748],{"class":154},[50,3987,3988],{"class":63}," AND ",[50,3990,3748],{"class":154},[50,3992,3993],{"class":63},";",[50,3995,247],{"class":60},[50,3997,3998],{"class":52,"line":719},[50,3999,371],{"emptyLinePlaceholder":370},[50,4001,4002,4005,4007],{"class":52,"line":729},[50,4003,4004],{"class":1221},"SQL_INSERT_ORDERS ",[50,4006,1514],{"class":60},[50,4008,3735],{"class":60},[50,4010,4011],{"class":52,"line":736},[50,4012,4013],{"class":63},"                    INSERT INTO orders(customer_id, order_date, status, total_amount, created_at, updated_at)\n",[50,4015,4016,4019,4021,4023,4025,4027,4029,4031,4033,4035,4037,4039,4041,4044],{"class":52,"line":747},[50,4017,4018],{"class":63},"                    VALUES (",[50,4020,3748],{"class":154},[50,4022,2140],{"class":63},[50,4024,3748],{"class":154},[50,4026,2140],{"class":63},[50,4028,3748],{"class":154},[50,4030,2140],{"class":63},[50,4032,3748],{"class":154},[50,4034,2140],{"class":63},[50,4036,3748],{"class":154},[50,4038,2140],{"class":63},[50,4040,3748],{"class":154},[50,4042,4043],{"class":63},"); ",[50,4045,3789],{"class":60},[50,4047,4048],{"class":52,"line":755},[50,4049,4050],{"class":60},"                    \"\"\"\n",[50,4052,4053],{"class":52,"line":765},[50,4054,371],{"emptyLinePlaceholder":370},[50,4056,4057,4060,4062],{"class":52,"line":774},[50,4058,4059],{"class":1221},"SQL_INSERT_ORDER_ITEMS ",[50,4061,1514],{"class":60},[50,4063,3735],{"class":60},[50,4065,4066],{"class":52,"line":782},[50,4067,4068],{"class":63},"                         INSERT INTO order_items(order_id, variant_id, quantity, unit_price, created_at)\n",[50,4070,4071,4074,4076,4078,4080,4082,4084,4086,4088,4090,4092,4094],{"class":52,"line":792},[50,4072,4073],{"class":63},"                         VALUES (",[50,4075,3748],{"class":154},[50,4077,2140],{"class":63},[50,4079,3748],{"class":154},[50,4081,2140],{"class":63},[50,4083,3748],{"class":154},[50,4085,2140],{"class":63},[50,4087,3748],{"class":154},[50,4089,2140],{"class":63},[50,4091,3748],{"class":154},[50,4093,4043],{"class":63},[50,4095,3789],{"class":60},[50,4097,4098],{"class":52,"line":801},[50,4099,4100],{"class":60},"                         \"\"\"\n",[50,4102,4103],{"class":52,"line":809},[50,4104,371],{"emptyLinePlaceholder":370},[50,4106,4107,4110,4112],{"class":52,"line":819},[50,4108,4109],{"class":1221},"SQL_UPDATE_ORDER_TOTALS ",[50,4111,1514],{"class":60},[50,4113,3735],{"class":60},[50,4115,4116],{"class":52,"line":828},[50,4117,4118],{"class":63},"                          UPDATE orders o\n",[50,4120,4121],{"class":52,"line":835},[50,4122,4123],{"class":63},"                          SET total_amount = COALESCE(oi.sum_total, 0) FROM (\n",[50,4125,4126],{"class":52,"line":847},[50,4127,4128],{"class":63},"  SELECT order_id, SUM(total_price) sum_total\n",[50,4130,4132],{"class":52,"line":4131},74,[50,4133,4134],{"class":63},"  FROM order_items GROUP BY order_id\n",[50,4136,4138],{"class":52,"line":4137},75,[50,4139,4140],{"class":63},") oi\n",[50,4142,4144],{"class":52,"line":4143},76,[50,4145,4146],{"class":63},"                          WHERE o.id = oi.order_id\n",[50,4148,4150,4153],{"class":52,"line":4149},77,[50,4151,4152],{"class":63},"                            AND o.order_date BETWEEN ",[50,4154,4155],{"class":154},"%s\n",[50,4157,4159,4162,4164,4167],{"class":52,"line":4158},78,[50,4160,4161],{"class":63},"                            AND ",[50,4163,3748],{"class":154},[50,4165,4166],{"class":63},"; ",[50,4168,3789],{"class":60},[50,4170,4172],{"class":52,"line":4171},79,[50,4173,4174],{"class":60},"                          \"\"\"\n",[50,4176,4178],{"class":52,"line":4177},80,[50,4179,371],{"emptyLinePlaceholder":370},[50,4181,4183,4186,4188],{"class":52,"line":4182},81,[50,4184,4185],{"class":1221},"SQL_STATS_COUNTS ",[50,4187,1514],{"class":60},[50,4189,4190],{"class":60}," {\n",[50,4192,4194,4197,4200,4202,4204,4206,4209,4211],{"class":52,"line":4193},82,[50,4195,4196],{"class":60},"    \"",[50,4198,4199],{"class":63},"customers",[50,4201,3467],{"class":60},[50,4203,34],{"class":60},[50,4205,241],{"class":60},[50,4207,4208],{"class":63},"SELECT COUNT(*) FROM customers",[50,4210,3467],{"class":60},[50,4212,2259],{"class":60},[50,4214,4216,4218,4221,4223,4225,4227,4230,4232],{"class":52,"line":4215},83,[50,4217,4196],{"class":60},[50,4219,4220],{"class":63},"products",[50,4222,3467],{"class":60},[50,4224,34],{"class":60},[50,4226,241],{"class":60},[50,4228,4229],{"class":63},"SELECT COUNT(*) FROM products",[50,4231,3467],{"class":60},[50,4233,2259],{"class":60},[50,4235,4237,4239,4242,4244,4246,4248,4251,4253],{"class":52,"line":4236},84,[50,4238,4196],{"class":60},[50,4240,4241],{"class":63},"variants",[50,4243,3467],{"class":60},[50,4245,34],{"class":60},[50,4247,241],{"class":60},[50,4249,4250],{"class":63},"SELECT COUNT(*) FROM product_variants",[50,4252,3467],{"class":60},[50,4254,2259],{"class":60},[50,4256,4258,4260,4263,4265,4267,4269,4272,4274,4276,4278,4280],{"class":52,"line":4257},85,[50,4259,4196],{"class":60},[50,4261,4262],{"class":63},"orders",[50,4264,3467],{"class":60},[50,4266,34],{"class":60},[50,4268,241],{"class":60},[50,4270,4271],{"class":63},"SELECT COUNT(*) FROM orders WHERE order_date BETWEEN ",[50,4273,3748],{"class":154},[50,4275,3988],{"class":63},[50,4277,3748],{"class":154},[50,4279,3467],{"class":60},[50,4281,2259],{"class":60},[50,4283,4285,4287,4290,4292,4294],{"class":52,"line":4284},86,[50,4286,4196],{"class":60},[50,4288,4289],{"class":63},"items",[50,4291,3467],{"class":60},[50,4293,34],{"class":60},[50,4295,3735],{"class":60},[50,4297,4299],{"class":52,"line":4298},87,[50,4300,4301],{"class":63},"             SELECT COUNT(*)\n",[50,4303,4305],{"class":52,"line":4304},88,[50,4306,4307],{"class":63},"             FROM order_items oi\n",[50,4309,4311],{"class":52,"line":4310},89,[50,4312,4313],{"class":63},"                      JOIN orders o ON o.id = oi.order_id\n",[50,4315,4317,4320,4322,4324,4326],{"class":52,"line":4316},90,[50,4318,4319],{"class":63},"             WHERE o.order_date BETWEEN ",[50,4321,3748],{"class":154},[50,4323,3988],{"class":63},[50,4325,3748],{"class":154},[50,4327,1406],{"class":63},[50,4329,4331,4334],{"class":52,"line":4330},91,[50,4332,4333],{"class":60},"             \"\"\"",[50,4335,2259],{"class":60},[50,4337,4339],{"class":52,"line":4338},92,[50,4340,4341],{"class":60},"}\n",[50,4343,4345],{"class":52,"line":4344},93,[50,4346,371],{"emptyLinePlaceholder":370},[50,4348,4350,4353,4355],{"class":52,"line":4349},94,[50,4351,4352],{"class":1221},"SQL_CHAOS_VALIDATION ",[50,4354,1514],{"class":60},[50,4356,3735],{"class":60},[50,4358,4360],{"class":52,"line":4359},95,[50,4361,4362],{"class":63},"                       SELECT p.category,\n",[50,4364,4366],{"class":52,"line":4365},96,[50,4367,4368],{"class":63},"                              SUM(CASE\n",[50,4370,4372],{"class":52,"line":4371},97,[50,4373,4374],{"class":63},"                                      WHEN (p.category = 'shoes' AND v.size !~ '^[0-9]+$')\n",[50,4376,4378],{"class":52,"line":4377},98,[50,4379,4380],{"class":63},"                                          OR (p.category \u003C> 'shoes' AND v.size NOT IN ('S', 'M', 'L', 'XL'))\n",[50,4382,4384],{"class":52,"line":4383},99,[50,4385,4386],{"class":63},"                                          THEN 1\n",[50,4388,4390],{"class":52,"line":4389},100,[50,4391,4392],{"class":63},"                                      ELSE 0 END) invalid\n",[50,4394,4396],{"class":52,"line":4395},101,[50,4397,4398],{"class":63},"                       FROM product_variants v\n",[50,4400,4402],{"class":52,"line":4401},102,[50,4403,4404],{"class":63},"                                JOIN products p ON p.id = v.product_id\n",[50,4406,4408],{"class":52,"line":4407},103,[50,4409,4410],{"class":63},"                       GROUP BY 1\n",[50,4412,4414,4417],{"class":52,"line":4413},104,[50,4415,4416],{"class":63},"                       ORDER BY 1; ",[50,4418,3789],{"class":60},[50,4420,4422],{"class":52,"line":4421},105,[50,4423,3794],{"class":60},[50,4425,4427],{"class":52,"line":4426},106,[50,4428,371],{"emptyLinePlaceholder":370},[50,4430,4432],{"class":52,"line":4431},107,[50,4433,371],{"emptyLinePlaceholder":370},[50,4435,4437,4440,4443],{"class":52,"line":4436},108,[50,4438,4439],{"class":1815},"def",[50,4441,4442],{"class":1362}," parse_args",[50,4444,4445],{"class":60},"():\n",[50,4447,4449,4452,4454,4456,4459,4462,4464,4467,4469,4472],{"class":52,"line":4448},109,[50,4450,4451],{"class":1221},"    now ",[50,4453,1514],{"class":60},[50,4455,3382],{"class":1221},[50,4457,4458],{"class":60},".",[50,4460,4461],{"class":1362},"now",[50,4463,1366],{"class":60},[50,4465,4466],{"class":1362},"timezone",[50,4468,4458],{"class":60},[50,4470,4471],{"class":56},"utc",[50,4473,1349],{"class":60},[50,4475,4477,4480,4482,4484,4486,4489,4491,4495,4497,4499,4501,4504,4506,4508,4510,4513,4515,4517,4519,4522,4524,4526],{"class":52,"line":4476},110,[50,4478,4479],{"class":1221},"    day_start ",[50,4481,1514],{"class":60},[50,4483,2338],{"class":1221},[50,4485,4458],{"class":60},[50,4487,4488],{"class":1362},"replace",[50,4490,1366],{"class":60},[50,4492,4494],{"class":4493},"sHdIc","hour",[50,4496,1514],{"class":60},[50,4498,1879],{"class":154},[50,4500,1542],{"class":60},[50,4502,4503],{"class":4493}," minute",[50,4505,1514],{"class":60},[50,4507,1879],{"class":154},[50,4509,1542],{"class":60},[50,4511,4512],{"class":4493}," second",[50,4514,1514],{"class":60},[50,4516,1879],{"class":154},[50,4518,1542],{"class":60},[50,4520,4521],{"class":4493}," microsecond",[50,4523,1514],{"class":60},[50,4525,1879],{"class":154},[50,4527,1349],{"class":60},[50,4529,4531,4534,4536,4538,4540,4542,4544,4546,4548,4551,4553,4555,4557,4560,4562,4564,4566,4568,4570,4572,4574,4577],{"class":52,"line":4530},111,[50,4532,4533],{"class":1221},"    day_end ",[50,4535,1514],{"class":60},[50,4537,2338],{"class":1221},[50,4539,4458],{"class":60},[50,4541,4488],{"class":1362},[50,4543,1366],{"class":60},[50,4545,4494],{"class":4493},[50,4547,1514],{"class":60},[50,4549,4550],{"class":154},"23",[50,4552,1542],{"class":60},[50,4554,4503],{"class":4493},[50,4556,1514],{"class":60},[50,4558,4559],{"class":154},"59",[50,4561,1542],{"class":60},[50,4563,4512],{"class":4493},[50,4565,1514],{"class":60},[50,4567,4559],{"class":154},[50,4569,1542],{"class":60},[50,4571,4521],{"class":4493},[50,4573,1514],{"class":60},[50,4575,4576],{"class":154},"999999",[50,4578,1349],{"class":60},[50,4580,4582],{"class":52,"line":4581},112,[50,4583,371],{"emptyLinePlaceholder":370},[50,4585,4587,4590,4592,4594,4596,4599,4601,4603,4605,4607,4610,4612],{"class":52,"line":4586},113,[50,4588,4589],{"class":1221},"    p ",[50,4591,1514],{"class":60},[50,4593,3364],{"class":1221},[50,4595,4458],{"class":60},[50,4597,4598],{"class":1362},"ArgumentParser",[50,4600,1366],{"class":60},[50,4602,985],{"class":4493},[50,4604,1514],{"class":60},[50,4606,3467],{"class":60},[50,4608,4609],{"class":63},"Generate demo ecommerce data (idempotent).",[50,4611,3467],{"class":60},[50,4613,1349],{"class":60},[50,4615,4617,4620,4622,4625,4627,4629,4632,4634,4636,4639,4642,4645,4647,4649,4652,4654],{"class":52,"line":4616},114,[50,4618,4619],{"class":1221},"    p",[50,4621,4458],{"class":60},[50,4623,4624],{"class":1362},"add_argument",[50,4626,1366],{"class":60},[50,4628,3467],{"class":60},[50,4630,4631],{"class":63},"--dsn",[50,4633,3467],{"class":60},[50,4635,1542],{"class":60},[50,4637,4638],{"class":4493}," required",[50,4640,4641],{"class":60},"=True,",[50,4643,4644],{"class":4493}," help",[50,4646,1514],{"class":60},[50,4648,3467],{"class":60},[50,4650,4651],{"class":63},"PostgreSQL DSN",[50,4653,3467],{"class":60},[50,4655,1349],{"class":60},[50,4657,4659,4661,4663,4665,4667,4669,4672,4674,4676,4679,4681,4684,4686,4689,4691,4694],{"class":52,"line":4658},115,[50,4660,4619],{"class":1221},[50,4662,4458],{"class":60},[50,4664,4624],{"class":1362},[50,4666,1366],{"class":60},[50,4668,3467],{"class":60},[50,4670,4671],{"class":63},"--customers",[50,4673,3467],{"class":60},[50,4675,1542],{"class":60},[50,4677,4678],{"class":4493}," type",[50,4680,1514],{"class":60},[50,4682,4683],{"class":2006},"int",[50,4685,1542],{"class":60},[50,4687,4688],{"class":4493}," default",[50,4690,1514],{"class":60},[50,4692,4693],{"class":154},"100",[50,4695,1349],{"class":60},[50,4697,4699,4701,4703,4705,4707,4709,4712,4714,4716,4718,4720,4722,4724,4726,4728,4731],{"class":52,"line":4698},116,[50,4700,4619],{"class":1221},[50,4702,4458],{"class":60},[50,4704,4624],{"class":1362},[50,4706,1366],{"class":60},[50,4708,3467],{"class":60},[50,4710,4711],{"class":63},"--products",[50,4713,3467],{"class":60},[50,4715,1542],{"class":60},[50,4717,4678],{"class":4493},[50,4719,1514],{"class":60},[50,4721,4683],{"class":2006},[50,4723,1542],{"class":60},[50,4725,4688],{"class":4493},[50,4727,1514],{"class":60},[50,4729,4730],{"class":154},"50",[50,4732,1349],{"class":60},[50,4734,4736,4738,4740,4742,4744,4746,4749,4751,4753,4755,4757,4759,4761,4763,4765,4768],{"class":52,"line":4735},117,[50,4737,4619],{"class":1221},[50,4739,4458],{"class":60},[50,4741,4624],{"class":1362},[50,4743,1366],{"class":60},[50,4745,3467],{"class":60},[50,4747,4748],{"class":63},"--orders",[50,4750,3467],{"class":60},[50,4752,1542],{"class":60},[50,4754,4678],{"class":4493},[50,4756,1514],{"class":60},[50,4758,4683],{"class":2006},[50,4760,1542],{"class":60},[50,4762,4688],{"class":4493},[50,4764,1514],{"class":60},[50,4766,4767],{"class":154},"500",[50,4769,1349],{"class":60},[50,4771,4773,4775,4777,4779,4781,4783,4786,4788,4790,4792,4794,4796,4798,4800,4802,4805],{"class":52,"line":4772},118,[50,4774,4619],{"class":1221},[50,4776,4458],{"class":60},[50,4778,4624],{"class":1362},[50,4780,1366],{"class":60},[50,4782,3467],{"class":60},[50,4784,4785],{"class":63},"--max-items-per-order",[50,4787,3467],{"class":60},[50,4789,1542],{"class":60},[50,4791,4678],{"class":4493},[50,4793,1514],{"class":60},[50,4795,4683],{"class":2006},[50,4797,1542],{"class":60},[50,4799,4688],{"class":4493},[50,4801,1514],{"class":60},[50,4803,4804],{"class":154},"5",[50,4806,1349],{"class":60},[50,4808,4810,4812,4814,4816,4818,4820,4823,4825,4827,4829,4831,4834,4836,4838,4840,4843,4845,4847,4849,4851,4854,4857,4859],{"class":52,"line":4809},119,[50,4811,4619],{"class":1221},[50,4813,4458],{"class":60},[50,4815,4624],{"class":1362},[50,4817,1366],{"class":60},[50,4819,3467],{"class":60},[50,4821,4822],{"class":63},"--chaos-percent",[50,4824,3467],{"class":60},[50,4826,1542],{"class":60},[50,4828,4678],{"class":4493},[50,4830,1514],{"class":60},[50,4832,4833],{"class":2006},"float",[50,4835,1542],{"class":60},[50,4837,4688],{"class":4493},[50,4839,1514],{"class":60},[50,4841,4842],{"class":154},"0.0",[50,4844,1542],{"class":60},[50,4846,4644],{"class":4493},[50,4848,1514],{"class":60},[50,4850,3467],{"class":60},[50,4852,4853],{"class":154},"%%",[50,4855,4856],{"class":63}," of variants with invalid sizes",[50,4858,3467],{"class":60},[50,4860,1349],{"class":60},[50,4862,4864,4866,4868,4870,4872,4874,4877,4879,4881,4883,4885,4887,4889,4891,4893,4896,4898,4900,4902,4904,4907,4909],{"class":52,"line":4863},120,[50,4865,4619],{"class":1221},[50,4867,4458],{"class":60},[50,4869,4624],{"class":1362},[50,4871,1366],{"class":60},[50,4873,3467],{"class":60},[50,4875,4876],{"class":63},"--scale",[50,4878,3467],{"class":60},[50,4880,1542],{"class":60},[50,4882,4678],{"class":4493},[50,4884,1514],{"class":60},[50,4886,4683],{"class":2006},[50,4888,1542],{"class":60},[50,4890,4688],{"class":4493},[50,4892,1514],{"class":60},[50,4894,4895],{"class":154},"1",[50,4897,1542],{"class":60},[50,4899,4644],{"class":4493},[50,4901,1514],{"class":60},[50,4903,3467],{"class":60},[50,4905,4906],{"class":63},"Multiply base volumes",[50,4908,3467],{"class":60},[50,4910,1349],{"class":60},[50,4912,4914,4916,4918,4920,4922,4924,4927,4929,4931,4933,4935,4937,4939,4941,4943,4946,4948,4950,4952,4954,4957,4959],{"class":52,"line":4913},121,[50,4915,4619],{"class":1221},[50,4917,4458],{"class":60},[50,4919,4624],{"class":1362},[50,4921,1366],{"class":60},[50,4923,3467],{"class":60},[50,4925,4926],{"class":63},"--seed",[50,4928,3467],{"class":60},[50,4930,1542],{"class":60},[50,4932,4678],{"class":4493},[50,4934,1514],{"class":60},[50,4936,4683],{"class":2006},[50,4938,1542],{"class":60},[50,4940,4688],{"class":4493},[50,4942,1514],{"class":60},[50,4944,4945],{"class":154},"42",[50,4947,1542],{"class":60},[50,4949,4644],{"class":4493},[50,4951,1514],{"class":60},[50,4953,3467],{"class":60},[50,4955,4956],{"class":63},"Deterministic RNG seed",[50,4958,3467],{"class":60},[50,4960,1349],{"class":60},[50,4962,4964,4966,4968,4970,4972,4974,4977,4979,4981,4983,4985,4988,4990,4992,4994,4996,4999,5001],{"class":52,"line":4963},122,[50,4965,4619],{"class":1221},[50,4967,4458],{"class":60},[50,4969,4624],{"class":1362},[50,4971,1366],{"class":60},[50,4973,3467],{"class":60},[50,4975,4976],{"class":63},"--starting-at",[50,4978,3467],{"class":60},[50,4980,1542],{"class":60},[50,4982,4678],{"class":4493},[50,4984,1514],{"class":60},[50,4986,4987],{"class":2006},"str",[50,4989,1542],{"class":60},[50,4991,4644],{"class":4493},[50,4993,1514],{"class":60},[50,4995,3467],{"class":60},[50,4997,4998],{"class":63},"ISO start (e.g. 2024-01-01)",[50,5000,3467],{"class":60},[50,5002,1349],{"class":60},[50,5004,5006,5008,5010,5012,5014,5016,5019,5021,5023,5025,5027,5029,5031,5033,5035,5037,5040,5042],{"class":52,"line":5005},123,[50,5007,4619],{"class":1221},[50,5009,4458],{"class":60},[50,5011,4624],{"class":1362},[50,5013,1366],{"class":60},[50,5015,3467],{"class":60},[50,5017,5018],{"class":63},"--ending-at",[50,5020,3467],{"class":60},[50,5022,1542],{"class":60},[50,5024,4678],{"class":4493},[50,5026,1514],{"class":60},[50,5028,4987],{"class":2006},[50,5030,1542],{"class":60},[50,5032,4644],{"class":4493},[50,5034,1514],{"class":60},[50,5036,3467],{"class":60},[50,5038,5039],{"class":63},"ISO end (e.g. 2024-06-30)",[50,5041,3467],{"class":60},[50,5043,1349],{"class":60},[50,5045,5047],{"class":52,"line":5046},124,[50,5048,371],{"emptyLinePlaceholder":370},[50,5050,5052,5055,5057,5060,5062,5065],{"class":52,"line":5051},125,[50,5053,5054],{"class":1221},"    a ",[50,5056,1514],{"class":60},[50,5058,5059],{"class":1221}," p",[50,5061,4458],{"class":60},[50,5063,5064],{"class":1362},"parse_args",[50,5066,2359],{"class":60},[50,5068,5070,5073,5075,5078,5081,5084,5086,5088,5091,5094,5096,5099],{"class":52,"line":5069},126,[50,5071,5072],{"class":1221},"    a",[50,5074,4458],{"class":60},[50,5076,5077],{"class":56},"starting_at",[50,5079,5080],{"class":60}," =",[50,5082,5083],{"class":1221}," a",[50,5085,4458],{"class":60},[50,5087,5077],{"class":56},[50,5089,5090],{"class":60}," or",[50,5092,5093],{"class":1221}," day_start",[50,5095,4458],{"class":60},[50,5097,5098],{"class":1362},"isoformat",[50,5100,2359],{"class":60},[50,5102,5104,5106,5108,5111,5113,5115,5117,5119,5121,5124,5126,5128],{"class":52,"line":5103},127,[50,5105,5072],{"class":1221},[50,5107,4458],{"class":60},[50,5109,5110],{"class":56},"ending_at",[50,5112,5080],{"class":60},[50,5114,5083],{"class":1221},[50,5116,4458],{"class":60},[50,5118,5110],{"class":56},[50,5120,5090],{"class":60},[50,5122,5123],{"class":1221}," day_end",[50,5125,4458],{"class":60},[50,5127,5098],{"class":1362},[50,5129,2359],{"class":60},[50,5131,5133,5136],{"class":52,"line":5132},128,[50,5134,5135],{"class":3328},"    return",[50,5137,5138],{"class":1221}," a\n",[50,5140,5142],{"class":52,"line":5141},129,[50,5143,371],{"emptyLinePlaceholder":370},[50,5145,5147],{"class":52,"line":5146},130,[50,5148,371],{"emptyLinePlaceholder":370},[50,5150,5152,5154,5157,5159,5162],{"class":52,"line":5151},131,[50,5153,4439],{"class":1815},[50,5155,5156],{"class":1362}," iso",[50,5158,1366],{"class":60},[50,5160,5161],{"class":4493},"dt",[50,5163,5164],{"class":60},"):\n",[50,5166,5168,5170,5172,5174,5177,5179,5181,5184,5187,5189,5191,5193,5195],{"class":52,"line":5167},132,[50,5169,5135],{"class":3328},[50,5171,3382],{"class":1221},[50,5173,4458],{"class":60},[50,5175,5176],{"class":1362},"fromisoformat",[50,5178,1366],{"class":60},[50,5180,5161],{"class":1362},[50,5182,5183],{"class":60},").",[50,5185,5186],{"class":1362},"astimezone",[50,5188,1366],{"class":60},[50,5190,4466],{"class":1362},[50,5192,4458],{"class":60},[50,5194,4471],{"class":56},[50,5196,1349],{"class":60},[50,5198,5200],{"class":52,"line":5199},133,[50,5201,371],{"emptyLinePlaceholder":370},[50,5203,5205],{"class":52,"line":5204},134,[50,5206,371],{"emptyLinePlaceholder":370},[50,5208,5210,5212,5215,5217,5220,5222,5225],{"class":52,"line":5209},135,[50,5211,4439],{"class":1815},[50,5213,5214],{"class":1362}," rdate",[50,5216,1366],{"class":60},[50,5218,5219],{"class":4493},"s",[50,5221,1542],{"class":60},[50,5223,5224],{"class":4493}," e",[50,5226,5164],{"class":60},[50,5228,5230,5233,5236],{"class":52,"line":5229},136,[50,5231,5232],{"class":3328},"    \"\"\"",[50,5234,5235],{"class":950},"Return random datetime between s and e.",[50,5237,3329],{"class":3328},[50,5239,5241,5243,5246,5249,5251,5253,5256,5258,5261,5263,5266,5268,5270,5272,5275,5278,5281,5284,5287,5289,5292],{"class":52,"line":5240},137,[50,5242,5135],{"class":3328},[50,5244,5245],{"class":1221}," s ",[50,5247,5248],{"class":60},"+",[50,5250,3387],{"class":1362},[50,5252,1366],{"class":60},[50,5254,5255],{"class":4493},"seconds",[50,5257,1514],{"class":60},[50,5259,5260],{"class":1362},"random",[50,5262,4458],{"class":60},[50,5264,5265],{"class":1362},"randint",[50,5267,1366],{"class":60},[50,5269,1879],{"class":154},[50,5271,1542],{"class":60},[50,5273,5274],{"class":2006}," int",[50,5276,5277],{"class":60},"((",[50,5279,5280],{"class":1362},"e ",[50,5282,5283],{"class":60},"-",[50,5285,5286],{"class":1362}," s",[50,5288,5183],{"class":60},[50,5290,5291],{"class":1362},"total_seconds",[50,5293,5294],{"class":60},"())))\n",[50,5296,5298],{"class":52,"line":5297},138,[50,5299,371],{"emptyLinePlaceholder":370},[50,5301,5303],{"class":52,"line":5302},139,[50,5304,371],{"emptyLinePlaceholder":370},[50,5306,5308,5310,5313,5315,5318,5320,5323,5325,5328],{"class":52,"line":5307},140,[50,5309,4439],{"class":1815},[50,5311,5312],{"class":1362}," execmany",[50,5314,1366],{"class":60},[50,5316,5317],{"class":4493},"conn",[50,5319,1542],{"class":60},[50,5321,5322],{"class":4493}," sql",[50,5324,1542],{"class":60},[50,5326,5327],{"class":4493}," rows",[50,5329,5164],{"class":60},[50,5331,5333,5336,5339,5341,5344,5346,5349,5352],{"class":52,"line":5332},141,[50,5334,5335],{"class":3328},"    with",[50,5337,5338],{"class":1221}," conn",[50,5340,4458],{"class":60},[50,5342,5343],{"class":1362},"cursor",[50,5345,2341],{"class":60},[50,5347,5348],{"class":3328}," as",[50,5350,5351],{"class":1221}," cur",[50,5353,73],{"class":60},[50,5355,5357,5360,5362,5365,5367,5369,5371,5373],{"class":52,"line":5356},142,[50,5358,5359],{"class":1221},"        cur",[50,5361,4458],{"class":60},[50,5363,5364],{"class":1362},"executemany",[50,5366,1366],{"class":60},[50,5368,1142],{"class":1362},[50,5370,1542],{"class":60},[50,5372,5327],{"class":1362},[50,5374,1349],{"class":60},[50,5376,5378,5381,5383,5386],{"class":52,"line":5377},143,[50,5379,5380],{"class":1221},"    conn",[50,5382,4458],{"class":60},[50,5384,5385],{"class":1362},"commit",[50,5387,2359],{"class":60},[50,5389,5391],{"class":52,"line":5390},144,[50,5392,371],{"emptyLinePlaceholder":370},[50,5394,5396,5398,5401,5403,5406],{"class":52,"line":5395},145,[50,5397,4439],{"class":1815},[50,5399,5400],{"class":1362}," gen_customers",[50,5402,1366],{"class":60},[50,5404,5405],{"class":4493},"n",[50,5407,5164],{"class":60},[50,5409,5411,5414,5417,5420,5423,5425,5427],{"class":52,"line":5410},146,[50,5412,5413],{"class":3328},"    for",[50,5415,5416],{"class":1221}," _ ",[50,5418,5419],{"class":3328},"in",[50,5421,5422],{"class":1362}," range",[50,5424,1366],{"class":60},[50,5426,5405],{"class":1362},[50,5428,5164],{"class":60},[50,5430,5432,5435],{"class":52,"line":5431},147,[50,5433,5434],{"class":3328},"        yield",[50,5436,1228],{"class":60},[50,5438,5440,5443,5445,5447],{"class":52,"line":5439},148,[50,5441,5442],{"class":1221},"            fake",[50,5444,4458],{"class":60},[50,5446,866],{"class":1362},[50,5448,5449],{"class":60},"(),\n",[50,5451,5453,5455,5457,5460,5462,5465],{"class":52,"line":5452},149,[50,5454,5442],{"class":1221},[50,5456,4458],{"class":60},[50,5458,5459],{"class":56},"unique",[50,5461,4458],{"class":60},[50,5463,5464],{"class":1362},"email",[50,5466,5449],{"class":60},[50,5468,5470,5472,5474,5477],{"class":52,"line":5469},150,[50,5471,5442],{"class":1221},[50,5473,4458],{"class":60},[50,5475,5476],{"class":1362},"country",[50,5478,5449],{"class":60},[50,5480,5482,5485,5487,5489,5491,5494,5496,5499],{"class":52,"line":5481},151,[50,5483,5484],{"class":1221},"            random",[50,5486,4458],{"class":60},[50,5488,5265],{"class":1362},[50,5490,1366],{"class":60},[50,5492,5493],{"class":154},"18",[50,5495,1542],{"class":60},[50,5497,5498],{"class":154}," 70",[50,5500,1556],{"class":60},[50,5502,5504,5507,5509,5511,5513,5515,5517,5519],{"class":52,"line":5503},152,[50,5505,5506],{"class":1221},"            datetime",[50,5508,4458],{"class":60},[50,5510,4461],{"class":1362},[50,5512,1366],{"class":60},[50,5514,4466],{"class":1362},[50,5516,4458],{"class":60},[50,5518,4471],{"class":56},[50,5520,1556],{"class":60},[50,5522,5524,5526,5528,5530,5532,5534,5536,5538],{"class":52,"line":5523},153,[50,5525,5506],{"class":1221},[50,5527,4458],{"class":60},[50,5529,4461],{"class":1362},[50,5531,1366],{"class":60},[50,5533,4466],{"class":1362},[50,5535,4458],{"class":60},[50,5537,4471],{"class":56},[50,5539,1556],{"class":60},[50,5541,5543],{"class":52,"line":5542},154,[50,5544,5545],{"class":60},"        )\n",[50,5547,5549],{"class":52,"line":5548},155,[50,5550,371],{"emptyLinePlaceholder":370},[50,5552,5554],{"class":52,"line":5553},156,[50,5555,371],{"emptyLinePlaceholder":370},[50,5557,5559,5561,5564,5566,5568],{"class":52,"line":5558},157,[50,5560,4439],{"class":1815},[50,5562,5563],{"class":1362}," gen_products",[50,5565,1366],{"class":60},[50,5567,5405],{"class":4493},[50,5569,5164],{"class":60},[50,5571,5573,5575,5577,5579,5581,5583,5585],{"class":52,"line":5572},158,[50,5574,5413],{"class":3328},[50,5576,5416],{"class":1221},[50,5578,5419],{"class":3328},[50,5580,5422],{"class":1362},[50,5582,1366],{"class":60},[50,5584,5405],{"class":1362},[50,5586,5164],{"class":60},[50,5588,5590,5593,5595,5598,5600,5603,5605,5608],{"class":52,"line":5589},159,[50,5591,5592],{"class":1221},"        cat ",[50,5594,1514],{"class":60},[50,5596,5597],{"class":1221}," random",[50,5599,4458],{"class":60},[50,5601,5602],{"class":1362},"choice",[50,5604,1366],{"class":60},[50,5606,5607],{"class":1362},"PRODUCT_CATEGORIES",[50,5609,1349],{"class":60},[50,5611,5613,5615],{"class":52,"line":5612},160,[50,5614,5434],{"class":3328},[50,5616,1228],{"class":60},[50,5618,5620,5623,5625,5628,5631,5633,5636,5639,5642,5644,5647,5650,5652,5654,5656],{"class":52,"line":5619},161,[50,5621,5622],{"class":1815},"            f",[50,5624,3467],{"class":63},[50,5626,5627],{"class":154},"{",[50,5629,5630],{"class":1221},"fake",[50,5632,4458],{"class":60},[50,5634,5635],{"class":1362},"word",[50,5637,5638],{"class":60},"().",[50,5640,5641],{"class":1362},"capitalize",[50,5643,2341],{"class":60},[50,5645,5646],{"class":154},"}",[50,5648,5649],{"class":154}," {",[50,5651,3214],{"class":1221},[50,5653,5646],{"class":154},[50,5655,3467],{"class":63},[50,5657,2259],{"class":60},[50,5659,5661,5664],{"class":52,"line":5660},162,[50,5662,5663],{"class":1221},"            cat",[50,5665,2259],{"class":60},[50,5667,5669,5671,5673,5675,5677,5680,5682,5684,5687,5689,5691,5694],{"class":52,"line":5668},163,[50,5670,5442],{"class":1221},[50,5672,4458],{"class":60},[50,5674,5459],{"class":56},[50,5676,4458],{"class":60},[50,5678,5679],{"class":1362},"bothify",[50,5681,1366],{"class":60},[50,5683,3467],{"class":60},[50,5685,5686],{"class":63},"SKU-####-??",[50,5688,3467],{"class":60},[50,5690,5183],{"class":60},[50,5692,5693],{"class":1362},"upper",[50,5695,5449],{"class":60},[50,5697,5699,5701,5703,5705,5707,5709,5711,5713],{"class":52,"line":5698},164,[50,5700,5506],{"class":1221},[50,5702,4458],{"class":60},[50,5704,4461],{"class":1362},[50,5706,1366],{"class":60},[50,5708,4466],{"class":1362},[50,5710,4458],{"class":60},[50,5712,4471],{"class":56},[50,5714,1556],{"class":60},[50,5716,5718,5720,5722,5724,5726,5728,5730,5732],{"class":52,"line":5717},165,[50,5719,5506],{"class":1221},[50,5721,4458],{"class":60},[50,5723,4461],{"class":1362},[50,5725,1366],{"class":60},[50,5727,4466],{"class":1362},[50,5729,4458],{"class":60},[50,5731,4471],{"class":56},[50,5733,1556],{"class":60},[50,5735,5737],{"class":52,"line":5736},166,[50,5738,5545],{"class":60},[50,5740,5742],{"class":52,"line":5741},167,[50,5743,371],{"emptyLinePlaceholder":370},[50,5745,5747],{"class":52,"line":5746},168,[50,5748,371],{"emptyLinePlaceholder":370},[50,5750,5752,5754,5757,5759,5762,5764,5767],{"class":52,"line":5751},169,[50,5753,4439],{"class":1815},[50,5755,5756],{"class":1362}," gen_variants",[50,5758,1366],{"class":60},[50,5760,5761],{"class":4493},"prod_rows",[50,5763,1542],{"class":60},[50,5765,5766],{"class":4493}," chaos",[50,5768,5164],{"class":60},[50,5770,5772,5774,5777,5779,5782,5784,5787],{"class":52,"line":5771},170,[50,5773,5413],{"class":3328},[50,5775,5776],{"class":1221}," pid",[50,5778,1542],{"class":60},[50,5780,5781],{"class":1221}," cat ",[50,5783,5419],{"class":3328},[50,5785,5786],{"class":1221}," prod_rows",[50,5788,73],{"class":60},[50,5790,5792,5795,5797,5799,5801,5803,5805,5807,5809,5811,5813,5815,5818],{"class":52,"line":5791},171,[50,5793,5794],{"class":3328},"        for",[50,5796,5416],{"class":1221},[50,5798,5419],{"class":3328},[50,5800,5422],{"class":1362},[50,5802,1366],{"class":60},[50,5804,5260],{"class":1362},[50,5806,4458],{"class":60},[50,5808,5265],{"class":1362},[50,5810,1366],{"class":60},[50,5812,4895],{"class":154},[50,5814,1542],{"class":60},[50,5816,5817],{"class":154}," 4",[50,5819,5820],{"class":60},")):\n",[50,5822,5824,5827,5829,5832,5834,5836,5838,5840,5842,5844,5847,5849,5851,5853],{"class":52,"line":5823},172,[50,5825,5826],{"class":1221},"            sku ",[50,5828,1514],{"class":60},[50,5830,5831],{"class":1221}," fake",[50,5833,4458],{"class":60},[50,5835,5459],{"class":56},[50,5837,4458],{"class":60},[50,5839,5679],{"class":1362},[50,5841,1366],{"class":60},[50,5843,3467],{"class":60},[50,5845,5846],{"class":63},"VAR-####-??",[50,5848,3467],{"class":60},[50,5850,5183],{"class":60},[50,5852,5693],{"class":1362},[50,5854,2359],{"class":60},[50,5856,5858,5861,5863,5865,5867,5869,5871,5874],{"class":52,"line":5857},173,[50,5859,5860],{"class":1221},"            color ",[50,5862,1514],{"class":60},[50,5864,5597],{"class":1221},[50,5866,4458],{"class":60},[50,5868,5602],{"class":1362},[50,5870,1366],{"class":60},[50,5872,5873],{"class":1362},"COLORS",[50,5875,1349],{"class":60},[50,5877,5879,5882,5884,5887,5889,5891,5893,5895,5897,5900,5903,5906,5908,5911,5913,5915,5917,5920,5922,5924,5926,5928,5931],{"class":52,"line":5878},174,[50,5880,5881],{"class":1221},"            size ",[50,5883,1514],{"class":60},[50,5885,5886],{"class":2006}," str",[50,5888,1366],{"class":60},[50,5890,5260],{"class":1362},[50,5892,4458],{"class":60},[50,5894,5602],{"class":1362},[50,5896,1366],{"class":60},[50,5898,5899],{"class":1362},"SIZES_SHOES",[50,5901,5902],{"class":60},"))",[50,5904,5905],{"class":3328}," if",[50,5907,5781],{"class":1221},[50,5909,5910],{"class":60},"==",[50,5912,241],{"class":60},[50,5914,3488],{"class":63},[50,5916,3467],{"class":60},[50,5918,5919],{"class":3328}," else",[50,5921,5597],{"class":1221},[50,5923,4458],{"class":60},[50,5925,5602],{"class":1362},[50,5927,1366],{"class":60},[50,5929,5930],{"class":1362},"SIZES_APPAREL",[50,5932,1349],{"class":60},[50,5934,5936],{"class":52,"line":5935},175,[50,5937,371],{"emptyLinePlaceholder":370},[50,5939,5941],{"class":52,"line":5940},176,[50,5942,5943],{"class":950},"            # Chaos mode\n",[50,5945,5947,5950,5953,5956,5958,5961,5963,5965,5967,5969,5972,5974,5977,5979,5982],{"class":52,"line":5946},177,[50,5948,5949],{"class":3328},"            if",[50,5951,5952],{"class":1221}," chaos ",[50,5954,5955],{"class":60},">",[50,5957,1681],{"class":154},[50,5959,5960],{"class":60}," and",[50,5962,5597],{"class":1221},[50,5964,4458],{"class":60},[50,5966,5260],{"class":1362},[50,5968,2341],{"class":60},[50,5970,5971],{"class":60}," \u003C",[50,5973,1531],{"class":60},[50,5975,5976],{"class":1221},"chaos ",[50,5978,1695],{"class":60},[50,5980,5981],{"class":154}," 100",[50,5983,5164],{"class":60},[50,5985,5987,5990,5992,5994,5996,5998,6000],{"class":52,"line":5986},178,[50,5988,5989],{"class":3328},"                if",[50,5991,5781],{"class":1221},[50,5993,5910],{"class":60},[50,5995,241],{"class":60},[50,5997,3488],{"class":63},[50,5999,3467],{"class":60},[50,6001,73],{"class":60},[50,6003,6005,6008,6010,6012,6014,6016,6018,6020],{"class":52,"line":6004},179,[50,6006,6007],{"class":1221},"                    size ",[50,6009,1514],{"class":60},[50,6011,5597],{"class":1221},[50,6013,4458],{"class":60},[50,6015,5602],{"class":1362},[50,6017,1366],{"class":60},[50,6019,5930],{"class":1362},[50,6021,1349],{"class":60},[50,6023,6025,6028],{"class":52,"line":6024},180,[50,6026,6027],{"class":3328},"                else",[50,6029,73],{"class":60},[50,6031,6033,6035,6037,6039,6041,6043,6045,6047,6049,6051],{"class":52,"line":6032},181,[50,6034,6007],{"class":1221},[50,6036,1514],{"class":60},[50,6038,5886],{"class":2006},[50,6040,1366],{"class":60},[50,6042,5260],{"class":1362},[50,6044,4458],{"class":60},[50,6046,5602],{"class":1362},[50,6048,1366],{"class":60},[50,6050,5899],{"class":1362},[50,6052,6053],{"class":60},"))\n",[50,6055,6057],{"class":52,"line":6056},182,[50,6058,371],{"emptyLinePlaceholder":370},[50,6060,6062,6065,6067,6070,6072,6074,6076,6079,6081,6083,6085,6088,6091,6094],{"class":52,"line":6061},183,[50,6063,6064],{"class":1221},"            manuf ",[50,6066,1514],{"class":60},[50,6068,6069],{"class":1362}," round",[50,6071,1366],{"class":60},[50,6073,5260],{"class":1362},[50,6075,4458],{"class":60},[50,6077,6078],{"class":1362},"uniform",[50,6080,1366],{"class":60},[50,6082,2565],{"class":154},[50,6084,1542],{"class":60},[50,6086,6087],{"class":154}," 80",[50,6089,6090],{"class":60},"),",[50,6092,6093],{"class":154}," 2",[50,6095,1349],{"class":60},[50,6097,6099,6102,6104,6106,6108,6111,6113,6115,6117,6119,6121,6124,6126,6129,6131,6133],{"class":52,"line":6098},184,[50,6100,6101],{"class":1221},"            sell ",[50,6103,1514],{"class":60},[50,6105,6069],{"class":1362},[50,6107,1366],{"class":60},[50,6109,6110],{"class":1362},"manuf ",[50,6112,1369],{"class":60},[50,6114,5597],{"class":1362},[50,6116,4458],{"class":60},[50,6118,6078],{"class":1362},[50,6120,1366],{"class":60},[50,6122,6123],{"class":154},"1.2",[50,6125,1542],{"class":60},[50,6127,6128],{"class":154}," 2.0",[50,6130,6090],{"class":60},[50,6132,6093],{"class":154},[50,6134,1349],{"class":60},[50,6136,6138,6141],{"class":52,"line":6137},185,[50,6139,6140],{"class":3328},"            yield",[50,6142,1228],{"class":60},[50,6144,6146,6149,6151,6154,6156,6159,6161,6164,6166,6169,6171,6174],{"class":52,"line":6145},186,[50,6147,6148],{"class":1221},"                pid",[50,6150,1542],{"class":60},[50,6152,6153],{"class":1221}," sku",[50,6155,1542],{"class":60},[50,6157,6158],{"class":1221}," color",[50,6160,1542],{"class":60},[50,6162,6163],{"class":1221}," size",[50,6165,1542],{"class":60},[50,6167,6168],{"class":1221}," manuf",[50,6170,1542],{"class":60},[50,6172,6173],{"class":1221}," sell",[50,6175,2259],{"class":60},[50,6177,6179,6182,6184,6186,6188,6190,6192,6195,6197],{"class":52,"line":6178},187,[50,6180,6181],{"class":1221},"                random",[50,6183,4458],{"class":60},[50,6185,5265],{"class":1362},[50,6187,1366],{"class":60},[50,6189,1879],{"class":154},[50,6191,1542],{"class":60},[50,6193,6194],{"class":154}," 200",[50,6196,6090],{"class":60},[50,6198,6199],{"class":60}," True,\n",[50,6201,6203,6206,6208,6210,6212,6214,6216,6218,6220,6222,6224,6226,6228,6230,6232,6234],{"class":52,"line":6202},188,[50,6204,6205],{"class":1221},"                datetime",[50,6207,4458],{"class":60},[50,6209,4461],{"class":1362},[50,6211,1366],{"class":60},[50,6213,4466],{"class":1362},[50,6215,4458],{"class":60},[50,6217,4471],{"class":56},[50,6219,6090],{"class":60},[50,6221,3382],{"class":1221},[50,6223,4458],{"class":60},[50,6225,4461],{"class":1362},[50,6227,1366],{"class":60},[50,6229,4466],{"class":1362},[50,6231,4458],{"class":60},[50,6233,4471],{"class":56},[50,6235,1556],{"class":60},[50,6237,6239],{"class":52,"line":6238},189,[50,6240,6241],{"class":60},"            )\n",[50,6243,6245],{"class":52,"line":6244},190,[50,6246,371],{"emptyLinePlaceholder":370},[50,6248,6250],{"class":52,"line":6249},191,[50,6251,371],{"emptyLinePlaceholder":370},[50,6253,6255,6257,6260,6262,6265,6267,6270,6272,6274,6276,6278],{"class":52,"line":6254},192,[50,6256,4439],{"class":1815},[50,6258,6259],{"class":1362}," gen_orders",[50,6261,1366],{"class":60},[50,6263,6264],{"class":4493},"cust_ids",[50,6266,1542],{"class":60},[50,6268,6269],{"class":4493}," n",[50,6271,1542],{"class":60},[50,6273,5286],{"class":4493},[50,6275,1542],{"class":60},[50,6277,5224],{"class":4493},[50,6279,5164],{"class":60},[50,6281,6283,6285,6287,6289,6291,6293,6295],{"class":52,"line":6282},193,[50,6284,5413],{"class":3328},[50,6286,5416],{"class":1221},[50,6288,5419],{"class":3328},[50,6290,5422],{"class":1362},[50,6292,1366],{"class":60},[50,6294,5405],{"class":1362},[50,6296,5164],{"class":60},[50,6298,6300,6302,6304,6306,6308,6310,6312,6314,6316,6318,6320,6322,6324,6326,6328,6330,6332,6335,6337,6340,6342,6345,6348,6350,6353,6356],{"class":52,"line":6299},194,[50,6301,5434],{"class":3328},[50,6303,1531],{"class":60},[50,6305,5260],{"class":1221},[50,6307,4458],{"class":60},[50,6309,5602],{"class":1362},[50,6311,1366],{"class":60},[50,6313,6264],{"class":1362},[50,6315,6090],{"class":60},[50,6317,5214],{"class":1362},[50,6319,1366],{"class":60},[50,6321,5219],{"class":1362},[50,6323,1542],{"class":60},[50,6325,5224],{"class":1362},[50,6327,6090],{"class":60},[50,6329,5597],{"class":1221},[50,6331,4458],{"class":60},[50,6333,6334],{"class":1362},"choices",[50,6336,1366],{"class":60},[50,6338,6339],{"class":1362},"ORDER_STATUSES",[50,6341,1542],{"class":60},[50,6343,6344],{"class":1362}," ORDER_STATUS_WEIGHTS",[50,6346,6347],{"class":60},")[",[50,6349,1879],{"class":154},[50,6351,6352],{"class":60},"],",[50,6354,6355],{"class":154}," 0.0",[50,6357,2259],{"class":60},[50,6359,6361,6364,6366,6368,6370,6372,6374,6376,6378,6380,6382,6384,6386,6388,6390,6392],{"class":52,"line":6360},195,[50,6362,6363],{"class":1221},"               datetime",[50,6365,4458],{"class":60},[50,6367,4461],{"class":1362},[50,6369,1366],{"class":60},[50,6371,4466],{"class":1362},[50,6373,4458],{"class":60},[50,6375,4471],{"class":56},[50,6377,6090],{"class":60},[50,6379,3382],{"class":1221},[50,6381,4458],{"class":60},[50,6383,4461],{"class":1362},[50,6385,1366],{"class":60},[50,6387,4466],{"class":1362},[50,6389,4458],{"class":60},[50,6391,4471],{"class":56},[50,6393,6394],{"class":60},"),)\n",[50,6396,6398],{"class":52,"line":6397},196,[50,6399,371],{"emptyLinePlaceholder":370},[50,6401,6403],{"class":52,"line":6402},197,[50,6404,371],{"emptyLinePlaceholder":370},[50,6406,6408,6410,6413,6415,6418,6420,6423,6425,6428],{"class":52,"line":6407},198,[50,6409,4439],{"class":1815},[50,6411,6412],{"class":1362}," gen_items",[50,6414,1366],{"class":60},[50,6416,6417],{"class":4493},"order_ids",[50,6419,1542],{"class":60},[50,6421,6422],{"class":4493}," variant_ids",[50,6424,1542],{"class":60},[50,6426,6427],{"class":4493}," max_items",[50,6429,5164],{"class":60},[50,6431,6433,6435,6438,6440,6443],{"class":52,"line":6432},199,[50,6434,5413],{"class":3328},[50,6436,6437],{"class":1221}," oid ",[50,6439,5419],{"class":3328},[50,6441,6442],{"class":1221}," order_ids",[50,6444,73],{"class":60},[50,6446,6448,6450,6453,6455,6457,6459,6462,6464,6467,6469,6471,6473,6475,6477,6479,6481,6484,6486,6488,6490,6492],{"class":52,"line":6447},200,[50,6449,5794],{"class":3328},[50,6451,6452],{"class":1221}," vid ",[50,6454,5419],{"class":3328},[50,6456,5597],{"class":1221},[50,6458,4458],{"class":60},[50,6460,6461],{"class":1362},"sample",[50,6463,1366],{"class":60},[50,6465,6466],{"class":1362},"variant_ids",[50,6468,1542],{"class":60},[50,6470,5597],{"class":1362},[50,6472,4458],{"class":60},[50,6474,5265],{"class":1362},[50,6476,1366],{"class":60},[50,6478,4895],{"class":154},[50,6480,1542],{"class":60},[50,6482,6483],{"class":1362}," max",[50,6485,1366],{"class":60},[50,6487,4895],{"class":154},[50,6489,1542],{"class":60},[50,6491,6427],{"class":1362},[50,6493,6494],{"class":60},"))):\n",[50,6496,6498,6500,6502,6505,6507,6510,6512,6514,6516,6518,6520,6522,6524,6527,6529,6531,6533,6535,6537,6539,6541,6544,6546,6548,6550,6552,6554,6556,6558,6560,6562,6564,6566,6568],{"class":52,"line":6497},201,[50,6499,6140],{"class":3328},[50,6501,1531],{"class":60},[50,6503,6504],{"class":1221},"oid",[50,6506,1542],{"class":60},[50,6508,6509],{"class":1221}," vid",[50,6511,1542],{"class":60},[50,6513,5597],{"class":1221},[50,6515,4458],{"class":60},[50,6517,5265],{"class":1362},[50,6519,1366],{"class":60},[50,6521,4895],{"class":154},[50,6523,1542],{"class":60},[50,6525,6526],{"class":154}," 3",[50,6528,6090],{"class":60},[50,6530,6069],{"class":1362},[50,6532,1366],{"class":60},[50,6534,5260],{"class":1362},[50,6536,4458],{"class":60},[50,6538,6078],{"class":1362},[50,6540,1366],{"class":60},[50,6542,6543],{"class":154},"20",[50,6545,1542],{"class":60},[50,6547,6194],{"class":154},[50,6549,6090],{"class":60},[50,6551,6093],{"class":154},[50,6553,6090],{"class":60},[50,6555,3382],{"class":1221},[50,6557,4458],{"class":60},[50,6559,4461],{"class":1362},[50,6561,1366],{"class":60},[50,6563,4466],{"class":1362},[50,6565,4458],{"class":60},[50,6567,4471],{"class":56},[50,6569,6053],{"class":60},[50,6571,6573],{"class":52,"line":6572},202,[50,6574,371],{"emptyLinePlaceholder":370},[50,6576,6578],{"class":52,"line":6577},203,[50,6579,371],{"emptyLinePlaceholder":370},[50,6581,6583,6585,6588,6590,6592,6594,6597,6599,6602,6604,6607,6609,6612,6614,6617,6619,6622,6624,6626,6628,6631],{"class":52,"line":6582},204,[50,6584,4439],{"class":1815},[50,6586,6587],{"class":1362}," print_box_summary",[50,6589,1366],{"class":60},[50,6591,3579],{"class":4493},[50,6593,1542],{"class":60},[50,6595,6596],{"class":4493}," E",[50,6598,1542],{"class":60},[50,6600,6601],{"class":4493}," c_cnt",[50,6603,1542],{"class":60},[50,6605,6606],{"class":4493}," p_cnt",[50,6608,1542],{"class":60},[50,6610,6611],{"class":4493}," v_cnt",[50,6613,1542],{"class":60},[50,6615,6616],{"class":4493}," o_cnt",[50,6618,1542],{"class":60},[50,6620,6621],{"class":4493}," i_cnt",[50,6623,1542],{"class":60},[50,6625,6427],{"class":4493},[50,6627,1542],{"class":60},[50,6629,6630],{"class":4493}," bad_by_cat",[50,6632,5164],{"class":60},[50,6634,6636,6639,6641,6643,6646,6649,6651],{"class":52,"line":6635},205,[50,6637,6638],{"class":1362},"    print",[50,6640,1366],{"class":60},[50,6642,3467],{"class":60},[50,6644,6645],{"class":1221},"\\n",[50,6647,6648],{"class":63},"✅ Data generation complete (idempotent window load)",[50,6650,3467],{"class":60},[50,6652,1349],{"class":60},[50,6654,6656,6658,6660,6663,6666,6668,6670,6672,6674,6676,6678,6681,6683,6686,6688,6690,6692,6694,6696],{"class":52,"line":6655},206,[50,6657,6638],{"class":1362},[50,6659,1366],{"class":60},[50,6661,6662],{"class":1815},"f",[50,6664,6665],{"class":63},"\"Window: ",[50,6667,5627],{"class":154},[50,6669,3579],{"class":1362},[50,6671,4458],{"class":60},[50,6673,5098],{"class":1362},[50,6675,2341],{"class":60},[50,6677,5646],{"class":154},[50,6679,6680],{"class":63}," → ",[50,6682,5627],{"class":154},[50,6684,6685],{"class":1362},"E",[50,6687,4458],{"class":60},[50,6689,5098],{"class":1362},[50,6691,2341],{"class":60},[50,6693,5646],{"class":154},[50,6695,3467],{"class":63},[50,6697,1349],{"class":60},[50,6699,6701,6703,6705,6707,6710,6712,6715,6718,6720,6723,6725,6728,6730,6732,6735,6737,6740,6742,6744,6746],{"class":52,"line":6700},207,[50,6702,6638],{"class":1362},[50,6704,1366],{"class":60},[50,6706,6662],{"class":1815},[50,6708,6709],{"class":63},"\"Counts — Customers: ",[50,6711,5627],{"class":154},[50,6713,6714],{"class":1362},"c_cnt",[50,6716,6717],{"class":1815},":,",[50,6719,5646],{"class":154},[50,6721,6722],{"class":63}," | Products: ",[50,6724,5627],{"class":154},[50,6726,6727],{"class":1362},"p_cnt",[50,6729,6717],{"class":1815},[50,6731,5646],{"class":154},[50,6733,6734],{"class":63}," | Variants: ",[50,6736,5627],{"class":154},[50,6738,6739],{"class":1362},"v_cnt",[50,6741,6717],{"class":1815},[50,6743,5646],{"class":154},[50,6745,3467],{"class":63},[50,6747,1349],{"class":60},[50,6749,6751,6753,6755,6757,6760,6762,6765,6767,6769,6772,6774,6777,6779,6781,6784,6786,6789,6791,6793],{"class":52,"line":6750},208,[50,6752,6638],{"class":1362},[50,6754,1366],{"class":60},[50,6756,6662],{"class":1815},[50,6758,6759],{"class":63},"\"Window Facts — Orders: ",[50,6761,5627],{"class":154},[50,6763,6764],{"class":1362},"o_cnt",[50,6766,6717],{"class":1815},[50,6768,5646],{"class":154},[50,6770,6771],{"class":63}," | Items: ",[50,6773,5627],{"class":154},[50,6775,6776],{"class":1362},"i_cnt",[50,6778,6717],{"class":1815},[50,6780,5646],{"class":154},[50,6782,6783],{"class":63}," | MaxItems/Order: ",[50,6785,5627],{"class":154},[50,6787,6788],{"class":1362},"max_items",[50,6790,5646],{"class":154},[50,6792,3467],{"class":63},[50,6794,1349],{"class":60},[50,6796,6798,6800,6802,6804,6807,6809],{"class":52,"line":6797},209,[50,6799,6638],{"class":1362},[50,6801,1366],{"class":60},[50,6803,3467],{"class":60},[50,6805,6806],{"class":63},"Chaos check (invalid sizes per category):",[50,6808,3467],{"class":60},[50,6810,1349],{"class":60},[50,6812,6814,6816,6819,6821,6824,6826,6828],{"class":52,"line":6813},210,[50,6815,5413],{"class":3328},[50,6817,6818],{"class":1221}," cat",[50,6820,1542],{"class":60},[50,6822,6823],{"class":1221}," bad ",[50,6825,5419],{"class":3328},[50,6827,6630],{"class":1221},[50,6829,73],{"class":60},[50,6831,6833,6836,6838,6840,6843,6845,6847,6849,6852,6854,6857,6859,6861,6864],{"class":52,"line":6832},211,[50,6834,6835],{"class":1362},"        print",[50,6837,1366],{"class":60},[50,6839,6662],{"class":1815},[50,6841,6842],{"class":63},"\"  • ",[50,6844,5627],{"class":154},[50,6846,3214],{"class":1362},[50,6848,5646],{"class":154},[50,6850,6851],{"class":63},": ",[50,6853,5627],{"class":154},[50,6855,6856],{"class":1362},"bad",[50,6858,6717],{"class":1815},[50,6860,5646],{"class":154},[50,6862,6863],{"class":63}," invalid\"",[50,6865,1349],{"class":60},[50,6867,6869],{"class":52,"line":6868},212,[50,6870,371],{"emptyLinePlaceholder":370},[50,6872,6874],{"class":52,"line":6873},213,[50,6875,371],{"emptyLinePlaceholder":370},[50,6877,6879,6881,6884],{"class":52,"line":6878},214,[50,6880,4439],{"class":1815},[50,6882,6883],{"class":1362}," main",[50,6885,4445],{"class":60},[50,6887,6889,6892,6894,6896],{"class":52,"line":6888},215,[50,6890,6891],{"class":1221},"    args ",[50,6893,1514],{"class":60},[50,6895,4442],{"class":1362},[50,6897,2359],{"class":60},[50,6899,6901,6904,6906,6909,6911,6914,6916,6918],{"class":52,"line":6900},216,[50,6902,6903],{"class":1221},"    random",[50,6905,4458],{"class":60},[50,6907,6908],{"class":1362},"seed",[50,6910,1366],{"class":60},[50,6912,6913],{"class":1362},"args",[50,6915,4458],{"class":60},[50,6917,6908],{"class":56},[50,6919,1349],{"class":60},[50,6921,6923,6926,6928,6930,6932,6934,6936,6938],{"class":52,"line":6922},217,[50,6924,6925],{"class":1221},"    Faker",[50,6927,4458],{"class":60},[50,6929,6908],{"class":1362},[50,6931,1366],{"class":60},[50,6933,6913],{"class":1362},[50,6935,4458],{"class":60},[50,6937,6908],{"class":56},[50,6939,1349],{"class":60},[50,6941,6943,6946,6948,6951,6953,6955,6957,6959,6961,6963,6965,6967,6969,6971,6973,6975],{"class":52,"line":6942},218,[50,6944,6945],{"class":1221},"    S",[50,6947,1542],{"class":60},[50,6949,6950],{"class":1221}," E ",[50,6952,1514],{"class":60},[50,6954,5156],{"class":1362},[50,6956,1366],{"class":60},[50,6958,6913],{"class":1362},[50,6960,4458],{"class":60},[50,6962,5077],{"class":56},[50,6964,6090],{"class":60},[50,6966,5156],{"class":1362},[50,6968,1366],{"class":60},[50,6970,6913],{"class":1362},[50,6972,4458],{"class":60},[50,6974,5110],{"class":56},[50,6976,1349],{"class":60},[50,6978,6980],{"class":52,"line":6979},219,[50,6981,371],{"emptyLinePlaceholder":370},[50,6983,6985,6987,6989,6991,6993,6996,6998],{"class":52,"line":6984},220,[50,6986,6638],{"class":1362},[50,6988,1366],{"class":60},[50,6990,3467],{"class":60},[50,6992,6645],{"class":1221},[50,6994,6995],{"class":63},"=== Generating E-commerce Demo Data ===",[50,6997,3467],{"class":60},[50,6999,1349],{"class":60},[50,7001,7003,7005,7007,7009,7011,7013,7015,7017,7019,7021,7023,7025,7027,7029,7031,7033,7035,7037,7039],{"class":52,"line":7002},221,[50,7004,6638],{"class":1362},[50,7006,1366],{"class":60},[50,7008,6662],{"class":1815},[50,7010,6665],{"class":63},[50,7012,5627],{"class":154},[50,7014,3579],{"class":1362},[50,7016,4458],{"class":60},[50,7018,5098],{"class":1362},[50,7020,2341],{"class":60},[50,7022,5646],{"class":154},[50,7024,6680],{"class":63},[50,7026,5627],{"class":154},[50,7028,6685],{"class":1362},[50,7030,4458],{"class":60},[50,7032,5098],{"class":1362},[50,7034,2341],{"class":60},[50,7036,5646],{"class":154},[50,7038,3467],{"class":63},[50,7040,1349],{"class":60},[50,7042,7044,7046,7048,7050,7053,7055,7057,7059,7062,7064,7067,7069,7071,7073,7075,7077,7080,7082,7084,7086,7089,7092,7094,7097,7099,7101],{"class":52,"line":7043},222,[50,7045,6638],{"class":1362},[50,7047,1366],{"class":60},[50,7049,6662],{"class":1815},[50,7051,7052],{"class":63},"\"Scale x",[50,7054,5627],{"class":154},[50,7056,6913],{"class":1362},[50,7058,4458],{"class":60},[50,7060,7061],{"class":56},"scale",[50,7063,5646],{"class":154},[50,7065,7066],{"class":63}," | Seed ",[50,7068,5627],{"class":154},[50,7070,6913],{"class":1362},[50,7072,4458],{"class":60},[50,7074,6908],{"class":56},[50,7076,5646],{"class":154},[50,7078,7079],{"class":63}," | Chaos ",[50,7081,5627],{"class":154},[50,7083,6913],{"class":1362},[50,7085,4458],{"class":60},[50,7087,7088],{"class":56},"chaos_percent",[50,7090,7091],{"class":1815},":.1f",[50,7093,5646],{"class":154},[50,7095,7096],{"class":63},"%",[50,7098,6645],{"class":1221},[50,7100,3467],{"class":63},[50,7102,1349],{"class":60},[50,7104,7106],{"class":52,"line":7105},223,[50,7107,371],{"emptyLinePlaceholder":370},[50,7109,7111,7114,7116,7119,7121,7124,7126,7129,7131,7133,7135,7137,7139,7141,7143,7145,7147],{"class":52,"line":7110},224,[50,7112,7113],{"class":1221},"    base_c",[50,7115,1542],{"class":60},[50,7117,7118],{"class":1221}," base_p",[50,7120,1542],{"class":60},[50,7122,7123],{"class":1221}," base_o ",[50,7125,1514],{"class":60},[50,7127,7128],{"class":1221}," args",[50,7130,4458],{"class":60},[50,7132,4199],{"class":56},[50,7134,1542],{"class":60},[50,7136,7128],{"class":1221},[50,7138,4458],{"class":60},[50,7140,4220],{"class":56},[50,7142,1542],{"class":60},[50,7144,7128],{"class":1221},[50,7146,4458],{"class":60},[50,7148,7149],{"class":56},"orders\n",[50,7151,7153,7156,7158,7161,7163,7166,7168,7171,7173,7175,7177,7179,7181,7184,7186,7188,7190,7192,7194,7196,7198,7200,7202],{"class":52,"line":7152},225,[50,7154,7155],{"class":1221},"    n_c",[50,7157,1542],{"class":60},[50,7159,7160],{"class":1221}," n_p",[50,7162,1542],{"class":60},[50,7164,7165],{"class":1221}," n_o ",[50,7167,1514],{"class":60},[50,7169,7170],{"class":1221}," base_c ",[50,7172,1369],{"class":60},[50,7174,7128],{"class":1221},[50,7176,4458],{"class":60},[50,7178,7061],{"class":56},[50,7180,1542],{"class":60},[50,7182,7183],{"class":1221}," base_p ",[50,7185,1369],{"class":60},[50,7187,7128],{"class":1221},[50,7189,4458],{"class":60},[50,7191,7061],{"class":56},[50,7193,1542],{"class":60},[50,7195,7123],{"class":1221},[50,7197,1369],{"class":60},[50,7199,7128],{"class":1221},[50,7201,4458],{"class":60},[50,7203,7204],{"class":56},"scale\n",[50,7206,7208],{"class":52,"line":7207},226,[50,7209,371],{"emptyLinePlaceholder":370},[50,7211,7213,7215,7218,7220,7223,7225,7227,7229,7232,7235,7237,7239],{"class":52,"line":7212},227,[50,7214,5335],{"class":3328},[50,7216,7217],{"class":1221}," psycopg",[50,7219,4458],{"class":60},[50,7221,7222],{"class":1362},"connect",[50,7224,1366],{"class":60},[50,7226,6913],{"class":1362},[50,7228,4458],{"class":60},[50,7230,7231],{"class":56},"dsn",[50,7233,7234],{"class":60},")",[50,7236,5348],{"class":3328},[50,7238,5338],{"class":1221},[50,7240,73],{"class":60},[50,7242,7244,7247,7249,7251,7253,7256,7258,7260,7262,7265],{"class":52,"line":7243},228,[50,7245,7246],{"class":1362},"        execmany",[50,7248,1366],{"class":60},[50,7250,5317],{"class":1362},[50,7252,1542],{"class":60},[50,7254,7255],{"class":1362}," SQL_INSERT_CUSTOMERS",[50,7257,1542],{"class":60},[50,7259,5400],{"class":1362},[50,7261,1366],{"class":60},[50,7263,7264],{"class":1362},"n_c",[50,7266,6053],{"class":60},[50,7268,7270,7272,7274,7276,7278,7281,7283,7285,7287,7290],{"class":52,"line":7269},229,[50,7271,7246],{"class":1362},[50,7273,1366],{"class":60},[50,7275,5317],{"class":1362},[50,7277,1542],{"class":60},[50,7279,7280],{"class":1362}," SQL_INSERT_PRODUCTS",[50,7282,1542],{"class":60},[50,7284,5563],{"class":1362},[50,7286,1366],{"class":60},[50,7288,7289],{"class":1362},"n_p",[50,7291,6053],{"class":60},[50,7293,7295],{"class":52,"line":7294},230,[50,7296,371],{"emptyLinePlaceholder":370},[50,7298,7300,7303,7305,7308,7310,7312,7314,7317,7319,7321,7324,7326],{"class":52,"line":7299},231,[50,7301,7302],{"class":1221},"        prod_rows ",[50,7304,1514],{"class":60},[50,7306,7307],{"class":2006}," list",[50,7309,1366],{"class":60},[50,7311,5317],{"class":1362},[50,7313,4458],{"class":60},[50,7315,7316],{"class":1362},"execute",[50,7318,1366],{"class":60},[50,7320,3467],{"class":60},[50,7322,7323],{"class":63},"SELECT id, category FROM products",[50,7325,3467],{"class":60},[50,7327,6053],{"class":60},[50,7329,7331,7333,7335,7337,7339,7342,7344,7346,7348,7350,7352,7354,7356,7358],{"class":52,"line":7330},232,[50,7332,7246],{"class":1362},[50,7334,1366],{"class":60},[50,7336,5317],{"class":1362},[50,7338,1542],{"class":60},[50,7340,7341],{"class":1362}," SQL_INSERT_VARIANTS",[50,7343,1542],{"class":60},[50,7345,5756],{"class":1362},[50,7347,1366],{"class":60},[50,7349,5761],{"class":1362},[50,7351,1542],{"class":60},[50,7353,7128],{"class":1362},[50,7355,4458],{"class":60},[50,7357,7088],{"class":56},[50,7359,6053],{"class":60},[50,7361,7363],{"class":52,"line":7362},233,[50,7364,371],{"emptyLinePlaceholder":370},[50,7366,7368,7371,7373,7375,7377,7379,7381,7383],{"class":52,"line":7367},234,[50,7369,7370],{"class":3328},"        with",[50,7372,5338],{"class":1221},[50,7374,4458],{"class":60},[50,7376,5343],{"class":1362},[50,7378,2341],{"class":60},[50,7380,5348],{"class":3328},[50,7382,5351],{"class":1221},[50,7384,73],{"class":60},[50,7386,7388,7391,7393,7395,7397,7400,7402,7404,7406,7408,7410],{"class":52,"line":7387},235,[50,7389,7390],{"class":1221},"            cur",[50,7392,4458],{"class":60},[50,7394,7316],{"class":1362},[50,7396,1366],{"class":60},[50,7398,7399],{"class":1362},"SQL_DELETE_ORDERS_IN_WINDOW",[50,7401,1542],{"class":60},[50,7403,1531],{"class":60},[50,7405,3579],{"class":1362},[50,7407,1542],{"class":60},[50,7409,6596],{"class":1362},[50,7411,6053],{"class":60},[50,7413,7415,7418,7420,7422],{"class":52,"line":7414},236,[50,7416,7417],{"class":1221},"        conn",[50,7419,4458],{"class":60},[50,7421,5385],{"class":1362},[50,7423,2359],{"class":60},[50,7425,7427],{"class":52,"line":7426},237,[50,7428,371],{"emptyLinePlaceholder":370},[50,7430,7432,7435,7437,7439,7442,7445,7447,7450,7453,7456,7458,7460,7462,7464,7466,7468,7471,7473],{"class":52,"line":7431},238,[50,7433,7434],{"class":1221},"        cust_ids ",[50,7436,1514],{"class":60},[50,7438,3464],{"class":60},[50,7440,7441],{"class":1221},"r",[50,7443,7444],{"class":60},"[",[50,7446,1879],{"class":154},[50,7448,7449],{"class":60},"]",[50,7451,7452],{"class":3328}," for",[50,7454,7455],{"class":1221}," r ",[50,7457,5419],{"class":3328},[50,7459,5338],{"class":1221},[50,7461,4458],{"class":60},[50,7463,7316],{"class":1362},[50,7465,1366],{"class":60},[50,7467,3467],{"class":60},[50,7469,7470],{"class":63},"SELECT id FROM customers",[50,7472,3467],{"class":60},[50,7474,7475],{"class":60},")]\n",[50,7477,7479,7481,7483,7485,7487,7490,7492,7494,7496,7498,7500,7503,7505,7508,7510,7512],{"class":52,"line":7478},239,[50,7480,7246],{"class":1362},[50,7482,1366],{"class":60},[50,7484,5317],{"class":1362},[50,7486,1542],{"class":60},[50,7488,7489],{"class":1362}," SQL_INSERT_ORDERS",[50,7491,1542],{"class":60},[50,7493,6259],{"class":1362},[50,7495,1366],{"class":60},[50,7497,6264],{"class":1362},[50,7499,1542],{"class":60},[50,7501,7502],{"class":1362}," n_o",[50,7504,1542],{"class":60},[50,7506,7507],{"class":1362}," S",[50,7509,1542],{"class":60},[50,7511,6596],{"class":1362},[50,7513,6053],{"class":60},[50,7515,7517],{"class":52,"line":7516},240,[50,7518,371],{"emptyLinePlaceholder":370},[50,7520,7522,7525,7527,7529,7531,7533,7535,7537,7539,7541,7543,7545,7547,7549,7551,7553,7556,7558,7560,7562,7564,7566,7568,7570,7572,7574],{"class":52,"line":7521},241,[50,7523,7524],{"class":1221},"        order_ids ",[50,7526,1514],{"class":60},[50,7528,3464],{"class":60},[50,7530,7441],{"class":1221},[50,7532,7444],{"class":60},[50,7534,1879],{"class":154},[50,7536,7449],{"class":60},[50,7538,7452],{"class":3328},[50,7540,7455],{"class":1221},[50,7542,5419],{"class":3328},[50,7544,5338],{"class":1221},[50,7546,4458],{"class":60},[50,7548,7316],{"class":1362},[50,7550,1366],{"class":60},[50,7552,3467],{"class":60},[50,7554,7555],{"class":63},"SELECT id FROM orders WHERE order_date BETWEEN ",[50,7557,3748],{"class":154},[50,7559,3988],{"class":63},[50,7561,3748],{"class":154},[50,7563,3467],{"class":60},[50,7565,1542],{"class":60},[50,7567,1531],{"class":60},[50,7569,3579],{"class":1362},[50,7571,1542],{"class":60},[50,7573,6596],{"class":1362},[50,7575,7576],{"class":60},"))]\n",[50,7578,7580,7583,7585,7587,7589,7591,7593,7595,7597,7599,7601,7603,7605,7607,7609,7611,7614,7616],{"class":52,"line":7579},242,[50,7581,7582],{"class":1221},"        variant_ids ",[50,7584,1514],{"class":60},[50,7586,3464],{"class":60},[50,7588,7441],{"class":1221},[50,7590,7444],{"class":60},[50,7592,1879],{"class":154},[50,7594,7449],{"class":60},[50,7596,7452],{"class":3328},[50,7598,7455],{"class":1221},[50,7600,5419],{"class":3328},[50,7602,5338],{"class":1221},[50,7604,4458],{"class":60},[50,7606,7316],{"class":1362},[50,7608,1366],{"class":60},[50,7610,3467],{"class":60},[50,7612,7613],{"class":63},"SELECT id FROM product_variants",[50,7615,3467],{"class":60},[50,7617,7475],{"class":60},[50,7619,7621,7623,7625,7627,7629,7632,7634,7636,7638,7640,7642,7644,7646,7648,7650,7653],{"class":52,"line":7620},243,[50,7622,7246],{"class":1362},[50,7624,1366],{"class":60},[50,7626,5317],{"class":1362},[50,7628,1542],{"class":60},[50,7630,7631],{"class":1362}," SQL_INSERT_ORDER_ITEMS",[50,7633,1542],{"class":60},[50,7635,6412],{"class":1362},[50,7637,1366],{"class":60},[50,7639,6417],{"class":1362},[50,7641,1542],{"class":60},[50,7643,6422],{"class":1362},[50,7645,1542],{"class":60},[50,7647,7128],{"class":1362},[50,7649,4458],{"class":60},[50,7651,7652],{"class":56},"max_items_per_order",[50,7654,6053],{"class":60},[50,7656,7658],{"class":52,"line":7657},244,[50,7659,371],{"emptyLinePlaceholder":370},[50,7661,7663,7665,7667,7669,7671,7673,7675,7677],{"class":52,"line":7662},245,[50,7664,7370],{"class":3328},[50,7666,5338],{"class":1221},[50,7668,4458],{"class":60},[50,7670,5343],{"class":1362},[50,7672,2341],{"class":60},[50,7674,5348],{"class":3328},[50,7676,5351],{"class":1221},[50,7678,73],{"class":60},[50,7680,7682,7684,7686,7688,7690,7693,7695,7697,7699,7701,7703],{"class":52,"line":7681},246,[50,7683,7390],{"class":1221},[50,7685,4458],{"class":60},[50,7687,7316],{"class":1362},[50,7689,1366],{"class":60},[50,7691,7692],{"class":1362},"SQL_UPDATE_ORDER_TOTALS",[50,7694,1542],{"class":60},[50,7696,1531],{"class":60},[50,7698,3579],{"class":1362},[50,7700,1542],{"class":60},[50,7702,6596],{"class":1362},[50,7704,6053],{"class":60},[50,7706,7708,7710,7712,7714],{"class":52,"line":7707},247,[50,7709,7417],{"class":1221},[50,7711,4458],{"class":60},[50,7713,5385],{"class":1362},[50,7715,2359],{"class":60},[50,7717,7719],{"class":52,"line":7718},248,[50,7720,371],{"emptyLinePlaceholder":370},[50,7722,7724,7726,7728,7730,7732,7734,7736,7738],{"class":52,"line":7723},249,[50,7725,7370],{"class":3328},[50,7727,5338],{"class":1221},[50,7729,4458],{"class":60},[50,7731,5343],{"class":1362},[50,7733,2341],{"class":60},[50,7735,5348],{"class":3328},[50,7737,5351],{"class":1221},[50,7739,73],{"class":60},[50,7741,7743,7745,7747,7749,7751,7754,7756,7758,7760,7762,7765],{"class":52,"line":7742},250,[50,7744,7390],{"class":1221},[50,7746,4458],{"class":60},[50,7748,7316],{"class":1362},[50,7750,1366],{"class":60},[50,7752,7753],{"class":1362},"SQL_STATS_COUNTS",[50,7755,7444],{"class":60},[50,7757,3467],{"class":60},[50,7759,4199],{"class":63},[50,7761,3467],{"class":60},[50,7763,7764],{"class":60},"])",[50,7766,1406],{"class":1221},[50,7768,7770,7773,7775,7777,7779,7782,7785,7787],{"class":52,"line":7769},251,[50,7771,7772],{"class":1221},"            c_cnt ",[50,7774,1514],{"class":60},[50,7776,5351],{"class":1221},[50,7778,4458],{"class":60},[50,7780,7781],{"class":1362},"fetchone",[50,7783,7784],{"class":60},"()[",[50,7786,1879],{"class":154},[50,7788,3511],{"class":60},[50,7790,7792,7794,7796,7798,7800,7802,7804,7806,7808,7810,7812],{"class":52,"line":7791},252,[50,7793,7390],{"class":1221},[50,7795,4458],{"class":60},[50,7797,7316],{"class":1362},[50,7799,1366],{"class":60},[50,7801,7753],{"class":1362},[50,7803,7444],{"class":60},[50,7805,3467],{"class":60},[50,7807,4220],{"class":63},[50,7809,3467],{"class":60},[50,7811,7764],{"class":60},[50,7813,1406],{"class":1221},[50,7815,7817,7820,7822,7824,7826,7828,7830,7832],{"class":52,"line":7816},253,[50,7818,7819],{"class":1221},"            p_cnt ",[50,7821,1514],{"class":60},[50,7823,5351],{"class":1221},[50,7825,4458],{"class":60},[50,7827,7781],{"class":1362},[50,7829,7784],{"class":60},[50,7831,1879],{"class":154},[50,7833,3511],{"class":60},[50,7835,7837,7839,7841,7843,7845,7847,7849,7851,7853,7855,7857],{"class":52,"line":7836},254,[50,7838,7390],{"class":1221},[50,7840,4458],{"class":60},[50,7842,7316],{"class":1362},[50,7844,1366],{"class":60},[50,7846,7753],{"class":1362},[50,7848,7444],{"class":60},[50,7850,3467],{"class":60},[50,7852,4241],{"class":63},[50,7854,3467],{"class":60},[50,7856,7764],{"class":60},[50,7858,1406],{"class":1221},[50,7860,7862,7865,7867,7869,7871,7873,7875,7877],{"class":52,"line":7861},255,[50,7863,7864],{"class":1221},"            v_cnt ",[50,7866,1514],{"class":60},[50,7868,5351],{"class":1221},[50,7870,4458],{"class":60},[50,7872,7781],{"class":1362},[50,7874,7784],{"class":60},[50,7876,1879],{"class":154},[50,7878,3511],{"class":60},[50,7880,7882,7884,7886,7888,7890,7892,7894,7896,7898,7900,7902,7904,7906,7908,7910,7912],{"class":52,"line":7881},256,[50,7883,7390],{"class":1221},[50,7885,4458],{"class":60},[50,7887,7316],{"class":1362},[50,7889,1366],{"class":60},[50,7891,7753],{"class":1362},[50,7893,7444],{"class":60},[50,7895,3467],{"class":60},[50,7897,4262],{"class":63},[50,7899,3467],{"class":60},[50,7901,6352],{"class":60},[50,7903,1531],{"class":60},[50,7905,3579],{"class":1362},[50,7907,1542],{"class":60},[50,7909,6596],{"class":1362},[50,7911,5902],{"class":60},[50,7913,1406],{"class":1221},[50,7915,7917,7920,7922,7924,7926,7928,7930,7932],{"class":52,"line":7916},257,[50,7918,7919],{"class":1221},"            o_cnt ",[50,7921,1514],{"class":60},[50,7923,5351],{"class":1221},[50,7925,4458],{"class":60},[50,7927,7781],{"class":1362},[50,7929,7784],{"class":60},[50,7931,1879],{"class":154},[50,7933,3511],{"class":60},[50,7935,7937,7939,7941,7943,7945,7947,7949,7951,7953,7955,7957,7959,7961,7963,7965,7967],{"class":52,"line":7936},258,[50,7938,7390],{"class":1221},[50,7940,4458],{"class":60},[50,7942,7316],{"class":1362},[50,7944,1366],{"class":60},[50,7946,7753],{"class":1362},[50,7948,7444],{"class":60},[50,7950,3467],{"class":60},[50,7952,4289],{"class":63},[50,7954,3467],{"class":60},[50,7956,6352],{"class":60},[50,7958,1531],{"class":60},[50,7960,3579],{"class":1362},[50,7962,1542],{"class":60},[50,7964,6596],{"class":1362},[50,7966,5902],{"class":60},[50,7968,1406],{"class":1221},[50,7970,7972,7975,7977,7979,7981,7983,7985,7987],{"class":52,"line":7971},259,[50,7973,7974],{"class":1221},"            i_cnt ",[50,7976,1514],{"class":60},[50,7978,5351],{"class":1221},[50,7980,4458],{"class":60},[50,7982,7781],{"class":1362},[50,7984,7784],{"class":60},[50,7986,1879],{"class":154},[50,7988,3511],{"class":60},[50,7990,7992,7994,7996,7998,8000,8003,8005],{"class":52,"line":7991},260,[50,7993,7390],{"class":1221},[50,7995,4458],{"class":60},[50,7997,7316],{"class":1362},[50,7999,1366],{"class":60},[50,8001,8002],{"class":1362},"SQL_CHAOS_VALIDATION",[50,8004,7234],{"class":60},[50,8006,1406],{"class":1221},[50,8008,8010,8013,8015,8017,8019,8022],{"class":52,"line":8009},261,[50,8011,8012],{"class":1221},"            bad_by_cat ",[50,8014,1514],{"class":60},[50,8016,5351],{"class":1221},[50,8018,4458],{"class":60},[50,8020,8021],{"class":1362},"fetchall",[50,8023,2359],{"class":60},[50,8025,8027],{"class":52,"line":8026},262,[50,8028,371],{"emptyLinePlaceholder":370},[50,8030,8032,8035,8037,8039,8041,8043,8045,8047,8049,8051,8053,8055,8057,8059,8061,8063,8065,8067,8069,8071,8073,8075],{"class":52,"line":8031},263,[50,8033,8034],{"class":1362},"    print_box_summary",[50,8036,1366],{"class":60},[50,8038,3579],{"class":1362},[50,8040,1542],{"class":60},[50,8042,6596],{"class":1362},[50,8044,1542],{"class":60},[50,8046,6601],{"class":1362},[50,8048,1542],{"class":60},[50,8050,6606],{"class":1362},[50,8052,1542],{"class":60},[50,8054,6611],{"class":1362},[50,8056,1542],{"class":60},[50,8058,6616],{"class":1362},[50,8060,1542],{"class":60},[50,8062,6621],{"class":1362},[50,8064,1542],{"class":60},[50,8066,7128],{"class":1362},[50,8068,4458],{"class":60},[50,8070,7652],{"class":56},[50,8072,1542],{"class":60},[50,8074,6630],{"class":1362},[50,8076,1349],{"class":60},[50,8078,8080],{"class":52,"line":8079},264,[50,8081,371],{"emptyLinePlaceholder":370},[50,8083,8085],{"class":52,"line":8084},265,[50,8086,371],{"emptyLinePlaceholder":370},[50,8088,8090,8093,8096,8098,8100,8103,8105],{"class":52,"line":8089},266,[50,8091,8092],{"class":3328},"if",[50,8094,8095],{"class":1221}," __name__ ",[50,8097,5910],{"class":60},[50,8099,241],{"class":60},[50,8101,8102],{"class":63},"__main__",[50,8104,3467],{"class":60},[50,8106,73],{"class":60},[50,8108,8110,8113],{"class":52,"line":8109},267,[50,8111,8112],{"class":1362},"    main",[50,8114,2359],{"class":60},[32,8116,8117],{},"After that, let's run the script and see if everything works as expected:",[3091,8119,8120,8141],{},[40,8121,8124],{"className":1997,"code":8122,"filename":8123,"language":1999,"meta":45,"style":45},"uv run generate_data.py --dsn postgresql://postgres:postgres@localhost:5432/postgres \n","Bash UV",[47,8125,8126],{"__ignoreMap":45},[50,8127,8128,8130,8132,8135,8138],{"class":52,"line":53},[50,8129,1984],{"class":2006},[50,8131,3106],{"class":63},[50,8133,8134],{"class":63}," generate_data.py",[50,8136,8137],{"class":63}," --dsn",[50,8139,8140],{"class":63}," postgresql://postgres:postgres@localhost:5432/postgres\n",[40,8142,8145],{"className":1997,"code":8143,"filename":8144,"language":1999,"meta":45,"style":45},"make generate-data \n","Bash Makefile",[47,8146,8147],{"__ignoreMap":45},[50,8148,8149,8151],{"class":52,"line":53},[50,8150,3195],{"class":2006},[50,8152,8153],{"class":63}," generate-data\n",[32,8155,8156],{},"The output should look like this:",[40,8158,8161],{"className":1997,"code":8159,"filename":8160,"language":1999,"meta":45,"style":45},"=== Generating E-commerce Demo Data ===\nWindow: 2025-10-19T00:00:00+00:00 → 2025-10-19T23:59:59.999999+00:00\nScale x1 | Seed 42 | Chaos 0.0%\n\n\n✅ Data generation complete\nWindow: 2025-10-19T00:00:00+00:00 → 2025-10-19T23:59:59.999999+00:00\nCounts — Customers: 100 | Products: 50 | Variants: 144\nWindow Facts — Orders: 500 | Items: 1,487 | MaxItems/Order: 5\nChaos check (invalid sizes per category):\n  • accessories: 0 invalid\n  • hoodies: 0 invalid\n  • jackets: 0 invalid\n  • shoes: 0 invalid\n  • t-shirts: 0 invalid\n","Bash Output",[47,8162,8163,8183,8197,8220,8224,8228,8241,8251,8280,8312,8334,8347,8358,8369,8380],{"__ignoreMap":45},[50,8164,8165,8168,8171,8174,8177,8180],{"class":52,"line":53},[50,8166,8167],{"class":63},"===",[50,8169,8170],{"class":63}," Generating",[50,8172,8173],{"class":63}," E-commerce",[50,8175,8176],{"class":63}," Demo",[50,8178,8179],{"class":63}," Data",[50,8181,8182],{"class":63}," ===\n",[50,8184,8185,8188,8191,8194],{"class":52,"line":67},[50,8186,8187],{"class":2006},"Window:",[50,8189,8190],{"class":63}," 2025-10-19T00:00:00+00:00",[50,8192,8193],{"class":63}," →",[50,8195,8196],{"class":63}," 2025-10-19T23:59:59.999999+00:00\n",[50,8198,8199,8202,8205,8207,8210,8212,8214,8217],{"class":52,"line":76},[50,8200,8201],{"class":2006},"Scale",[50,8203,8204],{"class":63}," x1",[50,8206,3220],{"class":60},[50,8208,8209],{"class":2006}," Seed",[50,8211,3637],{"class":154},[50,8213,3220],{"class":60},[50,8215,8216],{"class":2006}," Chaos",[50,8218,8219],{"class":63}," 0.0%\n",[50,8221,8222],{"class":52,"line":84},[50,8223,371],{"emptyLinePlaceholder":370},[50,8225,8226],{"class":52,"line":92},[50,8227,371],{"emptyLinePlaceholder":370},[50,8229,8230,8233,8235,8238],{"class":52,"line":100},[50,8231,8232],{"class":2006},"✅",[50,8234,8179],{"class":63},[50,8236,8237],{"class":63}," generation",[50,8239,8240],{"class":63}," complete\n",[50,8242,8243,8245,8247,8249],{"class":52,"line":114},[50,8244,8187],{"class":2006},[50,8246,8190],{"class":63},[50,8248,8193],{"class":63},[50,8250,8196],{"class":63},[50,8252,8253,8256,8259,8262,8264,8266,8269,8272,8274,8277],{"class":52,"line":125},[50,8254,8255],{"class":2006},"Counts",[50,8257,8258],{"class":63}," —",[50,8260,8261],{"class":63}," Customers:",[50,8263,5981],{"class":154},[50,8265,3220],{"class":60},[50,8267,8268],{"class":2006}," Products:",[50,8270,8271],{"class":154}," 50",[50,8273,3220],{"class":60},[50,8275,8276],{"class":2006}," Variants:",[50,8278,8279],{"class":154}," 144\n",[50,8281,8282,8285,8288,8290,8293,8296,8298,8301,8304,8306,8309],{"class":52,"line":135},[50,8283,8284],{"class":2006},"Window",[50,8286,8287],{"class":63}," Facts",[50,8289,8258],{"class":63},[50,8291,8292],{"class":63}," Orders:",[50,8294,8295],{"class":154}," 500",[50,8297,3220],{"class":60},[50,8299,8300],{"class":2006}," Items:",[50,8302,8303],{"class":63}," 1,487",[50,8305,3220],{"class":60},[50,8307,8308],{"class":2006}," MaxItems/Order:",[50,8310,8311],{"class":154}," 5\n",[50,8313,8314,8317,8320,8323,8326,8329,8332],{"class":52,"line":146},[50,8315,8316],{"class":2006},"Chaos",[50,8318,8319],{"class":63}," check",[50,8321,8322],{"class":1221}," (invalid ",[50,8324,8325],{"class":63},"sizes",[50,8327,8328],{"class":63}," per",[50,8330,8331],{"class":63}," category",[50,8333,5164],{"class":1221},[50,8335,8336,8339,8342,8344],{"class":52,"line":158},[50,8337,8338],{"class":2006},"  •",[50,8340,8341],{"class":63}," accessories:",[50,8343,1681],{"class":154},[50,8345,8346],{"class":63}," invalid\n",[50,8348,8349,8351,8354,8356],{"class":52,"line":168},[50,8350,8338],{"class":2006},[50,8352,8353],{"class":63}," hoodies:",[50,8355,1681],{"class":154},[50,8357,8346],{"class":63},[50,8359,8360,8362,8365,8367],{"class":52,"line":176},[50,8361,8338],{"class":2006},[50,8363,8364],{"class":63}," jackets:",[50,8366,1681],{"class":154},[50,8368,8346],{"class":63},[50,8370,8371,8373,8376,8378],{"class":52,"line":188},[50,8372,8338],{"class":2006},[50,8374,8375],{"class":63}," shoes:",[50,8377,1681],{"class":154},[50,8379,8346],{"class":63},[50,8381,8382,8384,8387,8389],{"class":52,"line":316},[50,8383,8338],{"class":2006},[50,8385,8386],{"class":63}," t-shirts:",[50,8388,1681],{"class":154},[50,8390,8346],{"class":63},[32,8392,8393],{},"Cool! Now we're ready to start our Bruin Pipeline!",[8395,8396,8397,8401],"details",{},[8398,8399,8400],"summary",{},"Click to expand the Script Argument List",[2078,8402,8403,8419],{},[2081,8404,8405],{},[2084,8406,8407,8410,8413,8416],{},[2087,8408,8409],{},"Argument",[2087,8411,8412],{},"Type",[2087,8414,8415],{},"Default",[2087,8417,8418],{},"Description",[2094,8420,8421,8442,8459,8476,8493,8510,8531,8553],{},[2084,8422,8423,8427,8431,8436],{},[2099,8424,8425],{},[47,8426,4631],{},[2099,8428,8429],{},[47,8430,4987],{},[2099,8432,8433],{},[1921,8434,8435],{},"(required)",[2099,8437,8438,8439],{},"PostgreSQL connection string (DSN). Example: ",[47,8440,8441],{},"postgresql://user:pass@localhost:5432/ecommerce",[2084,8443,8444,8448,8452,8456],{},[2099,8445,8446],{},[47,8447,4671],{},[2099,8449,8450],{},[47,8451,4683],{},[2099,8453,8454],{},[47,8455,4693],{},[2099,8457,8458],{},"Number of customers to generate.",[2084,8460,8461,8465,8469,8473],{},[2099,8462,8463],{},[47,8464,4711],{},[2099,8466,8467],{},[47,8468,4683],{},[2099,8470,8471],{},[47,8472,4730],{},[2099,8474,8475],{},"Number of products to generate.",[2084,8477,8478,8482,8486,8490],{},[2099,8479,8480],{},[47,8481,4748],{},[2099,8483,8484],{},[47,8485,4683],{},[2099,8487,8488],{},[47,8489,4767],{},[2099,8491,8492],{},"Number of orders to generate.",[2084,8494,8495,8499,8503,8507],{},[2099,8496,8497],{},[47,8498,4785],{},[2099,8500,8501],{},[47,8502,4683],{},[2099,8504,8505],{},[47,8506,4804],{},[2099,8508,8509],{},"Maximum number of items per order. Each order will have 1–N items.",[2084,8511,8512,8516,8520,8524],{},[2099,8513,8514],{},[47,8515,4822],{},[2099,8517,8518],{},[47,8519,4833],{},[2099,8521,8522],{},[47,8523,4842],{},[2099,8525,8526,8527,8530],{},"Percentage of product variants that should have ",[1921,8528,8529],{},"invalid sizes"," (used for validation testing).",[2084,8532,8533,8537,8542,8547],{},[2099,8534,8535],{},[47,8536,4976],{},[2099,8538,8539],{},[47,8540,8541],{},"str (ISO date)",[2099,8543,8544],{},[1921,8545,8546],{},"Yesterday at 00:00 UTC",[2099,8548,8549,8550,4458],{},"Beginning of the generated data window. Example: ",[47,8551,8552],{},"2024-01-01",[2084,8554,8555,8559,8563,8568],{},[2099,8556,8557],{},[47,8558,5018],{},[2099,8560,8561],{},[47,8562,8541],{},[2099,8564,8565],{},[1921,8566,8567],{},"Today at 23:59 UTC",[2099,8569,8570,8571,4458],{},"End of the generated data window. Example: ",[47,8572,8573],{},"2024-06-30",[8575,8576,8577],"blockquote",{},[32,8578,8579,8582,8583,8586],{},[1921,8580,8581],{},"Note:"," You can also run the script with the ",[47,8584,8585],{},"--help"," flag to see the available arguments.",[1917,8588,8590],{"id":8589},"_5-creating-the-bruin-pipeline","5) Creating the Bruin Pipeline",[32,8592,8593],{},"We have everything structured to start ingesting data into our Bruin Pipeline. So, first, we must create the assets.",[32,8595,8596],{},"But before that, let's understand the structure of the Bruin Pipeline.",[32,8598,8599],{},"A pipeline can be created using the Bruin CLI tool:",[40,8601,8604],{"className":1997,"code":8602,"filename":8603,"language":1999,"meta":45,"style":45},"# Example Command\nbruin init default some-feature\n","Bruin CLI",[47,8605,8606,8611],{"__ignoreMap":45},[50,8607,8608],{"class":52,"line":53},[50,8609,8610],{"class":950},"# Example Command\n",[50,8612,8613,8615,8617,8619],{"class":52,"line":67},[50,8614,2034],{"class":2006},[50,8616,2037],{"class":63},[50,8618,4688],{"class":63},[50,8620,8621],{"class":63}," some-feature\n",[32,8623,8624],{},"and it will always generate the same structure, where:",[1971,8626,8627,8653,8675],{},[1974,8628,8629,8633],{},[1921,8630,8631],{},[47,8632,38],{},[1971,8634,8635,8638],{},[1974,8636,8637],{},"The main configuration file for your Bruin environment.",[1974,8639,8640,8641,8644,8645,8648,8649,8652],{},"Defines ",[1921,8642,8643],{},"global settings"," like default ",[1921,8646,8647],{},"connections",", variables, and ",[1921,8650,8651],{},"behavior"," for all pipelines.",[1974,8654,8655,8660],{},[1921,8656,8657],{},[47,8658,8659],{},"some-feature/pipeline.yml",[1971,8661,8662,8669,8672],{},[1974,8663,8664,8665,5183],{},"Defines a specific pipeline for a domain or project (in this example, ",[8666,8667,8668],"em",{},"ecommerce",[1974,8670,8671],{},"Describes the end-to-end data flow — which assets to run, their dependencies, and schedules.",[1974,8673,8674],{},"Pipelines are modular, so you can maintain separate ones for different business domains.",[1974,8676,8677,8682],{},[1921,8678,8679],{},[47,8680,8681],{},"some-feature/assets/*",[1971,8683,8684,8687,8690],{},[1974,8685,8686],{},"Contains all the assets — the building blocks of your data pipelines.",[1974,8688,8689],{},"Each asset handles a distinct task: ingesting raw data, transforming it, or generating analytical tables.",[1974,8691,8692,8693,8696],{},"Since every asset is a file, it’s ",[1921,8694,8695],{},"version-controlled, testable, and reusable"," — just like code.",[32,8698,8699,8700,8703,8704,8707,8708,4458],{},"The important thing to remember is that Bruin will check all files nested inside the ",[47,8701,8702],{},"assets"," folder for filenames with suffix ",[47,8705,8706],{},".asset.yml",", which can be any type of asset ",[47,8709,8710],{},".asset.*",[32,8712,8713],{},"So, doesn't matter how you organize your pipeline assets, by nesting folders. If you follows the convention proposed, Bruin will understand automagically!",[1917,8715,8717],{"id":8716},"_6-raw-ingestion-assets","6. Raw Ingestion Assets",[32,8719,8720,8721,8724],{},"Using ",[47,8722,8723],{},"ingestr",", we're able to retrieve data from a source database and ingest it into destination database.",[32,8726,8727,8728,8731,8732,8735],{},"At our case, the goal is to ingest all the data generated from ",[47,8729,8730],{},"PostgresSQL"," to ",[47,8733,8734],{},"DuckDB",", which will act as our analytical database.",[32,8737,8738,8739,8741],{},"Let's take a look at our ",[47,8740,8702],{}," and configuration.",[36,8743,8744,8866,8913,8980,9075,9166,9250],{"default-value":955},[40,8745,8747],{"className":42,"code":8746,"filename":38,"language":44,"meta":45,"style":45},"default_environment: default\nenvironments:\n  default:\n    connections:\n      postgres:\n        - name: pg-default\n          username: postgres\n          password: postgres\n          host: localhost\n          port: 5432\n          database: postgres\n      duckdb:\n        - name: duckdb-default\n          path: duckdb.db\n\n",[47,8748,8749,8757,8763,8770,8777,8784,8795,8804,8813,8822,8831,8840,8847,8857],{"__ignoreMap":45},[50,8750,8751,8753,8755],{"class":52,"line":53},[50,8752,57],{"class":56},[50,8754,34],{"class":60},[50,8756,64],{"class":63},[50,8758,8759,8761],{"class":52,"line":67},[50,8760,70],{"class":56},[50,8762,73],{"class":60},[50,8764,8765,8768],{"class":52,"line":76},[50,8766,8767],{"class":56},"  default",[50,8769,73],{"class":60},[50,8771,8772,8775],{"class":52,"line":84},[50,8773,8774],{"class":56},"    connections",[50,8776,73],{"class":60},[50,8778,8779,8782],{"class":52,"line":92},[50,8780,8781],{"class":56},"      postgres",[50,8783,73],{"class":60},[50,8785,8786,8789,8791,8793],{"class":52,"line":100},[50,8787,8788],{"class":60},"        -",[50,8790,106],{"class":56},[50,8792,34],{"class":60},[50,8794,111],{"class":63},[50,8796,8797,8800,8802],{"class":52,"line":114},[50,8798,8799],{"class":56},"          username",[50,8801,34],{"class":60},[50,8803,122],{"class":63},[50,8805,8806,8809,8811],{"class":52,"line":125},[50,8807,8808],{"class":56},"          password",[50,8810,34],{"class":60},[50,8812,122],{"class":63},[50,8814,8815,8818,8820],{"class":52,"line":135},[50,8816,8817],{"class":56},"          host",[50,8819,34],{"class":60},[50,8821,143],{"class":63},[50,8823,8824,8827,8829],{"class":52,"line":146},[50,8825,8826],{"class":56},"          port",[50,8828,34],{"class":60},[50,8830,155],{"class":154},[50,8832,8833,8836,8838],{"class":52,"line":158},[50,8834,8835],{"class":56},"          database",[50,8837,34],{"class":60},[50,8839,122],{"class":63},[50,8841,8842,8845],{"class":52,"line":168},[50,8843,8844],{"class":56},"      duckdb",[50,8846,73],{"class":60},[50,8848,8849,8851,8853,8855],{"class":52,"line":176},[50,8850,8788],{"class":60},[50,8852,106],{"class":56},[50,8854,34],{"class":60},[50,8856,185],{"class":63},[50,8858,8859,8862,8864],{"class":52,"line":188},[50,8860,8861],{"class":56},"          path",[50,8863,34],{"class":60},[50,8865,196],{"class":63},[40,8867,8869],{"className":42,"code":8868,"filename":859,"language":44,"meta":45,"style":45},"name: ecommerce_pg_to_duckdb\n\ndefault_connections:\n  duckdb: \"duckdb-default\"\n  postgres: \"pg-default\"\n\n",[47,8870,8871,8879,8883,8889,8901],{"__ignoreMap":45},[50,8872,8873,8875,8877],{"class":52,"line":53},[50,8874,866],{"class":56},[50,8876,34],{"class":60},[50,8878,871],{"class":63},[50,8880,8881],{"class":52,"line":67},[50,8882,371],{"emptyLinePlaceholder":370},[50,8884,8885,8887],{"class":52,"line":76},[50,8886,880],{"class":56},[50,8888,73],{"class":60},[50,8890,8891,8893,8895,8897,8899],{"class":52,"line":84},[50,8892,887],{"class":56},[50,8894,34],{"class":60},[50,8896,241],{"class":60},[50,8898,894],{"class":63},[50,8900,247],{"class":60},[50,8902,8903,8905,8907,8909,8911],{"class":52,"line":92},[50,8904,901],{"class":56},[50,8906,34],{"class":60},[50,8908,241],{"class":60},[50,8910,908],{"class":63},[50,8912,247],{"class":60},[40,8914,8916],{"className":42,"code":8915,"filename":955,"language":44,"meta":45,"style":45},"name: raw.customers\ntype: ingestr\ndescription: Ingest OLTP customers from Postgres into DuckDB raw layer.\n\nparameters:\n  source_connection: pg-default\n  source_table: \"public.customers\"\n  destination: duckdb\n",[47,8917,8918,8926,8934,8942,8946,8952,8960,8972],{"__ignoreMap":45},[50,8919,8920,8922,8924],{"class":52,"line":53},[50,8921,866],{"class":56},[50,8923,34],{"class":60},[50,8925,966],{"class":63},[50,8927,8928,8930,8932],{"class":52,"line":67},[50,8929,971],{"class":56},[50,8931,34],{"class":60},[50,8933,976],{"class":63},[50,8935,8936,8938,8940],{"class":52,"line":76},[50,8937,985],{"class":56},[50,8939,34],{"class":60},[50,8941,990],{"class":63},[50,8943,8944],{"class":52,"line":84},[50,8945,371],{"emptyLinePlaceholder":370},[50,8947,8948,8950],{"class":52,"line":92},[50,8949,1018],{"class":56},[50,8951,73],{"class":60},[50,8953,8954,8956,8958],{"class":52,"line":100},[50,8955,1025],{"class":56},[50,8957,34],{"class":60},[50,8959,111],{"class":63},[50,8961,8962,8964,8966,8968,8970],{"class":52,"line":114},[50,8963,1034],{"class":56},[50,8965,34],{"class":60},[50,8967,241],{"class":60},[50,8969,1041],{"class":63},[50,8971,247],{"class":60},[50,8973,8974,8976,8978],{"class":52,"line":125},[50,8975,1048],{"class":56},[50,8977,34],{"class":60},[50,8979,1053],{"class":63},[40,8981,8983],{"className":42,"code":8982,"filename":1057,"language":44,"meta":45,"style":45},"name: raw.orders\ntype: ingestr\ndescription: Ingest OLTP orders from Postgres into DuckDB raw layer.\ntags:\n  - raw\n  - orders\ndepends:\n  - raw.customers\n\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.orders\n",[47,8984,8985,8993,9001,9009,9015,9021,9028,9035,9041,9045,9051,9059,9067],{"__ignoreMap":45},[50,8986,8987,8989,8991],{"class":52,"line":53},[50,8988,866],{"class":56},[50,8990,34],{"class":60},[50,8992,1068],{"class":63},[50,8994,8995,8997,8999],{"class":52,"line":67},[50,8996,971],{"class":56},[50,8998,34],{"class":60},[50,9000,976],{"class":63},[50,9002,9003,9005,9007],{"class":52,"line":76},[50,9004,985],{"class":56},[50,9006,34],{"class":60},[50,9008,1085],{"class":63},[50,9010,9011,9013],{"class":52,"line":84},[50,9012,999],{"class":56},[50,9014,73],{"class":60},[50,9016,9017,9019],{"class":52,"line":92},[50,9018,1006],{"class":60},[50,9020,1009],{"class":63},[50,9022,9023,9025],{"class":52,"line":100},[50,9024,1006],{"class":60},[50,9026,9027],{"class":63}," orders\n",[50,9029,9030,9033],{"class":52,"line":114},[50,9031,9032],{"class":56},"depends",[50,9034,73],{"class":60},[50,9036,9037,9039],{"class":52,"line":125},[50,9038,1006],{"class":60},[50,9040,966],{"class":63},[50,9042,9043],{"class":52,"line":135},[50,9044,371],{"emptyLinePlaceholder":370},[50,9046,9047,9049],{"class":52,"line":146},[50,9048,1018],{"class":56},[50,9050,73],{"class":60},[50,9052,9053,9055,9057],{"class":52,"line":158},[50,9054,1048],{"class":56},[50,9056,34],{"class":60},[50,9058,1053],{"class":63},[50,9060,9061,9063,9065],{"class":52,"line":168},[50,9062,1025],{"class":56},[50,9064,34],{"class":60},[50,9066,111],{"class":63},[50,9068,9069,9071,9073],{"class":52,"line":176},[50,9070,1034],{"class":56},[50,9072,34],{"class":60},[50,9074,1136],{"class":63},[40,9076,9079],{"className":42,"code":9077,"filename":9078,"language":44,"meta":45,"style":45},"name: raw.order_items\ntype: ingestr\n\ndescription: Ingest OdLTP order_items from Postgres into DuckDB raw layer.\n\ndepends:\n  - raw.orders\n\nparameters:\n  source_connection: pg-default\n  source_table: \"public.order_items\"\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.orders_items.asset.yml",[47,9080,9081,9090,9098,9102,9111,9115,9121,9127,9131,9137,9145,9158],{"__ignoreMap":45},[50,9082,9083,9085,9087],{"class":52,"line":53},[50,9084,866],{"class":56},[50,9086,34],{"class":60},[50,9088,9089],{"class":63}," raw.order_items\n",[50,9091,9092,9094,9096],{"class":52,"line":67},[50,9093,971],{"class":56},[50,9095,34],{"class":60},[50,9097,976],{"class":63},[50,9099,9100],{"class":52,"line":76},[50,9101,371],{"emptyLinePlaceholder":370},[50,9103,9104,9106,9108],{"class":52,"line":84},[50,9105,985],{"class":56},[50,9107,34],{"class":60},[50,9109,9110],{"class":63}," Ingest OdLTP order_items from Postgres into DuckDB raw layer.\n",[50,9112,9113],{"class":52,"line":92},[50,9114,371],{"emptyLinePlaceholder":370},[50,9116,9117,9119],{"class":52,"line":100},[50,9118,9032],{"class":56},[50,9120,73],{"class":60},[50,9122,9123,9125],{"class":52,"line":114},[50,9124,1006],{"class":60},[50,9126,1068],{"class":63},[50,9128,9129],{"class":52,"line":125},[50,9130,371],{"emptyLinePlaceholder":370},[50,9132,9133,9135],{"class":52,"line":135},[50,9134,1018],{"class":56},[50,9136,73],{"class":60},[50,9138,9139,9141,9143],{"class":52,"line":146},[50,9140,1025],{"class":56},[50,9142,34],{"class":60},[50,9144,111],{"class":63},[50,9146,9147,9149,9151,9153,9156],{"class":52,"line":158},[50,9148,1034],{"class":56},[50,9150,34],{"class":60},[50,9152,241],{"class":60},[50,9154,9155],{"class":63},"public.order_items",[50,9157,247],{"class":60},[50,9159,9160,9162,9164],{"class":52,"line":168},[50,9161,1048],{"class":56},[50,9163,34],{"class":60},[50,9165,1053],{"class":63},[40,9167,9170],{"className":42,"code":9168,"filename":9169,"language":44,"meta":45,"style":45},"name: raw.product_variants\ntype: ingestr\ndescription: Ingest OLTP product_variants from Postgres into DuckDB raw layer.\n\ndepends:\n  - raw.products\n\nparameters:\n  destination: duckdb\n  source_connection: pg-default\n  source_table: public.product_variants\n","orders-performance/assets/ingestion/raw.product_variants.asset.yml",[47,9171,9172,9181,9189,9198,9202,9208,9215,9219,9225,9233,9241],{"__ignoreMap":45},[50,9173,9174,9176,9178],{"class":52,"line":53},[50,9175,866],{"class":56},[50,9177,34],{"class":60},[50,9179,9180],{"class":63}," raw.product_variants\n",[50,9182,9183,9185,9187],{"class":52,"line":67},[50,9184,971],{"class":56},[50,9186,34],{"class":60},[50,9188,976],{"class":63},[50,9190,9191,9193,9195],{"class":52,"line":76},[50,9192,985],{"class":56},[50,9194,34],{"class":60},[50,9196,9197],{"class":63}," Ingest OLTP product_variants from Postgres into DuckDB raw layer.\n",[50,9199,9200],{"class":52,"line":84},[50,9201,371],{"emptyLinePlaceholder":370},[50,9203,9204,9206],{"class":52,"line":92},[50,9205,9032],{"class":56},[50,9207,73],{"class":60},[50,9209,9210,9212],{"class":52,"line":100},[50,9211,1006],{"class":60},[50,9213,9214],{"class":63}," raw.products\n",[50,9216,9217],{"class":52,"line":114},[50,9218,371],{"emptyLinePlaceholder":370},[50,9220,9221,9223],{"class":52,"line":125},[50,9222,1018],{"class":56},[50,9224,73],{"class":60},[50,9226,9227,9229,9231],{"class":52,"line":135},[50,9228,1048],{"class":56},[50,9230,34],{"class":60},[50,9232,1053],{"class":63},[50,9234,9235,9237,9239],{"class":52,"line":146},[50,9236,1025],{"class":56},[50,9238,34],{"class":60},[50,9240,111],{"class":63},[50,9242,9243,9245,9247],{"class":52,"line":158},[50,9244,1034],{"class":56},[50,9246,34],{"class":60},[50,9248,9249],{"class":63}," public.product_variants\n",[40,9251,9254],{"className":42,"code":9252,"filename":9253,"language":44,"meta":45,"style":45},"name: raw.products\ntype: ingestr\n\ndescription: Ingest OLTP products from Postgres into DuckDB raw layer.\n\nparameters:\n  source_connection: pg-default\n  source_table: public.products\n  destination: duckdb\n","orders-performance/assets/ingestion/raw.products.asset.yml",[47,9255,9256,9264,9272,9276,9285,9289,9295,9303,9312],{"__ignoreMap":45},[50,9257,9258,9260,9262],{"class":52,"line":53},[50,9259,866],{"class":56},[50,9261,34],{"class":60},[50,9263,9214],{"class":63},[50,9265,9266,9268,9270],{"class":52,"line":67},[50,9267,971],{"class":56},[50,9269,34],{"class":60},[50,9271,976],{"class":63},[50,9273,9274],{"class":52,"line":76},[50,9275,371],{"emptyLinePlaceholder":370},[50,9277,9278,9280,9282],{"class":52,"line":84},[50,9279,985],{"class":56},[50,9281,34],{"class":60},[50,9283,9284],{"class":63}," Ingest OLTP products from Postgres into DuckDB raw layer.\n",[50,9286,9287],{"class":52,"line":92},[50,9288,371],{"emptyLinePlaceholder":370},[50,9290,9291,9293],{"class":52,"line":100},[50,9292,1018],{"class":56},[50,9294,73],{"class":60},[50,9296,9297,9299,9301],{"class":52,"line":114},[50,9298,1025],{"class":56},[50,9300,34],{"class":60},[50,9302,111],{"class":63},[50,9304,9305,9307,9309],{"class":52,"line":125},[50,9306,1034],{"class":56},[50,9308,34],{"class":60},[50,9310,9311],{"class":63}," public.products\n",[50,9313,9314,9316,9318],{"class":52,"line":135},[50,9315,1048],{"class":56},[50,9317,34],{"class":60},[50,9319,1053],{"class":63},[32,9321,9322],{},"The pipeline could run everything concurrently, but we're going to run it in a sequential way by awaiting the dependencies to be processed/resolved.",[40,9324,9328],{"className":9325,"code":9326,"language":9327,"meta":45,"style":45},"language-mermaid shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","flowchart TD\n    A[customers] -->|feeds| D[orders]\n    B[products] -->|defines| C[product_variants]\n    D -->|requires| E[order_items]\n    C -->|used by| E\n","mermaid",[47,9329,9330,9335,9340,9345,9350],{"__ignoreMap":45},[50,9331,9332],{"class":52,"line":53},[50,9333,9334],{"class":1221},"flowchart TD\n",[50,9336,9337],{"class":52,"line":67},[50,9338,9339],{"class":1221},"    A[customers] -->|feeds| D[orders]\n",[50,9341,9342],{"class":52,"line":76},[50,9343,9344],{"class":1221},"    B[products] -->|defines| C[product_variants]\n",[50,9346,9347],{"class":52,"line":84},[50,9348,9349],{"class":1221},"    D -->|requires| E[order_items]\n",[50,9351,9352],{"class":52,"line":92},[50,9353,9354],{"class":1221},"    C -->|used by| E\n",[32,9356,9357],{},"In Airflow or Dagster, you write DAGs in Python — describing explicitly how tasks depend on one another.\nBruin takes a declarative approach: dependencies are simply listed in YAML under the depends: key, and the system automatically resolves execution order and lineage.",[32,9359,9360],{},"Unlike Airflow (which just schedules tasks) or dbt (which only supports SQL), Bruin allows you to define transformations in both SQL and Python — directly tied to your ingestion assets.",[2078,9362,9363,9373],{},[2081,9364,9365],{},[2084,9366,9367,9370],{},[2087,9368,9369],{},"Pipeline Layer",[2087,9371,9372],{},"Bruin Equivalent",[2094,9374,9375,9386,9397],{},[2084,9376,9377,9380],{},[2099,9378,9379],{},"Ingestion (Airbyte, Fivetran)",[2099,9381,9382,9385],{},[47,9383,9384],{},"type: ingestr"," assets",[2084,9387,9388,9391],{},[2099,9389,9390],{},"Transformation (dbt)",[2099,9392,9393,9396],{},[47,9394,9395],{},"type: transform"," assets (YML,SQL or Python)",[2084,9398,9399,9402],{},[2099,9400,9401],{},"Orchestration (Airflow, Dagster)",[2099,9403,9404,9405],{},"Implicit asset graph with ",[47,9406,9407],{},"depends:",[32,9409,9410],{},"Now, let's see if our ingestion layer is working as expected. Using the Bruin CLI, you must run the following command:",[40,9412,9414],{"className":1997,"code":9413,"filename":8603,"language":1999,"meta":45,"style":45},"bruin run orders-performance --tag raw\n",[47,9415,9416],{"__ignoreMap":45},[50,9417,9418,9420,9422,9425,9428],{"class":52,"line":53},[50,9419,2034],{"class":2006},[50,9421,3106],{"class":63},[50,9423,9424],{"class":63}," orders-performance",[50,9426,9427],{"class":63}," --tag",[50,9429,1009],{"class":63},[32,9431,9432],{},"The output must be something like this:",[3310,9434,9435],{},[40,9436,9438],{"className":1997,"code":9437,"language":1999,"meta":45,"style":45},"Analyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found\n\n✓ Successfully validated 15 assets across 1 pipeline, all good.\n\nInterval: 2025-10-17T00:00:00Z - 2025-10-17T23:59:59Z\nStarting the pipeline execution...\n\n[20:24:23] Running:  raw.products\n[20:24:23] Running:  raw.customers\n[20:24:23] Running:  raw.orders\n[20:24:23] Running:  raw.product_variants\n\n...[logs]...\n\nPASS raw.products \nPASS raw.customers \nPASS raw.orders \nPASS raw.order_items \nPASS raw.product_variants \n\nbruin run completed successfully in 16.704s\n\n ✓ Assets executed      5 succeeded\n",[47,9439,9440,9467,9471,9482,9493,9497,9526,9530,9544,9556,9560,9572,9583,9594,9605,9609,9620,9624,9635,9644,9653,9662,9671,9675,9693,9697],{"__ignoreMap":45},[50,9441,9442,9445,9448,9451,9453,9456,9458,9461,9464],{"class":52,"line":53},[50,9443,9444],{"class":2006},"Analyzed",[50,9446,9447],{"class":63}," the",[50,9449,9450],{"class":63}," pipeline",[50,9452,1256],{"class":60},[50,9454,9455],{"class":63},"orders_performance",[50,9457,1534],{"class":60},[50,9459,9460],{"class":63}," with",[50,9462,9463],{"class":154}," 15",[50,9465,9466],{"class":63}," assets.\n",[50,9468,9469],{"class":52,"line":67},[50,9470,371],{"emptyLinePlaceholder":370},[50,9472,9473,9476,9479],{"class":52,"line":76},[50,9474,9475],{"class":2006},"Pipeline:",[50,9477,9478],{"class":63}," orders_performance",[50,9480,9481],{"class":1221}," (.)\n",[50,9483,9484,9487,9490],{"class":52,"line":84},[50,9485,9486],{"class":2006},"  No",[50,9488,9489],{"class":63}," issues",[50,9491,9492],{"class":63}," found\n",[50,9494,9495],{"class":52,"line":92},[50,9496,371],{"emptyLinePlaceholder":370},[50,9498,9499,9502,9505,9508,9510,9512,9515,9517,9520,9523],{"class":52,"line":100},[50,9500,9501],{"class":2006},"✓",[50,9503,9504],{"class":63}," Successfully",[50,9506,9507],{"class":63}," validated",[50,9509,9463],{"class":154},[50,9511,9385],{"class":63},[50,9513,9514],{"class":63}," across",[50,9516,947],{"class":154},[50,9518,9519],{"class":63}," pipeline,",[50,9521,9522],{"class":63}," all",[50,9524,9525],{"class":63}," good.\n",[50,9527,9528],{"class":52,"line":114},[50,9529,371],{"emptyLinePlaceholder":370},[50,9531,9532,9535,9538,9541],{"class":52,"line":125},[50,9533,9534],{"class":2006},"Interval:",[50,9536,9537],{"class":63}," 2025-10-17T00:00:00Z",[50,9539,9540],{"class":63}," -",[50,9542,9543],{"class":63}," 2025-10-17T23:59:59Z\n",[50,9545,9546,9549,9551,9553],{"class":52,"line":135},[50,9547,9548],{"class":2006},"Starting",[50,9550,9447],{"class":63},[50,9552,9450],{"class":63},[50,9554,9555],{"class":63}," execution...\n",[50,9557,9558],{"class":52,"line":146},[50,9559,371],{"emptyLinePlaceholder":370},[50,9561,9562,9564,9567,9569],{"class":52,"line":158},[50,9563,7444],{"class":60},[50,9565,9566],{"class":1221},"20:24:23",[50,9568,7449],{"class":60},[50,9570,9571],{"class":1221}," Running:  raw.products\n",[50,9573,9574,9576,9578,9580],{"class":52,"line":168},[50,9575,7444],{"class":60},[50,9577,9566],{"class":1221},[50,9579,7449],{"class":60},[50,9581,9582],{"class":1221}," Running:  raw.customers\n",[50,9584,9585,9587,9589,9591],{"class":52,"line":176},[50,9586,7444],{"class":60},[50,9588,9566],{"class":1221},[50,9590,7449],{"class":60},[50,9592,9593],{"class":1221}," Running:  raw.orders\n",[50,9595,9596,9598,9600,9602],{"class":52,"line":188},[50,9597,7444],{"class":60},[50,9599,9566],{"class":1221},[50,9601,7449],{"class":60},[50,9603,9604],{"class":1221}," Running:  raw.product_variants\n",[50,9606,9607],{"class":52,"line":316},[50,9608,371],{"emptyLinePlaceholder":370},[50,9610,9611,9614,9617],{"class":52,"line":324},[50,9612,9613],{"class":1362},"...",[50,9615,9616],{"class":63},"[logs]",[50,9618,9619],{"class":1362},"...\n",[50,9621,9622],{"class":52,"line":334},[50,9623,371],{"emptyLinePlaceholder":370},[50,9625,9626,9629,9632],{"class":52,"line":341},[50,9627,9628],{"class":2006},"PASS",[50,9630,9631],{"class":63}," raw.products",[50,9633,9634],{"class":1221}," \n",[50,9636,9637,9639,9642],{"class":52,"line":352},[50,9638,9628],{"class":2006},[50,9640,9641],{"class":63}," raw.customers",[50,9643,9634],{"class":1221},[50,9645,9646,9648,9651],{"class":52,"line":359},[50,9647,9628],{"class":2006},[50,9649,9650],{"class":63}," raw.orders",[50,9652,9634],{"class":1221},[50,9654,9655,9657,9660],{"class":52,"line":367},[50,9656,9628],{"class":2006},[50,9658,9659],{"class":63}," raw.order_items",[50,9661,9634],{"class":1221},[50,9663,9664,9666,9669],{"class":52,"line":374},[50,9665,9628],{"class":2006},[50,9667,9668],{"class":63}," raw.product_variants",[50,9670,9634],{"class":1221},[50,9672,9673],{"class":52,"line":382},[50,9674,371],{"emptyLinePlaceholder":370},[50,9676,9677,9679,9681,9684,9687,9690],{"class":52,"line":390},[50,9678,2034],{"class":2006},[50,9680,3106],{"class":63},[50,9682,9683],{"class":63}," completed",[50,9685,9686],{"class":63}," successfully",[50,9688,9689],{"class":63}," in",[50,9691,9692],{"class":63}," 16.704s\n",[50,9694,9695],{"class":52,"line":400},[50,9696,371],{"emptyLinePlaceholder":370},[50,9698,9699,9702,9705,9708,9711],{"class":52,"line":408},[50,9700,9701],{"class":2006}," ✓",[50,9703,9704],{"class":63}," Assets",[50,9706,9707],{"class":63}," executed",[50,9709,9710],{"class":154},"      5",[50,9712,9713],{"class":63}," succeeded\n",[8575,9715,9716],{},[32,9717,9718,9719,9722],{},"Note that using the ",[47,9720,9721],{},"--tag"," option we'll run only the assets that have the specified tag, avoiding the execution of unnecessary assets.",[1917,9724,9726],{"id":9725},"_7-implementing-quality-checks-staging-layer","7) Implementing Quality Checks (Staging layer)",[32,9728,9729,9730,9733],{},"The staging layer is where raw data gets ",[1921,9731,9732],{},"cleaned, validated, and prepared"," for analytics. Unlike the raw layer (which mirrors source systems exactly), staging applies business rules, data quality checks, and standardized transformations that make downstream analysis reliable and consistent.",[32,9735,9736,9737,9740,9741,9744,9745,9748],{},"In Bruin, the staging layer combines ",[1921,9738,9739],{},"SQL transformations"," with ",[1921,9742,9743],{},"declarative quality checks"," defined in your ",[47,9746,9747],{},"columns"," inside an asset.",[36,9750,9752,9932,10058,10402,10579,10762],{"default-value":9751},"stg.customers.asset.sql",[40,9753,9755],{"className":1139,"code":9754,"filename":1763,"language":1142,"meta":45,"style":45},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.customers\nowner: daniel@gmail.com\n\ncolumns:\n  - extends: Customer.ID\n  - extends: Customer.Email\n  - extends: Customer.Country\n  - extends: Customer.Age\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n@bruin */\n\nSELECT \n  id::INT AS customer_id, \n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n",[47,9756,9757,9761,9765,9769,9773,9777,9781,9785,9790,9794,9799,9804,9809,9814,9819,9824,9829,9833,9837,9843,9854,9872,9894,9908,9912,9916,9922],{"__ignoreMap":45},[50,9758,9759],{"class":52,"line":53},[50,9760,1149],{"class":950},[50,9762,9763],{"class":52,"line":67},[50,9764,1774],{"class":950},[50,9766,9767],{"class":52,"line":76},[50,9768,1159],{"class":950},[50,9770,9771],{"class":52,"line":84},[50,9772,1179],{"class":950},[50,9774,9775],{"class":52,"line":92},[50,9776,1184],{"class":950},[50,9778,9779],{"class":52,"line":100},[50,9780,1194],{"class":950},[50,9782,9783],{"class":52,"line":114},[50,9784,1795],{"class":950},[50,9786,9787],{"class":52,"line":125},[50,9788,9789],{"class":950},"owner: daniel@gmail.com\n",[50,9791,9792],{"class":52,"line":135},[50,9793,371],{"emptyLinePlaceholder":370},[50,9795,9796],{"class":52,"line":146},[50,9797,9798],{"class":950},"columns:\n",[50,9800,9801],{"class":52,"line":158},[50,9802,9803],{"class":950},"  - extends: Customer.ID\n",[50,9805,9806],{"class":52,"line":168},[50,9807,9808],{"class":950},"  - extends: Customer.Email\n",[50,9810,9811],{"class":52,"line":176},[50,9812,9813],{"class":950},"  - extends: Customer.Country\n",[50,9815,9816],{"class":52,"line":188},[50,9817,9818],{"class":950},"  - extends: Customer.Age\n",[50,9820,9821],{"class":52,"line":316},[50,9822,9823],{"class":950},"  - extends: Base.CreatedAt\n",[50,9825,9826],{"class":52,"line":324},[50,9827,9828],{"class":950},"  - extends: Base.UpdatedAt\n",[50,9830,9831],{"class":52,"line":334},[50,9832,1209],{"class":950},[50,9834,9835],{"class":52,"line":341},[50,9836,371],{"emptyLinePlaceholder":370},[50,9838,9839,9841],{"class":52,"line":352},[50,9840,1354],{"class":154},[50,9842,9634],{"class":1221},[50,9844,9845,9847,9849,9851],{"class":52,"line":359},[50,9846,1812],{"class":1221},[50,9848,1816],{"class":1815},[50,9850,1333],{"class":154},[50,9852,9853],{"class":1221}," customer_id, \n",[50,9855,9856,9858,9860,9862,9864,9866,9868,9870],{"class":52,"line":367},[50,9857,1826],{"class":1362},[50,9859,1366],{"class":1221},[50,9861,1831],{"class":1362},[50,9863,1834],{"class":1221},[50,9865,1837],{"class":60},[50,9867,1372],{"class":1221},[50,9869,1225],{"class":154},[50,9871,1844],{"class":1221},[50,9873,9874,9876,9878,9880,9882,9884,9886,9888,9890,9892],{"class":52,"line":374},[50,9875,1826],{"class":1362},[50,9877,1366],{"class":1221},[50,9879,1831],{"class":1362},[50,9881,1855],{"class":1221},[50,9883,1534],{"class":60},[50,9885,1860],{"class":63},[50,9887,1534],{"class":60},[50,9889,1372],{"class":1221},[50,9891,1225],{"class":154},[50,9893,1869],{"class":1221},[50,9895,9896,9898,9900,9902,9904,9906],{"class":52,"line":382},[50,9897,1826],{"class":1362},[50,9899,1876],{"class":1221},[50,9901,1879],{"class":154},[50,9903,1372],{"class":1221},[50,9905,1225],{"class":154},[50,9907,1886],{"class":1221},[50,9909,9910],{"class":52,"line":390},[50,9911,1891],{"class":1221},[50,9913,9914],{"class":52,"line":400},[50,9915,1896],{"class":1221},[50,9917,9918,9920],{"class":52,"line":408},[50,9919,1382],{"class":154},[50,9921,966],{"class":1221},[50,9923,9924,9926,9928,9930],{"class":52,"line":416},[50,9925,1907],{"class":154},[50,9927,1910],{"class":1221},[50,9929,1913],{"class":154},[50,9931,1406],{"class":1221},[40,9933,9936],{"className":1139,"code":9934,"filename":9935,"language":1142,"meta":45,"style":45},"/* @bruin\nname: stg.products\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.products\n\ncolumns:\n  - extends: Product.ID\n  - extends: Product.Name\n  - extends: Product.Category\n  - extends: Product.SKU\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n@bruin */\n\nSELECT\n  id AS product_id,\n  name,\n  category,\n  sku,\n  created_at,\n  updated_at\nFROM raw.products;\n","orders-performance/assets/staging/stg.products.sql",[47,9937,9938,9942,9947,9951,9955,9959,9963,9968,9972,9976,9981,9986,9991,9996,10000,10004,10008,10012,10016,10026,10033,10038,10043,10047,10051],{"__ignoreMap":45},[50,9939,9940],{"class":52,"line":53},[50,9941,1149],{"class":950},[50,9943,9944],{"class":52,"line":67},[50,9945,9946],{"class":950},"name: stg.products\n",[50,9948,9949],{"class":52,"line":76},[50,9950,1159],{"class":950},[50,9952,9953],{"class":52,"line":84},[50,9954,1179],{"class":950},[50,9956,9957],{"class":52,"line":92},[50,9958,1184],{"class":950},[50,9960,9961],{"class":52,"line":100},[50,9962,1194],{"class":950},[50,9964,9965],{"class":52,"line":114},[50,9966,9967],{"class":950},"  - raw.products\n",[50,9969,9970],{"class":52,"line":125},[50,9971,371],{"emptyLinePlaceholder":370},[50,9973,9974],{"class":52,"line":135},[50,9975,9798],{"class":950},[50,9977,9978],{"class":52,"line":146},[50,9979,9980],{"class":950},"  - extends: Product.ID\n",[50,9982,9983],{"class":52,"line":158},[50,9984,9985],{"class":950},"  - extends: Product.Name\n",[50,9987,9988],{"class":52,"line":168},[50,9989,9990],{"class":950},"  - extends: Product.Category\n",[50,9992,9993],{"class":52,"line":176},[50,9994,9995],{"class":950},"  - extends: Product.SKU\n",[50,9997,9998],{"class":52,"line":188},[50,9999,9823],{"class":950},[50,10001,10002],{"class":52,"line":316},[50,10003,9828],{"class":950},[50,10005,10006],{"class":52,"line":324},[50,10007,1209],{"class":950},[50,10009,10010],{"class":52,"line":334},[50,10011,371],{"emptyLinePlaceholder":370},[50,10013,10014],{"class":52,"line":341},[50,10015,1618],{"class":154},[50,10017,10018,10021,10023],{"class":52,"line":352},[50,10019,10020],{"class":1221},"  id ",[50,10022,1225],{"class":154},[50,10024,10025],{"class":1221}," product_id,\n",[50,10027,10028,10031],{"class":52,"line":359},[50,10029,10030],{"class":154},"  name",[50,10032,2259],{"class":1221},[50,10034,10035],{"class":52,"line":367},[50,10036,10037],{"class":1221},"  category,\n",[50,10039,10040],{"class":52,"line":374},[50,10041,10042],{"class":1221},"  sku,\n",[50,10044,10045],{"class":52,"line":382},[50,10046,1891],{"class":1221},[50,10048,10049],{"class":52,"line":390},[50,10050,1896],{"class":1221},[50,10052,10053,10055],{"class":52,"line":400},[50,10054,1382],{"class":154},[50,10056,10057],{"class":1221}," raw.products;\n",[40,10059,10062],{"className":1139,"code":10060,"filename":10061,"language":1142,"meta":45,"style":45},"/* @bruin\nname: stg.product_variants\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - raw.product_variants\n  - stg.products\n\ncolumns:\n  - extends: Variant.ID\n  - extends: Variant.ProductID\n  - extends: Variant.VariantSKU\n  - extends: Variant.Color\n  - extends: Variant.Size\n  - extends: Variant.ManufacturingPrice\n  - extends: Variant.SellingPrice\n  - extends: Variant.StockQuantity\n  - extends: Variant.IsActive\n  - extends: Base.CreatedAt\n  - extends: Base.UpdatedAt\n\ncustom_checks:\n  - name: validate product variant sizes\n    description: |\n      Ensures that if the product category is 'shoes', the size must be numeric.\n      Otherwise, the size must be one of ['S', 'M', 'L'].\n    value: 0\n    query: |\n      SELECT COUNT(*) AS invalid_count\n      FROM raw.product_variants v\n      JOIN stg.products p ON p.product_id = v.product_id\n      WHERE\n        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n@bruin */\n\nSELECT\n  pv.id AS variant_id,\n  pv.product_id,\n  pv.variant_sku,\n  pv.color,\n  pv.size,\n  CASE WHEN pv.manufacturing_price \u003C 0 THEN 0 ELSE pv.manufacturing_price END AS manufacturing_price,\n  CASE WHEN pv.selling_price \u003C 0 THEN 0 ELSE pv.selling_price END AS selling_price,\n  CASE WHEN pv.stock_quantity \u003C 0 THEN 0 ELSE pv.stock_quantity END AS stock_quantity,\n  COALESCE(pv.is_active, TRUE) AS is_active,\n  pv.created_at,\n  pv.updated_at\nFROM raw.product_variants pv\nJOIN stg.products p ON p.product_id = pv.product_id;\n","orders-performance/assets/staging/stg.product_variants.sql",[47,10063,10064,10068,10073,10077,10081,10085,10089,10093,10098,10102,10106,10110,10115,10120,10125,10130,10135,10140,10145,10150,10155,10159,10163,10167,10172,10177,10182,10187,10192,10197,10202,10207,10212,10217,10222,10227,10232,10236,10240,10244,10254,10259,10264,10269,10274,10302,10330,10358,10370,10375,10380,10387],{"__ignoreMap":45},[50,10065,10066],{"class":52,"line":53},[50,10067,1149],{"class":950},[50,10069,10070],{"class":52,"line":67},[50,10071,10072],{"class":950},"name: stg.product_variants\n",[50,10074,10075],{"class":52,"line":76},[50,10076,1159],{"class":950},[50,10078,10079],{"class":52,"line":84},[50,10080,1179],{"class":950},[50,10082,10083],{"class":52,"line":92},[50,10084,1184],{"class":950},[50,10086,10087],{"class":52,"line":100},[50,10088,1189],{"class":950},[50,10090,10091],{"class":52,"line":114},[50,10092,1194],{"class":950},[50,10094,10095],{"class":52,"line":125},[50,10096,10097],{"class":950},"  - raw.product_variants\n",[50,10099,10100],{"class":52,"line":135},[50,10101,1446],{"class":950},[50,10103,10104],{"class":52,"line":146},[50,10105,371],{"emptyLinePlaceholder":370},[50,10107,10108],{"class":52,"line":158},[50,10109,9798],{"class":950},[50,10111,10112],{"class":52,"line":168},[50,10113,10114],{"class":950},"  - extends: Variant.ID\n",[50,10116,10117],{"class":52,"line":176},[50,10118,10119],{"class":950},"  - extends: Variant.ProductID\n",[50,10121,10122],{"class":52,"line":188},[50,10123,10124],{"class":950},"  - extends: Variant.VariantSKU\n",[50,10126,10127],{"class":52,"line":316},[50,10128,10129],{"class":950},"  - extends: Variant.Color\n",[50,10131,10132],{"class":52,"line":324},[50,10133,10134],{"class":950},"  - extends: Variant.Size\n",[50,10136,10137],{"class":52,"line":334},[50,10138,10139],{"class":950},"  - extends: Variant.ManufacturingPrice\n",[50,10141,10142],{"class":52,"line":341},[50,10143,10144],{"class":950},"  - extends: Variant.SellingPrice\n",[50,10146,10147],{"class":52,"line":352},[50,10148,10149],{"class":950},"  - extends: Variant.StockQuantity\n",[50,10151,10152],{"class":52,"line":359},[50,10153,10154],{"class":950},"  - extends: Variant.IsActive\n",[50,10156,10157],{"class":52,"line":367},[50,10158,9823],{"class":950},[50,10160,10161],{"class":52,"line":374},[50,10162,9828],{"class":950},[50,10164,10165],{"class":52,"line":382},[50,10166,371],{"emptyLinePlaceholder":370},[50,10168,10169],{"class":52,"line":390},[50,10170,10171],{"class":950},"custom_checks:\n",[50,10173,10174],{"class":52,"line":400},[50,10175,10176],{"class":950},"  - name: validate product variant sizes\n",[50,10178,10179],{"class":52,"line":408},[50,10180,10181],{"class":950},"    description: |\n",[50,10183,10184],{"class":52,"line":416},[50,10185,10186],{"class":950},"      Ensures that if the product category is 'shoes', the size must be numeric.\n",[50,10188,10189],{"class":52,"line":427},[50,10190,10191],{"class":950},"      Otherwise, the size must be one of ['S', 'M', 'L'].\n",[50,10193,10194],{"class":52,"line":438},[50,10195,10196],{"class":950},"    value: 0\n",[50,10198,10199],{"class":52,"line":450},[50,10200,10201],{"class":950},"    query: |\n",[50,10203,10204],{"class":52,"line":461},[50,10205,10206],{"class":950},"      SELECT COUNT(*) AS invalid_count\n",[50,10208,10209],{"class":52,"line":469},[50,10210,10211],{"class":950},"      FROM raw.product_variants v\n",[50,10213,10214],{"class":52,"line":482},[50,10215,10216],{"class":950},"      JOIN stg.products p ON p.product_id = v.product_id\n",[50,10218,10219],{"class":52,"line":494},[50,10220,10221],{"class":950},"      WHERE\n",[50,10223,10224],{"class":52,"line":502},[50,10225,10226],{"class":950},"        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n",[50,10228,10229],{"class":52,"line":512},[50,10230,10231],{"class":950},"        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n",[50,10233,10234],{"class":52,"line":522},[50,10235,1209],{"class":950},[50,10237,10238],{"class":52,"line":532},[50,10239,371],{"emptyLinePlaceholder":370},[50,10241,10242],{"class":52,"line":539},[50,10243,1618],{"class":154},[50,10245,10246,10249,10251],{"class":52,"line":550},[50,10247,10248],{"class":1221},"  pv.id ",[50,10250,1225],{"class":154},[50,10252,10253],{"class":1221}," variant_id,\n",[50,10255,10256],{"class":52,"line":558},[50,10257,10258],{"class":1221},"  pv.product_id,\n",[50,10260,10261],{"class":52,"line":568},[50,10262,10263],{"class":1221},"  pv.variant_sku,\n",[50,10265,10266],{"class":52,"line":577},[50,10267,10268],{"class":1221},"  pv.color,\n",[50,10270,10271],{"class":52,"line":587},[50,10272,10273],{"class":1221},"  pv.size,\n",[50,10275,10276,10278,10280,10283,10285,10287,10289,10291,10293,10295,10297,10299],{"class":52,"line":594},[50,10277,1668],{"class":154},[50,10279,1671],{"class":154},[50,10281,10282],{"class":1221}," pv.manufacturing_price ",[50,10284,1247],{"class":60},[50,10286,1681],{"class":154},[50,10288,1253],{"class":154},[50,10290,1681],{"class":154},[50,10292,1688],{"class":154},[50,10294,10282],{"class":1221},[50,10296,1702],{"class":154},[50,10298,1333],{"class":154},[50,10300,10301],{"class":1221}," manufacturing_price,\n",[50,10303,10304,10306,10308,10311,10313,10315,10317,10319,10321,10323,10325,10327],{"class":52,"line":605},[50,10305,1668],{"class":154},[50,10307,1671],{"class":154},[50,10309,10310],{"class":1221}," pv.selling_price ",[50,10312,1247],{"class":60},[50,10314,1681],{"class":154},[50,10316,1253],{"class":154},[50,10318,1681],{"class":154},[50,10320,1688],{"class":154},[50,10322,10310],{"class":1221},[50,10324,1702],{"class":154},[50,10326,1333],{"class":154},[50,10328,10329],{"class":1221}," selling_price,\n",[50,10331,10332,10334,10336,10339,10341,10343,10345,10347,10349,10351,10353,10355],{"class":52,"line":613},[50,10333,1668],{"class":154},[50,10335,1671],{"class":154},[50,10337,10338],{"class":1221}," pv.stock_quantity ",[50,10340,1247],{"class":60},[50,10342,1681],{"class":154},[50,10344,1253],{"class":154},[50,10346,1681],{"class":154},[50,10348,1688],{"class":154},[50,10350,10338],{"class":1221},[50,10352,1702],{"class":154},[50,10354,1333],{"class":154},[50,10356,10357],{"class":1221}," stock_quantity,\n",[50,10359,10360,10362,10365,10367],{"class":52,"line":623},[50,10361,1826],{"class":1362},[50,10363,10364],{"class":1221},"(pv.is_active, TRUE) ",[50,10366,1225],{"class":154},[50,10368,10369],{"class":1221}," is_active,\n",[50,10371,10372],{"class":52,"line":631},[50,10373,10374],{"class":1221},"  pv.created_at,\n",[50,10376,10377],{"class":52,"line":639},[50,10378,10379],{"class":1221},"  pv.updated_at\n",[50,10381,10382,10384],{"class":52,"line":646},[50,10383,1382],{"class":154},[50,10385,10386],{"class":1221}," raw.product_variants pv\n",[50,10388,10389,10391,10393,10395,10397,10399],{"class":52,"line":653},[50,10390,1719],{"class":154},[50,10392,1722],{"class":1221},[50,10394,1508],{"class":154},[50,10396,1727],{"class":1221},[50,10398,1514],{"class":60},[50,10400,10401],{"class":1221}," pv.product_id;\n",[40,10403,10406],{"className":1139,"code":10404,"filename":10405,"language":1142,"meta":45,"style":45},"/* @bruin\nname: stg.orders\ntype: duckdb.sql\nmaterialization:\n  type: table\n  strategy: create+replace\ndepends:\n  - raw.orders\n  - raw.customers\n\ncolumns:\n  - extends: Order.ID\n  - extends: Order.CustomerID\n  - extends: Order.OrderDate\n  - extends: Order.Status\n  - extends: Order.TotalAmount\n@bruin */\n\nWITH src AS (\n  SELECT\n    o.id              AS order_id,\n    o.customer_id,\n    o.order_date,\n    o.status,\n    CASE WHEN o.total_amount \u003C 0 THEN 0 ELSE o.total_amount END AS total_amount\n  FROM raw.orders o\n)\nSELECT * FROM src;\n","orders-performance/assets/staging/stg.orders.sql",[47,10407,10408,10412,10417,10421,10425,10429,10433,10437,10442,10446,10450,10454,10459,10464,10469,10474,10479,10483,10487,10497,10501,10511,10516,10521,10526,10555,10562,10566],{"__ignoreMap":45},[50,10409,10410],{"class":52,"line":53},[50,10411,1149],{"class":950},[50,10413,10414],{"class":52,"line":67},[50,10415,10416],{"class":950},"name: stg.orders\n",[50,10418,10419],{"class":52,"line":76},[50,10420,1159],{"class":950},[50,10422,10423],{"class":52,"line":84},[50,10424,1179],{"class":950},[50,10426,10427],{"class":52,"line":92},[50,10428,1184],{"class":950},[50,10430,10431],{"class":52,"line":100},[50,10432,1189],{"class":950},[50,10434,10435],{"class":52,"line":114},[50,10436,1194],{"class":950},[50,10438,10439],{"class":52,"line":125},[50,10440,10441],{"class":950},"  - raw.orders\n",[50,10443,10444],{"class":52,"line":135},[50,10445,1795],{"class":950},[50,10447,10448],{"class":52,"line":146},[50,10449,371],{"emptyLinePlaceholder":370},[50,10451,10452],{"class":52,"line":158},[50,10453,9798],{"class":950},[50,10455,10456],{"class":52,"line":168},[50,10457,10458],{"class":950},"  - extends: Order.ID\n",[50,10460,10461],{"class":52,"line":176},[50,10462,10463],{"class":950},"  - extends: Order.CustomerID\n",[50,10465,10466],{"class":52,"line":188},[50,10467,10468],{"class":950},"  - extends: Order.OrderDate\n",[50,10470,10471],{"class":52,"line":316},[50,10472,10473],{"class":950},"  - extends: Order.Status\n",[50,10475,10476],{"class":52,"line":324},[50,10477,10478],{"class":950},"  - extends: Order.TotalAmount\n",[50,10480,10481],{"class":52,"line":334},[50,10482,1209],{"class":950},[50,10484,10485],{"class":52,"line":341},[50,10486,371],{"emptyLinePlaceholder":370},[50,10488,10489,10491,10493,10495],{"class":52,"line":352},[50,10490,1218],{"class":154},[50,10492,1222],{"class":1221},[50,10494,1225],{"class":154},[50,10496,1228],{"class":1221},[50,10498,10499],{"class":52,"line":359},[50,10500,1570],{"class":154},[50,10502,10503,10506,10508],{"class":52,"line":367},[50,10504,10505],{"class":1221},"    o.id              ",[50,10507,1225],{"class":154},[50,10509,10510],{"class":1221}," order_id,\n",[50,10512,10513],{"class":52,"line":374},[50,10514,10515],{"class":1221},"    o.customer_id,\n",[50,10517,10518],{"class":52,"line":382},[50,10519,10520],{"class":1221},"    o.order_date,\n",[50,10522,10523],{"class":52,"line":390},[50,10524,10525],{"class":1221},"    o.status,\n",[50,10527,10528,10531,10533,10536,10538,10540,10542,10544,10546,10548,10550,10552],{"class":52,"line":400},[50,10529,10530],{"class":154},"    CASE",[50,10532,1671],{"class":154},[50,10534,10535],{"class":1221}," o.total_amount ",[50,10537,1247],{"class":60},[50,10539,1681],{"class":154},[50,10541,1253],{"class":154},[50,10543,1681],{"class":154},[50,10545,1688],{"class":154},[50,10547,10535],{"class":1221},[50,10549,1702],{"class":154},[50,10551,1333],{"class":154},[50,10553,10554],{"class":1221}," total_amount\n",[50,10556,10557,10559],{"class":52,"line":408},[50,10558,1341],{"class":154},[50,10560,10561],{"class":1221}," raw.orders o\n",[50,10563,10564],{"class":52,"line":416},[50,10565,1349],{"class":1221},[50,10567,10568,10570,10573,10576],{"class":52,"line":427},[50,10569,1354],{"class":154},[50,10571,10572],{"class":60}," *",[50,10574,10575],{"class":154}," FROM",[50,10577,10578],{"class":1221}," src;\n",[40,10580,10583],{"className":1139,"code":10581,"filename":10582,"language":1142,"meta":45,"style":45},"/* @bruin\nname: stg.order_items\ntype: duckdb.sql\nmaterialization:\n  type: table\ndepends:\n  - raw.order_items\n\ncolumns:\n  - extends: OrderItem.ID\n  - extends: OrderItem.OrderID\n  - extends: OrderItem.VariantID\n  - extends: OrderItem.Quantity\n  - extends: OrderItem.UnitPrice\n  - extends: OrderItem.TotalPrice\n  - extends: Base.CreatedAt\n@bruin */\n\nSELECT\n  oi.id AS order_item_id,\n  oi.order_id,\n  oi.variant_id,\n  oi.quantity,\n  CASE WHEN oi.unit_price \u003C 0 THEN 0 ELSE oi.unit_price END AS unit_price,\n  CASE WHEN oi.total_price \u003C 0 THEN 0 ELSE oi.total_price END AS total_price,\n  oi.created_at\nFROM raw.order_items oi;\n","orders-performance/assets/staging/stg.order_items.sql",[47,10584,10585,10589,10594,10598,10602,10606,10610,10615,10619,10623,10628,10633,10638,10643,10648,10653,10657,10661,10665,10669,10679,10684,10689,10694,10722,10750,10755],{"__ignoreMap":45},[50,10586,10587],{"class":52,"line":53},[50,10588,1149],{"class":950},[50,10590,10591],{"class":52,"line":67},[50,10592,10593],{"class":950},"name: stg.order_items\n",[50,10595,10596],{"class":52,"line":76},[50,10597,1159],{"class":950},[50,10599,10600],{"class":52,"line":84},[50,10601,1179],{"class":950},[50,10603,10604],{"class":52,"line":92},[50,10605,1184],{"class":950},[50,10607,10608],{"class":52,"line":100},[50,10609,1194],{"class":950},[50,10611,10612],{"class":52,"line":114},[50,10613,10614],{"class":950},"  - raw.order_items\n",[50,10616,10617],{"class":52,"line":125},[50,10618,371],{"emptyLinePlaceholder":370},[50,10620,10621],{"class":52,"line":135},[50,10622,9798],{"class":950},[50,10624,10625],{"class":52,"line":146},[50,10626,10627],{"class":950},"  - extends: OrderItem.ID\n",[50,10629,10630],{"class":52,"line":158},[50,10631,10632],{"class":950},"  - extends: OrderItem.OrderID\n",[50,10634,10635],{"class":52,"line":168},[50,10636,10637],{"class":950},"  - extends: OrderItem.VariantID\n",[50,10639,10640],{"class":52,"line":176},[50,10641,10642],{"class":950},"  - extends: OrderItem.Quantity\n",[50,10644,10645],{"class":52,"line":188},[50,10646,10647],{"class":950},"  - extends: OrderItem.UnitPrice\n",[50,10649,10650],{"class":52,"line":316},[50,10651,10652],{"class":950},"  - extends: OrderItem.TotalPrice\n",[50,10654,10655],{"class":52,"line":324},[50,10656,9823],{"class":950},[50,10658,10659],{"class":52,"line":334},[50,10660,1209],{"class":950},[50,10662,10663],{"class":52,"line":341},[50,10664,371],{"emptyLinePlaceholder":370},[50,10666,10667],{"class":52,"line":352},[50,10668,1618],{"class":154},[50,10670,10671,10674,10676],{"class":52,"line":359},[50,10672,10673],{"class":1221},"  oi.id ",[50,10675,1225],{"class":154},[50,10677,10678],{"class":1221}," order_item_id,\n",[50,10680,10681],{"class":52,"line":367},[50,10682,10683],{"class":1221},"  oi.order_id,\n",[50,10685,10686],{"class":52,"line":374},[50,10687,10688],{"class":1221},"  oi.variant_id,\n",[50,10690,10691],{"class":52,"line":382},[50,10692,10693],{"class":1221},"  oi.quantity,\n",[50,10695,10696,10698,10700,10703,10705,10707,10709,10711,10713,10715,10717,10719],{"class":52,"line":390},[50,10697,1668],{"class":154},[50,10699,1671],{"class":154},[50,10701,10702],{"class":1221}," oi.unit_price ",[50,10704,1247],{"class":60},[50,10706,1681],{"class":154},[50,10708,1253],{"class":154},[50,10710,1681],{"class":154},[50,10712,1688],{"class":154},[50,10714,10702],{"class":1221},[50,10716,1702],{"class":154},[50,10718,1333],{"class":154},[50,10720,10721],{"class":1221}," unit_price,\n",[50,10723,10724,10726,10728,10731,10733,10735,10737,10739,10741,10743,10745,10747],{"class":52,"line":400},[50,10725,1668],{"class":154},[50,10727,1671],{"class":154},[50,10729,10730],{"class":1221}," oi.total_price ",[50,10732,1247],{"class":60},[50,10734,1681],{"class":154},[50,10736,1253],{"class":154},[50,10738,1681],{"class":154},[50,10740,1688],{"class":154},[50,10742,10730],{"class":1221},[50,10744,1702],{"class":154},[50,10746,1333],{"class":154},[50,10748,10749],{"class":1221}," total_price,\n",[50,10751,10752],{"class":52,"line":408},[50,10753,10754],{"class":1221},"  oi.created_at\n",[50,10756,10757,10759],{"class":52,"line":416},[50,10758,1382],{"class":154},[50,10760,10761],{"class":1221}," raw.order_items oi;\n",[40,10763,10765],{"className":42,"code":10764,"filename":200,"language":44,"meta":45,"style":45},"domains:\n  customer-management:\n    description: All aspects related to customer data, registration, and account management\n    owners:\n      - \"Data Team\"\n    tags:\n      - customer\n  product-catalog:\n    description: Product and catalog data including variants and SKUs\n    owners:\n      - \"Data Team\"\n    tags:\n      - product\n      - catalog\n  sales:\n    description: Orders and order items lifecycle data\n    owners:\n      - \"Data Team\"\n    tags:\n      - sales\n\nentities:\n  Base:\n    description: Required fieds for every Ingestion/Staging step.\n    attributes:\n      ID:\n        name: id\n        type: integer\n        primary_key: true\n        description: The unique identifier in our systems.\n        checks:\n          - name: not_null\n          - name: unique\n      \n      CreatedAt:\n        name: created_at\n        type: timestamp\n        description: Timestamp when the record was created.\n        checks:\n          - name: not_null\n\n      UpdatedAt:\n        name: updated_at\n        type: timestamp\n        description: Timestamp when the record was last updated.\n        checks:\n          - name: not_null\n\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      ID:\n        name: customer_id\n        type: integer\n        description: Surrogate key for customer in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      Email:\n        name: email\n        type: string\n        description: E-mail address used during registration.\n        checks:\n          - name: not_null\n      FullName:\n        name: full_name\n        type: string\n        description: Full name of the customer.\n      Country:\n        name: country\n        type: string\n        description: Country of residence.\n      Age:\n        name: age\n        type: integer\n        description: Age of the customer.\n        checks:\n          - name: range\n            min: 0\n\n  Product:\n    description: A product offered for sale.\n    domains:\n      - product-catalog\n    attributes:\n      ID:\n        name: product_id\n        type: integer\n        description: Surrogate key for product in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      Name:\n        name: name\n        type: string\n        description: Product display name.\n        checks:\n          - name: not_null\n      Category:\n        name: category\n        type: string\n        description: Product category.\n        checks:\n          - name: not_null\n      SKU:\n        name: sku\n        type: string\n        description: Stock keeping unit for the product.\n        checks:\n          - name: not_null\n          - name: unique\n\n  Variant:\n    description: A specific variation of a product.\n    domains:\n      - product-catalog\n    attributes:\n      ID:\n        name: variant_id\n        type: integer\n        description: Surrogate key for variant in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      ProductID:\n        name: product_id\n        type: integer\n        description: Reference to Product.ID.\n        checks:\n          - name: not_null\n          - name: positive\n      VariantSKU:\n        name: variant_sku\n        type: string\n        description: SKU for the variant.\n        checks:\n          - name: not_null\n          - name: unique\n      Color:\n        name: color\n        type: string\n        description: Variant color.\n      Size:\n        name: size\n        type: string\n        description: Variant size.\n      ManufacturingPrice:\n        name: manufacturing_price\n        type: numeric\n        description: Manufacturing cost per unit.\n        checks:\n          - name: not_null\n      SellingPrice:\n        name: selling_price\n        type: numeric\n        description: Selling price per unit.\n        checks:\n          - name: not_null\n      StockQuantity:\n        name: stock_quantity\n        type: integer\n        description: Available stock quantity.\n        checks:\n          - name: not_null\n      IsActive:\n        name: is_active\n        type: boolean\n        description: Whether the variant is active.\n        checks:\n          - name: not_null\n\n  Order:\n    description: A purchase order placed by a customer.\n    domains:\n      - sales\n    attributes:\n      ID:\n        name: order_id\n        type: integer\n        description: Surrogate key for order in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      CustomerID:\n        name: customer_id\n        type: integer\n        description: Reference to Customer.ID for the purchaser.\n        checks:\n          - name: not_null\n          - name: positive\n      OrderNumber:\n        name: order_number\n        type: string\n        description: Human-readable order number.\n      OrderDate:\n        name: order_date\n        type: timestamp\n        description: When the order was placed.\n        checks:\n          - name: not_null\n      Status:\n        name: status\n        type: string\n        description: Order lifecycle status.\n        checks:\n          - name: not_null\n          - name: accepted_values\n            value:\n              - pending\n              - paid\n              - cancelled\n              - shipped\n      TotalAmount:\n        name: total_amount\n        type: numeric\n        description: Total order amount.\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n\n  OrderItem:\n    description: A line item in an order.\n    domains:\n      - sales\n    attributes:\n      ID:\n        name: order_item_id\n        type: integer\n        description: Surrogate key for order item in staging.\n        checks:\n          - name: not_null\n          - name: unique\n      OrderID:\n        name: order_id\n        type: integer\n        description: Reference to Order.ID this item belongs to.\n        checks:\n          - name: not_null\n          - name: positive\n      VariantID:\n        name: variant_id\n        type: integer\n        description: Reference to Variant.ID purchased.\n        checks:\n          - name: not_null\n          - name: positive\n      Quantity:\n        name: quantity\n        type: integer\n        description: Quantity purchased (must be positive).\n        checks:\n          - name: not_null\n          - name: range\n            min: 1\n      UnitPrice:\n        name: unit_price\n        type: numeric\n        description: Price per unit at purchase time.\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n      TotalPrice:\n        name: total_price\n        type: numeric\n        description: Total price for the line (Quantity * UnitPrice).\n        checks:\n          - name: not_null\n          - name: range\n            min: 0\n\n",[47,10766,10767,10773,10779,10787,10793,10803,10809,10815,10821,10829,10835,10845,10851,10857,10863,10869,10877,10883,10893,10899,10905,10909,10915,10921,10930,10936,10942,10950,10958,10966,10974,10980,10990,11000,11005,11011,11019,11027,11035,11041,11051,11055,11061,11069,11077,11085,11091,11101,11105,11111,11119,11125,11131,11137,11143,11151,11159,11168,11174,11184,11194,11200,11208,11216,11225,11231,11241,11247,11255,11263,11272,11278,11286,11294,11303,11309,11317,11325,11334,11340,11350,11358,11362,11369,11378,11384,11391,11397,11403,11412,11420,11429,11435,11445,11455,11462,11471,11479,11488,11494,11504,11511,11520,11528,11537,11543,11553,11560,11569,11577,11586,11592,11602,11612,11616,11623,11632,11638,11644,11650,11656,11665,11673,11682,11688,11698,11708,11715,11723,11731,11740,11746,11756,11767,11774,11783,11791,11800,11806,11816,11826,11833,11842,11850,11859,11866,11875,11883,11892,11899,11908,11917,11926,11932,11942,11949,11958,11966,11975,11981,11991,11998,12007,12015,12024,12030,12040,12047,12056,12065,12074,12080,12090,12094,12101,12110,12116,12122,12128,12134,12143,12151,12160,12166,12176,12186,12193,12201,12209,12218,12224,12234,12244,12251,12260,12268,12277,12284,12293,12301,12310,12316,12326,12333,12342,12350,12359,12365,12375,12386,12393,12401,12408,12415,12422,12429,12437,12445,12454,12460,12470,12480,12488,12492,12499,12508,12514,12520,12526,12532,12541,12549,12558,12564,12574,12584,12591,12599,12607,12616,12622,12632,12642,12649,12657,12665,12674,12680,12690,12700,12707,12716,12724,12733,12739,12749,12759,12768,12775,12784,12792,12801,12807,12817,12827,12835,12842,12851,12860,12870,12877,12888,12899],{"__ignoreMap":45},[50,10768,10769,10771],{"class":52,"line":53},[50,10770,207],{"class":56},[50,10772,73],{"class":60},[50,10774,10775,10777],{"class":52,"line":67},[50,10776,214],{"class":56},[50,10778,73],{"class":60},[50,10780,10781,10783,10785],{"class":52,"line":76},[50,10782,221],{"class":56},[50,10784,34],{"class":60},[50,10786,226],{"class":63},[50,10788,10789,10791],{"class":52,"line":84},[50,10790,231],{"class":56},[50,10792,73],{"class":60},[50,10794,10795,10797,10799,10801],{"class":52,"line":92},[50,10796,238],{"class":60},[50,10798,241],{"class":60},[50,10800,244],{"class":63},[50,10802,247],{"class":60},[50,10804,10805,10807],{"class":52,"line":100},[50,10806,252],{"class":56},[50,10808,73],{"class":60},[50,10810,10811,10813],{"class":52,"line":114},[50,10812,238],{"class":60},[50,10814,261],{"class":63},[50,10816,10817,10819],{"class":52,"line":125},[50,10818,266],{"class":56},[50,10820,73],{"class":60},[50,10822,10823,10825,10827],{"class":52,"line":135},[50,10824,221],{"class":56},[50,10826,34],{"class":60},[50,10828,277],{"class":63},[50,10830,10831,10833],{"class":52,"line":146},[50,10832,231],{"class":56},[50,10834,73],{"class":60},[50,10836,10837,10839,10841,10843],{"class":52,"line":158},[50,10838,238],{"class":60},[50,10840,241],{"class":60},[50,10842,244],{"class":63},[50,10844,247],{"class":60},[50,10846,10847,10849],{"class":52,"line":168},[50,10848,252],{"class":56},[50,10850,73],{"class":60},[50,10852,10853,10855],{"class":52,"line":176},[50,10854,238],{"class":60},[50,10856,306],{"class":63},[50,10858,10859,10861],{"class":52,"line":188},[50,10860,238],{"class":60},[50,10862,313],{"class":63},[50,10864,10865,10867],{"class":52,"line":316},[50,10866,319],{"class":56},[50,10868,73],{"class":60},[50,10870,10871,10873,10875],{"class":52,"line":324},[50,10872,221],{"class":56},[50,10874,34],{"class":60},[50,10876,331],{"class":63},[50,10878,10879,10881],{"class":52,"line":334},[50,10880,231],{"class":56},[50,10882,73],{"class":60},[50,10884,10885,10887,10889,10891],{"class":52,"line":341},[50,10886,238],{"class":60},[50,10888,241],{"class":60},[50,10890,244],{"class":63},[50,10892,247],{"class":60},[50,10894,10895,10897],{"class":52,"line":352},[50,10896,252],{"class":56},[50,10898,73],{"class":60},[50,10900,10901,10903],{"class":52,"line":359},[50,10902,238],{"class":60},[50,10904,364],{"class":63},[50,10906,10907],{"class":52,"line":367},[50,10908,371],{"emptyLinePlaceholder":370},[50,10910,10911,10913],{"class":52,"line":374},[50,10912,377],{"class":56},[50,10914,73],{"class":60},[50,10916,10917,10919],{"class":52,"line":382},[50,10918,385],{"class":56},[50,10920,73],{"class":60},[50,10922,10923,10925,10927],{"class":52,"line":390},[50,10924,221],{"class":56},[50,10926,34],{"class":60},[50,10928,10929],{"class":63}," Required fieds for every Ingestion/Staging step.\n",[50,10931,10932,10934],{"class":52,"line":400},[50,10933,403],{"class":56},[50,10935,73],{"class":60},[50,10937,10938,10940],{"class":52,"line":408},[50,10939,411],{"class":56},[50,10941,73],{"class":60},[50,10943,10944,10946,10948],{"class":52,"line":416},[50,10945,419],{"class":56},[50,10947,34],{"class":60},[50,10949,424],{"class":63},[50,10951,10952,10954,10956],{"class":52,"line":427},[50,10953,430],{"class":56},[50,10955,34],{"class":60},[50,10957,435],{"class":63},[50,10959,10960,10962,10964],{"class":52,"line":438},[50,10961,441],{"class":56},[50,10963,34],{"class":60},[50,10965,447],{"class":446},[50,10967,10968,10970,10972],{"class":52,"line":450},[50,10969,453],{"class":56},[50,10971,34],{"class":60},[50,10973,458],{"class":63},[50,10975,10976,10978],{"class":52,"line":461},[50,10977,464],{"class":56},[50,10979,73],{"class":60},[50,10981,10982,10984,10986,10988],{"class":52,"line":469},[50,10983,472],{"class":60},[50,10985,106],{"class":56},[50,10987,34],{"class":60},[50,10989,479],{"class":63},[50,10991,10992,10994,10996,10998],{"class":52,"line":482},[50,10993,472],{"class":60},[50,10995,106],{"class":56},[50,10997,34],{"class":60},[50,10999,491],{"class":63},[50,11001,11002],{"class":52,"line":494},[50,11003,11004],{"class":1221},"      \n",[50,11006,11007,11009],{"class":52,"line":502},[50,11008,497],{"class":56},[50,11010,73],{"class":60},[50,11012,11013,11015,11017],{"class":52,"line":512},[50,11014,419],{"class":56},[50,11016,34],{"class":60},[50,11018,509],{"class":63},[50,11020,11021,11023,11025],{"class":52,"line":522},[50,11022,430],{"class":56},[50,11024,34],{"class":60},[50,11026,519],{"class":63},[50,11028,11029,11031,11033],{"class":52,"line":532},[50,11030,453],{"class":56},[50,11032,34],{"class":60},[50,11034,529],{"class":63},[50,11036,11037,11039],{"class":52,"line":539},[50,11038,464],{"class":56},[50,11040,73],{"class":60},[50,11042,11043,11045,11047,11049],{"class":52,"line":550},[50,11044,472],{"class":60},[50,11046,106],{"class":56},[50,11048,34],{"class":60},[50,11050,479],{"class":63},[50,11052,11053],{"class":52,"line":558},[50,11054,371],{"emptyLinePlaceholder":370},[50,11056,11057,11059],{"class":52,"line":568},[50,11058,553],{"class":56},[50,11060,73],{"class":60},[50,11062,11063,11065,11067],{"class":52,"line":577},[50,11064,419],{"class":56},[50,11066,34],{"class":60},[50,11068,565],{"class":63},[50,11070,11071,11073,11075],{"class":52,"line":587},[50,11072,430],{"class":56},[50,11074,34],{"class":60},[50,11076,519],{"class":63},[50,11078,11079,11081,11083],{"class":52,"line":594},[50,11080,453],{"class":56},[50,11082,34],{"class":60},[50,11084,584],{"class":63},[50,11086,11087,11089],{"class":52,"line":605},[50,11088,464],{"class":56},[50,11090,73],{"class":60},[50,11092,11093,11095,11097,11099],{"class":52,"line":613},[50,11094,472],{"class":60},[50,11096,106],{"class":56},[50,11098,34],{"class":60},[50,11100,479],{"class":63},[50,11102,11103],{"class":52,"line":623},[50,11104,371],{"emptyLinePlaceholder":370},[50,11106,11107,11109],{"class":52,"line":631},[50,11108,608],{"class":56},[50,11110,73],{"class":60},[50,11112,11113,11115,11117],{"class":52,"line":639},[50,11114,221],{"class":56},[50,11116,34],{"class":60},[50,11118,620],{"class":63},[50,11120,11121,11123],{"class":52,"line":646},[50,11122,626],{"class":56},[50,11124,73],{"class":60},[50,11126,11127,11129],{"class":52,"line":653},[50,11128,238],{"class":60},[50,11130,636],{"class":63},[50,11132,11133,11135],{"class":52,"line":663},[50,11134,403],{"class":56},[50,11136,73],{"class":60},[50,11138,11139,11141],{"class":52,"line":672},[50,11140,411],{"class":56},[50,11142,73],{"class":60},[50,11144,11145,11147,11149],{"class":52,"line":679},[50,11146,419],{"class":56},[50,11148,34],{"class":60},[50,11150,660],{"class":63},[50,11152,11153,11155,11157],{"class":52,"line":690},[50,11154,430],{"class":56},[50,11156,34],{"class":60},[50,11158,435],{"class":63},[50,11160,11161,11163,11165],{"class":52,"line":701},[50,11162,453],{"class":56},[50,11164,34],{"class":60},[50,11166,11167],{"class":63}," Surrogate key for customer in staging.\n",[50,11169,11170,11172],{"class":52,"line":709},[50,11171,464],{"class":56},[50,11173,73],{"class":60},[50,11175,11176,11178,11180,11182],{"class":52,"line":719},[50,11177,472],{"class":60},[50,11179,106],{"class":56},[50,11181,34],{"class":60},[50,11183,479],{"class":63},[50,11185,11186,11188,11190,11192],{"class":52,"line":729},[50,11187,472],{"class":60},[50,11189,106],{"class":56},[50,11191,34],{"class":60},[50,11193,491],{"class":63},[50,11195,11196,11198],{"class":52,"line":736},[50,11197,704],{"class":56},[50,11199,73],{"class":60},[50,11201,11202,11204,11206],{"class":52,"line":747},[50,11203,419],{"class":56},[50,11205,34],{"class":60},[50,11207,716],{"class":63},[50,11209,11210,11212,11214],{"class":52,"line":755},[50,11211,430],{"class":56},[50,11213,34],{"class":60},[50,11215,726],{"class":63},[50,11217,11218,11220,11222],{"class":52,"line":765},[50,11219,453],{"class":56},[50,11221,34],{"class":60},[50,11223,11224],{"class":63}," E-mail address used during registration.\n",[50,11226,11227,11229],{"class":52,"line":774},[50,11228,464],{"class":56},[50,11230,73],{"class":60},[50,11232,11233,11235,11237,11239],{"class":52,"line":782},[50,11234,472],{"class":60},[50,11236,106],{"class":56},[50,11238,34],{"class":60},[50,11240,479],{"class":63},[50,11242,11243,11245],{"class":52,"line":792},[50,11244,750],{"class":56},[50,11246,73],{"class":60},[50,11248,11249,11251,11253],{"class":52,"line":801},[50,11250,419],{"class":56},[50,11252,34],{"class":60},[50,11254,762],{"class":63},[50,11256,11257,11259,11261],{"class":52,"line":809},[50,11258,430],{"class":56},[50,11260,34],{"class":60},[50,11262,726],{"class":63},[50,11264,11265,11267,11269],{"class":52,"line":819},[50,11266,453],{"class":56},[50,11268,34],{"class":60},[50,11270,11271],{"class":63}," Full name of the customer.\n",[50,11273,11274,11276],{"class":52,"line":828},[50,11275,777],{"class":56},[50,11277,73],{"class":60},[50,11279,11280,11282,11284],{"class":52,"line":835},[50,11281,419],{"class":56},[50,11283,34],{"class":60},[50,11285,789],{"class":63},[50,11287,11288,11290,11292],{"class":52,"line":847},[50,11289,430],{"class":56},[50,11291,34],{"class":60},[50,11293,726],{"class":63},[50,11295,11296,11298,11300],{"class":52,"line":4131},[50,11297,453],{"class":56},[50,11299,34],{"class":60},[50,11301,11302],{"class":63}," Country of residence.\n",[50,11304,11305,11307],{"class":52,"line":4137},[50,11306,804],{"class":56},[50,11308,73],{"class":60},[50,11310,11311,11313,11315],{"class":52,"line":4143},[50,11312,419],{"class":56},[50,11314,34],{"class":60},[50,11316,816],{"class":63},[50,11318,11319,11321,11323],{"class":52,"line":4149},[50,11320,430],{"class":56},[50,11322,34],{"class":60},[50,11324,435],{"class":63},[50,11326,11327,11329,11331],{"class":52,"line":4158},[50,11328,453],{"class":56},[50,11330,34],{"class":60},[50,11332,11333],{"class":63}," Age of the customer.\n",[50,11335,11336,11338],{"class":52,"line":4171},[50,11337,464],{"class":56},[50,11339,73],{"class":60},[50,11341,11342,11344,11346,11348],{"class":52,"line":4177},[50,11343,472],{"class":60},[50,11345,106],{"class":56},[50,11347,34],{"class":60},[50,11349,844],{"class":63},[50,11351,11352,11354,11356],{"class":52,"line":4182},[50,11353,850],{"class":56},[50,11355,34],{"class":60},[50,11357,855],{"class":154},[50,11359,11360],{"class":52,"line":4193},[50,11361,371],{"emptyLinePlaceholder":370},[50,11363,11364,11367],{"class":52,"line":4215},[50,11365,11366],{"class":56},"  Product",[50,11368,73],{"class":60},[50,11370,11371,11373,11375],{"class":52,"line":4236},[50,11372,221],{"class":56},[50,11374,34],{"class":60},[50,11376,11377],{"class":63}," A product offered for sale.\n",[50,11379,11380,11382],{"class":52,"line":4257},[50,11381,626],{"class":56},[50,11383,73],{"class":60},[50,11385,11386,11388],{"class":52,"line":4284},[50,11387,238],{"class":60},[50,11389,11390],{"class":63}," product-catalog\n",[50,11392,11393,11395],{"class":52,"line":4298},[50,11394,403],{"class":56},[50,11396,73],{"class":60},[50,11398,11399,11401],{"class":52,"line":4304},[50,11400,411],{"class":56},[50,11402,73],{"class":60},[50,11404,11405,11407,11409],{"class":52,"line":4310},[50,11406,419],{"class":56},[50,11408,34],{"class":60},[50,11410,11411],{"class":63}," product_id\n",[50,11413,11414,11416,11418],{"class":52,"line":4316},[50,11415,430],{"class":56},[50,11417,34],{"class":60},[50,11419,435],{"class":63},[50,11421,11422,11424,11426],{"class":52,"line":4330},[50,11423,453],{"class":56},[50,11425,34],{"class":60},[50,11427,11428],{"class":63}," Surrogate key for product in staging.\n",[50,11430,11431,11433],{"class":52,"line":4338},[50,11432,464],{"class":56},[50,11434,73],{"class":60},[50,11436,11437,11439,11441,11443],{"class":52,"line":4344},[50,11438,472],{"class":60},[50,11440,106],{"class":56},[50,11442,34],{"class":60},[50,11444,479],{"class":63},[50,11446,11447,11449,11451,11453],{"class":52,"line":4349},[50,11448,472],{"class":60},[50,11450,106],{"class":56},[50,11452,34],{"class":60},[50,11454,491],{"class":63},[50,11456,11457,11460],{"class":52,"line":4359},[50,11458,11459],{"class":56},"      Name",[50,11461,73],{"class":60},[50,11463,11464,11466,11468],{"class":52,"line":4365},[50,11465,419],{"class":56},[50,11467,34],{"class":60},[50,11469,11470],{"class":63}," name\n",[50,11472,11473,11475,11477],{"class":52,"line":4371},[50,11474,430],{"class":56},[50,11476,34],{"class":60},[50,11478,726],{"class":63},[50,11480,11481,11483,11485],{"class":52,"line":4377},[50,11482,453],{"class":56},[50,11484,34],{"class":60},[50,11486,11487],{"class":63}," Product display name.\n",[50,11489,11490,11492],{"class":52,"line":4383},[50,11491,464],{"class":56},[50,11493,73],{"class":60},[50,11495,11496,11498,11500,11502],{"class":52,"line":4389},[50,11497,472],{"class":60},[50,11499,106],{"class":56},[50,11501,34],{"class":60},[50,11503,479],{"class":63},[50,11505,11506,11509],{"class":52,"line":4395},[50,11507,11508],{"class":56},"      Category",[50,11510,73],{"class":60},[50,11512,11513,11515,11517],{"class":52,"line":4401},[50,11514,419],{"class":56},[50,11516,34],{"class":60},[50,11518,11519],{"class":63}," category\n",[50,11521,11522,11524,11526],{"class":52,"line":4407},[50,11523,430],{"class":56},[50,11525,34],{"class":60},[50,11527,726],{"class":63},[50,11529,11530,11532,11534],{"class":52,"line":4413},[50,11531,453],{"class":56},[50,11533,34],{"class":60},[50,11535,11536],{"class":63}," Product category.\n",[50,11538,11539,11541],{"class":52,"line":4421},[50,11540,464],{"class":56},[50,11542,73],{"class":60},[50,11544,11545,11547,11549,11551],{"class":52,"line":4426},[50,11546,472],{"class":60},[50,11548,106],{"class":56},[50,11550,34],{"class":60},[50,11552,479],{"class":63},[50,11554,11555,11558],{"class":52,"line":4431},[50,11556,11557],{"class":56},"      SKU",[50,11559,73],{"class":60},[50,11561,11562,11564,11566],{"class":52,"line":4436},[50,11563,419],{"class":56},[50,11565,34],{"class":60},[50,11567,11568],{"class":63}," sku\n",[50,11570,11571,11573,11575],{"class":52,"line":4448},[50,11572,430],{"class":56},[50,11574,34],{"class":60},[50,11576,726],{"class":63},[50,11578,11579,11581,11583],{"class":52,"line":4476},[50,11580,453],{"class":56},[50,11582,34],{"class":60},[50,11584,11585],{"class":63}," Stock keeping unit for the product.\n",[50,11587,11588,11590],{"class":52,"line":4530},[50,11589,464],{"class":56},[50,11591,73],{"class":60},[50,11593,11594,11596,11598,11600],{"class":52,"line":4581},[50,11595,472],{"class":60},[50,11597,106],{"class":56},[50,11599,34],{"class":60},[50,11601,479],{"class":63},[50,11603,11604,11606,11608,11610],{"class":52,"line":4586},[50,11605,472],{"class":60},[50,11607,106],{"class":56},[50,11609,34],{"class":60},[50,11611,491],{"class":63},[50,11613,11614],{"class":52,"line":4616},[50,11615,371],{"emptyLinePlaceholder":370},[50,11617,11618,11621],{"class":52,"line":4658},[50,11619,11620],{"class":56},"  Variant",[50,11622,73],{"class":60},[50,11624,11625,11627,11629],{"class":52,"line":4698},[50,11626,221],{"class":56},[50,11628,34],{"class":60},[50,11630,11631],{"class":63}," A specific variation of a product.\n",[50,11633,11634,11636],{"class":52,"line":4735},[50,11635,626],{"class":56},[50,11637,73],{"class":60},[50,11639,11640,11642],{"class":52,"line":4772},[50,11641,238],{"class":60},[50,11643,11390],{"class":63},[50,11645,11646,11648],{"class":52,"line":4809},[50,11647,403],{"class":56},[50,11649,73],{"class":60},[50,11651,11652,11654],{"class":52,"line":4863},[50,11653,411],{"class":56},[50,11655,73],{"class":60},[50,11657,11658,11660,11662],{"class":52,"line":4913},[50,11659,419],{"class":56},[50,11661,34],{"class":60},[50,11663,11664],{"class":63}," variant_id\n",[50,11666,11667,11669,11671],{"class":52,"line":4963},[50,11668,430],{"class":56},[50,11670,34],{"class":60},[50,11672,435],{"class":63},[50,11674,11675,11677,11679],{"class":52,"line":5005},[50,11676,453],{"class":56},[50,11678,34],{"class":60},[50,11680,11681],{"class":63}," Surrogate key for variant in staging.\n",[50,11683,11684,11686],{"class":52,"line":5046},[50,11685,464],{"class":56},[50,11687,73],{"class":60},[50,11689,11690,11692,11694,11696],{"class":52,"line":5051},[50,11691,472],{"class":60},[50,11693,106],{"class":56},[50,11695,34],{"class":60},[50,11697,479],{"class":63},[50,11699,11700,11702,11704,11706],{"class":52,"line":5069},[50,11701,472],{"class":60},[50,11703,106],{"class":56},[50,11705,34],{"class":60},[50,11707,491],{"class":63},[50,11709,11710,11713],{"class":52,"line":5103},[50,11711,11712],{"class":56},"      ProductID",[50,11714,73],{"class":60},[50,11716,11717,11719,11721],{"class":52,"line":5132},[50,11718,419],{"class":56},[50,11720,34],{"class":60},[50,11722,11411],{"class":63},[50,11724,11725,11727,11729],{"class":52,"line":5141},[50,11726,430],{"class":56},[50,11728,34],{"class":60},[50,11730,435],{"class":63},[50,11732,11733,11735,11737],{"class":52,"line":5146},[50,11734,453],{"class":56},[50,11736,34],{"class":60},[50,11738,11739],{"class":63}," Reference to Product.ID.\n",[50,11741,11742,11744],{"class":52,"line":5151},[50,11743,464],{"class":56},[50,11745,73],{"class":60},[50,11747,11748,11750,11752,11754],{"class":52,"line":5167},[50,11749,472],{"class":60},[50,11751,106],{"class":56},[50,11753,34],{"class":60},[50,11755,479],{"class":63},[50,11757,11758,11760,11762,11764],{"class":52,"line":5199},[50,11759,472],{"class":60},[50,11761,106],{"class":56},[50,11763,34],{"class":60},[50,11765,11766],{"class":63}," positive\n",[50,11768,11769,11772],{"class":52,"line":5204},[50,11770,11771],{"class":56},"      VariantSKU",[50,11773,73],{"class":60},[50,11775,11776,11778,11780],{"class":52,"line":5209},[50,11777,419],{"class":56},[50,11779,34],{"class":60},[50,11781,11782],{"class":63}," variant_sku\n",[50,11784,11785,11787,11789],{"class":52,"line":5229},[50,11786,430],{"class":56},[50,11788,34],{"class":60},[50,11790,726],{"class":63},[50,11792,11793,11795,11797],{"class":52,"line":5240},[50,11794,453],{"class":56},[50,11796,34],{"class":60},[50,11798,11799],{"class":63}," SKU for the variant.\n",[50,11801,11802,11804],{"class":52,"line":5297},[50,11803,464],{"class":56},[50,11805,73],{"class":60},[50,11807,11808,11810,11812,11814],{"class":52,"line":5302},[50,11809,472],{"class":60},[50,11811,106],{"class":56},[50,11813,34],{"class":60},[50,11815,479],{"class":63},[50,11817,11818,11820,11822,11824],{"class":52,"line":5307},[50,11819,472],{"class":60},[50,11821,106],{"class":56},[50,11823,34],{"class":60},[50,11825,491],{"class":63},[50,11827,11828,11831],{"class":52,"line":5332},[50,11829,11830],{"class":56},"      Color",[50,11832,73],{"class":60},[50,11834,11835,11837,11839],{"class":52,"line":5356},[50,11836,419],{"class":56},[50,11838,34],{"class":60},[50,11840,11841],{"class":63}," color\n",[50,11843,11844,11846,11848],{"class":52,"line":5377},[50,11845,430],{"class":56},[50,11847,34],{"class":60},[50,11849,726],{"class":63},[50,11851,11852,11854,11856],{"class":52,"line":5390},[50,11853,453],{"class":56},[50,11855,34],{"class":60},[50,11857,11858],{"class":63}," Variant color.\n",[50,11860,11861,11864],{"class":52,"line":5395},[50,11862,11863],{"class":56},"      Size",[50,11865,73],{"class":60},[50,11867,11868,11870,11872],{"class":52,"line":5410},[50,11869,419],{"class":56},[50,11871,34],{"class":60},[50,11873,11874],{"class":63}," size\n",[50,11876,11877,11879,11881],{"class":52,"line":5431},[50,11878,430],{"class":56},[50,11880,34],{"class":60},[50,11882,726],{"class":63},[50,11884,11885,11887,11889],{"class":52,"line":5439},[50,11886,453],{"class":56},[50,11888,34],{"class":60},[50,11890,11891],{"class":63}," Variant size.\n",[50,11893,11894,11897],{"class":52,"line":5452},[50,11895,11896],{"class":56},"      ManufacturingPrice",[50,11898,73],{"class":60},[50,11900,11901,11903,11905],{"class":52,"line":5469},[50,11902,419],{"class":56},[50,11904,34],{"class":60},[50,11906,11907],{"class":63}," manufacturing_price\n",[50,11909,11910,11912,11914],{"class":52,"line":5481},[50,11911,430],{"class":56},[50,11913,34],{"class":60},[50,11915,11916],{"class":63}," numeric\n",[50,11918,11919,11921,11923],{"class":52,"line":5503},[50,11920,453],{"class":56},[50,11922,34],{"class":60},[50,11924,11925],{"class":63}," Manufacturing cost per unit.\n",[50,11927,11928,11930],{"class":52,"line":5523},[50,11929,464],{"class":56},[50,11931,73],{"class":60},[50,11933,11934,11936,11938,11940],{"class":52,"line":5542},[50,11935,472],{"class":60},[50,11937,106],{"class":56},[50,11939,34],{"class":60},[50,11941,479],{"class":63},[50,11943,11944,11947],{"class":52,"line":5548},[50,11945,11946],{"class":56},"      SellingPrice",[50,11948,73],{"class":60},[50,11950,11951,11953,11955],{"class":52,"line":5553},[50,11952,419],{"class":56},[50,11954,34],{"class":60},[50,11956,11957],{"class":63}," selling_price\n",[50,11959,11960,11962,11964],{"class":52,"line":5558},[50,11961,430],{"class":56},[50,11963,34],{"class":60},[50,11965,11916],{"class":63},[50,11967,11968,11970,11972],{"class":52,"line":5572},[50,11969,453],{"class":56},[50,11971,34],{"class":60},[50,11973,11974],{"class":63}," Selling price per unit.\n",[50,11976,11977,11979],{"class":52,"line":5589},[50,11978,464],{"class":56},[50,11980,73],{"class":60},[50,11982,11983,11985,11987,11989],{"class":52,"line":5612},[50,11984,472],{"class":60},[50,11986,106],{"class":56},[50,11988,34],{"class":60},[50,11990,479],{"class":63},[50,11992,11993,11996],{"class":52,"line":5619},[50,11994,11995],{"class":56},"      StockQuantity",[50,11997,73],{"class":60},[50,11999,12000,12002,12004],{"class":52,"line":5660},[50,12001,419],{"class":56},[50,12003,34],{"class":60},[50,12005,12006],{"class":63}," stock_quantity\n",[50,12008,12009,12011,12013],{"class":52,"line":5668},[50,12010,430],{"class":56},[50,12012,34],{"class":60},[50,12014,435],{"class":63},[50,12016,12017,12019,12021],{"class":52,"line":5698},[50,12018,453],{"class":56},[50,12020,34],{"class":60},[50,12022,12023],{"class":63}," Available stock quantity.\n",[50,12025,12026,12028],{"class":52,"line":5717},[50,12027,464],{"class":56},[50,12029,73],{"class":60},[50,12031,12032,12034,12036,12038],{"class":52,"line":5736},[50,12033,472],{"class":60},[50,12035,106],{"class":56},[50,12037,34],{"class":60},[50,12039,479],{"class":63},[50,12041,12042,12045],{"class":52,"line":5741},[50,12043,12044],{"class":56},"      IsActive",[50,12046,73],{"class":60},[50,12048,12049,12051,12053],{"class":52,"line":5746},[50,12050,419],{"class":56},[50,12052,34],{"class":60},[50,12054,12055],{"class":63}," is_active\n",[50,12057,12058,12060,12062],{"class":52,"line":5751},[50,12059,430],{"class":56},[50,12061,34],{"class":60},[50,12063,12064],{"class":63}," boolean\n",[50,12066,12067,12069,12071],{"class":52,"line":5771},[50,12068,453],{"class":56},[50,12070,34],{"class":60},[50,12072,12073],{"class":63}," Whether the variant is active.\n",[50,12075,12076,12078],{"class":52,"line":5791},[50,12077,464],{"class":56},[50,12079,73],{"class":60},[50,12081,12082,12084,12086,12088],{"class":52,"line":5823},[50,12083,472],{"class":60},[50,12085,106],{"class":56},[50,12087,34],{"class":60},[50,12089,479],{"class":63},[50,12091,12092],{"class":52,"line":5857},[50,12093,371],{"emptyLinePlaceholder":370},[50,12095,12096,12099],{"class":52,"line":5878},[50,12097,12098],{"class":56},"  Order",[50,12100,73],{"class":60},[50,12102,12103,12105,12107],{"class":52,"line":5935},[50,12104,221],{"class":56},[50,12106,34],{"class":60},[50,12108,12109],{"class":63}," A purchase order placed by a customer.\n",[50,12111,12112,12114],{"class":52,"line":5940},[50,12113,626],{"class":56},[50,12115,73],{"class":60},[50,12117,12118,12120],{"class":52,"line":5946},[50,12119,238],{"class":60},[50,12121,364],{"class":63},[50,12123,12124,12126],{"class":52,"line":5986},[50,12125,403],{"class":56},[50,12127,73],{"class":60},[50,12129,12130,12132],{"class":52,"line":6004},[50,12131,411],{"class":56},[50,12133,73],{"class":60},[50,12135,12136,12138,12140],{"class":52,"line":6024},[50,12137,419],{"class":56},[50,12139,34],{"class":60},[50,12141,12142],{"class":63}," order_id\n",[50,12144,12145,12147,12149],{"class":52,"line":6032},[50,12146,430],{"class":56},[50,12148,34],{"class":60},[50,12150,435],{"class":63},[50,12152,12153,12155,12157],{"class":52,"line":6056},[50,12154,453],{"class":56},[50,12156,34],{"class":60},[50,12158,12159],{"class":63}," Surrogate key for order in staging.\n",[50,12161,12162,12164],{"class":52,"line":6061},[50,12163,464],{"class":56},[50,12165,73],{"class":60},[50,12167,12168,12170,12172,12174],{"class":52,"line":6098},[50,12169,472],{"class":60},[50,12171,106],{"class":56},[50,12173,34],{"class":60},[50,12175,479],{"class":63},[50,12177,12178,12180,12182,12184],{"class":52,"line":6137},[50,12179,472],{"class":60},[50,12181,106],{"class":56},[50,12183,34],{"class":60},[50,12185,491],{"class":63},[50,12187,12188,12191],{"class":52,"line":6145},[50,12189,12190],{"class":56},"      CustomerID",[50,12192,73],{"class":60},[50,12194,12195,12197,12199],{"class":52,"line":6178},[50,12196,419],{"class":56},[50,12198,34],{"class":60},[50,12200,660],{"class":63},[50,12202,12203,12205,12207],{"class":52,"line":6202},[50,12204,430],{"class":56},[50,12206,34],{"class":60},[50,12208,435],{"class":63},[50,12210,12211,12213,12215],{"class":52,"line":6238},[50,12212,453],{"class":56},[50,12214,34],{"class":60},[50,12216,12217],{"class":63}," Reference to Customer.ID for the purchaser.\n",[50,12219,12220,12222],{"class":52,"line":6244},[50,12221,464],{"class":56},[50,12223,73],{"class":60},[50,12225,12226,12228,12230,12232],{"class":52,"line":6249},[50,12227,472],{"class":60},[50,12229,106],{"class":56},[50,12231,34],{"class":60},[50,12233,479],{"class":63},[50,12235,12236,12238,12240,12242],{"class":52,"line":6254},[50,12237,472],{"class":60},[50,12239,106],{"class":56},[50,12241,34],{"class":60},[50,12243,11766],{"class":63},[50,12245,12246,12249],{"class":52,"line":6282},[50,12247,12248],{"class":56},"      OrderNumber",[50,12250,73],{"class":60},[50,12252,12253,12255,12257],{"class":52,"line":6299},[50,12254,419],{"class":56},[50,12256,34],{"class":60},[50,12258,12259],{"class":63}," order_number\n",[50,12261,12262,12264,12266],{"class":52,"line":6360},[50,12263,430],{"class":56},[50,12265,34],{"class":60},[50,12267,726],{"class":63},[50,12269,12270,12272,12274],{"class":52,"line":6397},[50,12271,453],{"class":56},[50,12273,34],{"class":60},[50,12275,12276],{"class":63}," Human-readable order number.\n",[50,12278,12279,12282],{"class":52,"line":6402},[50,12280,12281],{"class":56},"      OrderDate",[50,12283,73],{"class":60},[50,12285,12286,12288,12290],{"class":52,"line":6407},[50,12287,419],{"class":56},[50,12289,34],{"class":60},[50,12291,12292],{"class":63}," order_date\n",[50,12294,12295,12297,12299],{"class":52,"line":6432},[50,12296,430],{"class":56},[50,12298,34],{"class":60},[50,12300,519],{"class":63},[50,12302,12303,12305,12307],{"class":52,"line":6447},[50,12304,453],{"class":56},[50,12306,34],{"class":60},[50,12308,12309],{"class":63}," When the order was placed.\n",[50,12311,12312,12314],{"class":52,"line":6497},[50,12313,464],{"class":56},[50,12315,73],{"class":60},[50,12317,12318,12320,12322,12324],{"class":52,"line":6572},[50,12319,472],{"class":60},[50,12321,106],{"class":56},[50,12323,34],{"class":60},[50,12325,479],{"class":63},[50,12327,12328,12331],{"class":52,"line":6577},[50,12329,12330],{"class":56},"      Status",[50,12332,73],{"class":60},[50,12334,12335,12337,12339],{"class":52,"line":6582},[50,12336,419],{"class":56},[50,12338,34],{"class":60},[50,12340,12341],{"class":63}," status\n",[50,12343,12344,12346,12348],{"class":52,"line":6635},[50,12345,430],{"class":56},[50,12347,34],{"class":60},[50,12349,726],{"class":63},[50,12351,12352,12354,12356],{"class":52,"line":6655},[50,12353,453],{"class":56},[50,12355,34],{"class":60},[50,12357,12358],{"class":63}," Order lifecycle status.\n",[50,12360,12361,12363],{"class":52,"line":6700},[50,12362,464],{"class":56},[50,12364,73],{"class":60},[50,12366,12367,12369,12371,12373],{"class":52,"line":6750},[50,12368,472],{"class":60},[50,12370,106],{"class":56},[50,12372,34],{"class":60},[50,12374,479],{"class":63},[50,12376,12377,12379,12381,12383],{"class":52,"line":6797},[50,12378,472],{"class":60},[50,12380,106],{"class":56},[50,12382,34],{"class":60},[50,12384,12385],{"class":63}," accepted_values\n",[50,12387,12388,12391],{"class":52,"line":6813},[50,12389,12390],{"class":56},"            value",[50,12392,73],{"class":60},[50,12394,12395,12398],{"class":52,"line":6832},[50,12396,12397],{"class":60},"              -",[50,12399,12400],{"class":63}," pending\n",[50,12402,12403,12405],{"class":52,"line":6868},[50,12404,12397],{"class":60},[50,12406,12407],{"class":63}," paid\n",[50,12409,12410,12412],{"class":52,"line":6873},[50,12411,12397],{"class":60},[50,12413,12414],{"class":63}," cancelled\n",[50,12416,12417,12419],{"class":52,"line":6878},[50,12418,12397],{"class":60},[50,12420,12421],{"class":63}," shipped\n",[50,12423,12424,12427],{"class":52,"line":6888},[50,12425,12426],{"class":56},"      TotalAmount",[50,12428,73],{"class":60},[50,12430,12431,12433,12435],{"class":52,"line":6900},[50,12432,419],{"class":56},[50,12434,34],{"class":60},[50,12436,10554],{"class":63},[50,12438,12439,12441,12443],{"class":52,"line":6922},[50,12440,430],{"class":56},[50,12442,34],{"class":60},[50,12444,11916],{"class":63},[50,12446,12447,12449,12451],{"class":52,"line":6942},[50,12448,453],{"class":56},[50,12450,34],{"class":60},[50,12452,12453],{"class":63}," Total order amount.\n",[50,12455,12456,12458],{"class":52,"line":6979},[50,12457,464],{"class":56},[50,12459,73],{"class":60},[50,12461,12462,12464,12466,12468],{"class":52,"line":6984},[50,12463,472],{"class":60},[50,12465,106],{"class":56},[50,12467,34],{"class":60},[50,12469,479],{"class":63},[50,12471,12472,12474,12476,12478],{"class":52,"line":7002},[50,12473,472],{"class":60},[50,12475,106],{"class":56},[50,12477,34],{"class":60},[50,12479,844],{"class":63},[50,12481,12482,12484,12486],{"class":52,"line":7043},[50,12483,850],{"class":56},[50,12485,34],{"class":60},[50,12487,855],{"class":154},[50,12489,12490],{"class":52,"line":7105},[50,12491,371],{"emptyLinePlaceholder":370},[50,12493,12494,12497],{"class":52,"line":7110},[50,12495,12496],{"class":56},"  OrderItem",[50,12498,73],{"class":60},[50,12500,12501,12503,12505],{"class":52,"line":7152},[50,12502,221],{"class":56},[50,12504,34],{"class":60},[50,12506,12507],{"class":63}," A line item in an order.\n",[50,12509,12510,12512],{"class":52,"line":7207},[50,12511,626],{"class":56},[50,12513,73],{"class":60},[50,12515,12516,12518],{"class":52,"line":7212},[50,12517,238],{"class":60},[50,12519,364],{"class":63},[50,12521,12522,12524],{"class":52,"line":7243},[50,12523,403],{"class":56},[50,12525,73],{"class":60},[50,12527,12528,12530],{"class":52,"line":7269},[50,12529,411],{"class":56},[50,12531,73],{"class":60},[50,12533,12534,12536,12538],{"class":52,"line":7294},[50,12535,419],{"class":56},[50,12537,34],{"class":60},[50,12539,12540],{"class":63}," order_item_id\n",[50,12542,12543,12545,12547],{"class":52,"line":7299},[50,12544,430],{"class":56},[50,12546,34],{"class":60},[50,12548,435],{"class":63},[50,12550,12551,12553,12555],{"class":52,"line":7330},[50,12552,453],{"class":56},[50,12554,34],{"class":60},[50,12556,12557],{"class":63}," Surrogate key for order item in staging.\n",[50,12559,12560,12562],{"class":52,"line":7362},[50,12561,464],{"class":56},[50,12563,73],{"class":60},[50,12565,12566,12568,12570,12572],{"class":52,"line":7367},[50,12567,472],{"class":60},[50,12569,106],{"class":56},[50,12571,34],{"class":60},[50,12573,479],{"class":63},[50,12575,12576,12578,12580,12582],{"class":52,"line":7387},[50,12577,472],{"class":60},[50,12579,106],{"class":56},[50,12581,34],{"class":60},[50,12583,491],{"class":63},[50,12585,12586,12589],{"class":52,"line":7414},[50,12587,12588],{"class":56},"      OrderID",[50,12590,73],{"class":60},[50,12592,12593,12595,12597],{"class":52,"line":7426},[50,12594,419],{"class":56},[50,12596,34],{"class":60},[50,12598,12142],{"class":63},[50,12600,12601,12603,12605],{"class":52,"line":7431},[50,12602,430],{"class":56},[50,12604,34],{"class":60},[50,12606,435],{"class":63},[50,12608,12609,12611,12613],{"class":52,"line":7478},[50,12610,453],{"class":56},[50,12612,34],{"class":60},[50,12614,12615],{"class":63}," Reference to Order.ID this item belongs to.\n",[50,12617,12618,12620],{"class":52,"line":7516},[50,12619,464],{"class":56},[50,12621,73],{"class":60},[50,12623,12624,12626,12628,12630],{"class":52,"line":7521},[50,12625,472],{"class":60},[50,12627,106],{"class":56},[50,12629,34],{"class":60},[50,12631,479],{"class":63},[50,12633,12634,12636,12638,12640],{"class":52,"line":7579},[50,12635,472],{"class":60},[50,12637,106],{"class":56},[50,12639,34],{"class":60},[50,12641,11766],{"class":63},[50,12643,12644,12647],{"class":52,"line":7620},[50,12645,12646],{"class":56},"      VariantID",[50,12648,73],{"class":60},[50,12650,12651,12653,12655],{"class":52,"line":7657},[50,12652,419],{"class":56},[50,12654,34],{"class":60},[50,12656,11664],{"class":63},[50,12658,12659,12661,12663],{"class":52,"line":7662},[50,12660,430],{"class":56},[50,12662,34],{"class":60},[50,12664,435],{"class":63},[50,12666,12667,12669,12671],{"class":52,"line":7681},[50,12668,453],{"class":56},[50,12670,34],{"class":60},[50,12672,12673],{"class":63}," Reference to Variant.ID purchased.\n",[50,12675,12676,12678],{"class":52,"line":7707},[50,12677,464],{"class":56},[50,12679,73],{"class":60},[50,12681,12682,12684,12686,12688],{"class":52,"line":7718},[50,12683,472],{"class":60},[50,12685,106],{"class":56},[50,12687,34],{"class":60},[50,12689,479],{"class":63},[50,12691,12692,12694,12696,12698],{"class":52,"line":7723},[50,12693,472],{"class":60},[50,12695,106],{"class":56},[50,12697,34],{"class":60},[50,12699,11766],{"class":63},[50,12701,12702,12705],{"class":52,"line":7742},[50,12703,12704],{"class":56},"      Quantity",[50,12706,73],{"class":60},[50,12708,12709,12711,12713],{"class":52,"line":7769},[50,12710,419],{"class":56},[50,12712,34],{"class":60},[50,12714,12715],{"class":63}," quantity\n",[50,12717,12718,12720,12722],{"class":52,"line":7791},[50,12719,430],{"class":56},[50,12721,34],{"class":60},[50,12723,435],{"class":63},[50,12725,12726,12728,12730],{"class":52,"line":7816},[50,12727,453],{"class":56},[50,12729,34],{"class":60},[50,12731,12732],{"class":63}," Quantity purchased (must be positive).\n",[50,12734,12735,12737],{"class":52,"line":7836},[50,12736,464],{"class":56},[50,12738,73],{"class":60},[50,12740,12741,12743,12745,12747],{"class":52,"line":7861},[50,12742,472],{"class":60},[50,12744,106],{"class":56},[50,12746,34],{"class":60},[50,12748,479],{"class":63},[50,12750,12751,12753,12755,12757],{"class":52,"line":7881},[50,12752,472],{"class":60},[50,12754,106],{"class":56},[50,12756,34],{"class":60},[50,12758,844],{"class":63},[50,12760,12761,12763,12765],{"class":52,"line":7916},[50,12762,850],{"class":56},[50,12764,34],{"class":60},[50,12766,12767],{"class":154}," 1\n",[50,12769,12770,12773],{"class":52,"line":7936},[50,12771,12772],{"class":56},"      UnitPrice",[50,12774,73],{"class":60},[50,12776,12777,12779,12781],{"class":52,"line":7971},[50,12778,419],{"class":56},[50,12780,34],{"class":60},[50,12782,12783],{"class":63}," unit_price\n",[50,12785,12786,12788,12790],{"class":52,"line":7991},[50,12787,430],{"class":56},[50,12789,34],{"class":60},[50,12791,11916],{"class":63},[50,12793,12794,12796,12798],{"class":52,"line":8009},[50,12795,453],{"class":56},[50,12797,34],{"class":60},[50,12799,12800],{"class":63}," Price per unit at purchase time.\n",[50,12802,12803,12805],{"class":52,"line":8026},[50,12804,464],{"class":56},[50,12806,73],{"class":60},[50,12808,12809,12811,12813,12815],{"class":52,"line":8031},[50,12810,472],{"class":60},[50,12812,106],{"class":56},[50,12814,34],{"class":60},[50,12816,479],{"class":63},[50,12818,12819,12821,12823,12825],{"class":52,"line":8079},[50,12820,472],{"class":60},[50,12822,106],{"class":56},[50,12824,34],{"class":60},[50,12826,844],{"class":63},[50,12828,12829,12831,12833],{"class":52,"line":8084},[50,12830,850],{"class":56},[50,12832,34],{"class":60},[50,12834,855],{"class":154},[50,12836,12837,12840],{"class":52,"line":8089},[50,12838,12839],{"class":56},"      TotalPrice",[50,12841,73],{"class":60},[50,12843,12844,12846,12848],{"class":52,"line":8109},[50,12845,419],{"class":56},[50,12847,34],{"class":60},[50,12849,12850],{"class":63}," total_price\n",[50,12852,12854,12856,12858],{"class":52,"line":12853},268,[50,12855,430],{"class":56},[50,12857,34],{"class":60},[50,12859,11916],{"class":63},[50,12861,12863,12865,12867],{"class":52,"line":12862},269,[50,12864,453],{"class":56},[50,12866,34],{"class":60},[50,12868,12869],{"class":63}," Total price for the line (Quantity * UnitPrice).\n",[50,12871,12873,12875],{"class":52,"line":12872},270,[50,12874,464],{"class":56},[50,12876,73],{"class":60},[50,12878,12880,12882,12884,12886],{"class":52,"line":12879},271,[50,12881,472],{"class":60},[50,12883,106],{"class":56},[50,12885,34],{"class":60},[50,12887,479],{"class":63},[50,12889,12891,12893,12895,12897],{"class":52,"line":12890},272,[50,12892,472],{"class":60},[50,12894,106],{"class":56},[50,12896,34],{"class":60},[50,12898,844],{"class":63},[50,12900,12902,12904,12906],{"class":52,"line":12901},273,[50,12903,850],{"class":56},[50,12905,34],{"class":60},[50,12907,855],{"class":154},[32,12909,12910,12911,12913],{},"You can work with column check by adding inside your asset the ",[47,12912,9747],{}," the needed definitions for the output of the column that you will materialize:",[40,12915,12918],{"className":1139,"code":12916,"filename":1763,"highlights":12917,"language":1142,"meta":45,"style":45},"/* @bruin\nname: stg.customers\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n\ndepends:\n  - raw.customers\nowner: daniel@gmail.com\n\ncolumns: \n  - name: customer_id \n    type: integer\n    primary_key: true\n    checks:\n      - name: unique\n      - name: not_null\n@bruin */\n\nSELECT \n  id::INT AS customer_id, \n  COALESCE(TRIM(email), '') AS email,\n  COALESCE(TRIM(country), 'Unknown') AS country,\n  COALESCE(age, 0) AS age,\n  created_at,\n  updated_at\nFROM raw.customers\nWHERE email IS NOT NULL;\n",[168,176,188,316,324,334,341],[47,12919,12920,12924,12928,12932,12936,12940,12944,12948,12952,12956,12960,12964,12971,12977,12983,12989,12995,13001,13007,13011,13015,13021,13031,13049,13071,13085,13089,13093,13099],{"__ignoreMap":45},[50,12921,12922],{"class":52,"line":53},[50,12923,1149],{"class":950},[50,12925,12926],{"class":52,"line":67},[50,12927,1774],{"class":950},[50,12929,12930],{"class":52,"line":76},[50,12931,1159],{"class":950},[50,12933,12934],{"class":52,"line":84},[50,12935,371],{"emptyLinePlaceholder":370},[50,12937,12938],{"class":52,"line":92},[50,12939,1179],{"class":950},[50,12941,12942],{"class":52,"line":100},[50,12943,1184],{"class":950},[50,12945,12946],{"class":52,"line":114},[50,12947,371],{"emptyLinePlaceholder":370},[50,12949,12950],{"class":52,"line":125},[50,12951,1194],{"class":950},[50,12953,12954],{"class":52,"line":135},[50,12955,1795],{"class":950},[50,12957,12958],{"class":52,"line":146},[50,12959,9789],{"class":950},[50,12961,12962],{"class":52,"line":158},[50,12963,371],{"emptyLinePlaceholder":370},[50,12965,12968],{"class":12966,"line":168},[52,12967],"highlight",[50,12969,12970],{"class":950},"columns: \n",[50,12972,12974],{"class":12973,"line":176},[52,12967],[50,12975,12976],{"class":950},"  - name: customer_id \n",[50,12978,12980],{"class":12979,"line":188},[52,12967],[50,12981,12982],{"class":950},"    type: integer\n",[50,12984,12986],{"class":12985,"line":316},[52,12967],[50,12987,12988],{"class":950},"    primary_key: true\n",[50,12990,12992],{"class":12991,"line":324},[52,12967],[50,12993,12994],{"class":950},"    checks:\n",[50,12996,12998],{"class":12997,"line":334},[52,12967],[50,12999,13000],{"class":950},"      - name: unique\n",[50,13002,13004],{"class":13003,"line":341},[52,12967],[50,13005,13006],{"class":950},"      - name: not_null\n",[50,13008,13009],{"class":52,"line":352},[50,13010,1209],{"class":950},[50,13012,13013],{"class":52,"line":359},[50,13014,371],{"emptyLinePlaceholder":370},[50,13016,13017,13019],{"class":52,"line":367},[50,13018,1354],{"class":154},[50,13020,9634],{"class":1221},[50,13022,13023,13025,13027,13029],{"class":52,"line":374},[50,13024,1812],{"class":1221},[50,13026,1816],{"class":1815},[50,13028,1333],{"class":154},[50,13030,9853],{"class":1221},[50,13032,13033,13035,13037,13039,13041,13043,13045,13047],{"class":52,"line":382},[50,13034,1826],{"class":1362},[50,13036,1366],{"class":1221},[50,13038,1831],{"class":1362},[50,13040,1834],{"class":1221},[50,13042,1837],{"class":60},[50,13044,1372],{"class":1221},[50,13046,1225],{"class":154},[50,13048,1844],{"class":1221},[50,13050,13051,13053,13055,13057,13059,13061,13063,13065,13067,13069],{"class":52,"line":390},[50,13052,1826],{"class":1362},[50,13054,1366],{"class":1221},[50,13056,1831],{"class":1362},[50,13058,1855],{"class":1221},[50,13060,1534],{"class":60},[50,13062,1860],{"class":63},[50,13064,1534],{"class":60},[50,13066,1372],{"class":1221},[50,13068,1225],{"class":154},[50,13070,1869],{"class":1221},[50,13072,13073,13075,13077,13079,13081,13083],{"class":52,"line":400},[50,13074,1826],{"class":1362},[50,13076,1876],{"class":1221},[50,13078,1879],{"class":154},[50,13080,1372],{"class":1221},[50,13082,1225],{"class":154},[50,13084,1886],{"class":1221},[50,13086,13087],{"class":52,"line":408},[50,13088,1891],{"class":1221},[50,13090,13091],{"class":52,"line":416},[50,13092,1896],{"class":1221},[50,13094,13095,13097],{"class":52,"line":427},[50,13096,1382],{"class":154},[50,13098,966],{"class":1221},[50,13100,13101,13103,13105,13107],{"class":52,"line":438},[50,13102,1907],{"class":154},[50,13104,1910],{"class":1221},[50,13106,1913],{"class":154},[50,13108,1406],{"class":1221},[32,13110,13111],{},[1921,13112,13113],{},"Available Check Types",[2078,13115,13116,13129],{},[2081,13117,13118],{},[2084,13119,13120,13123,13126],{},[2087,13121,13122],{},"Check Type",[2087,13124,13125],{},"Purpose",[2087,13127,13128],{},"Example Configuration",[2094,13130,13131,13146,13160,13186,13216,13231],{},[2084,13132,13133,13138,13141],{},[2099,13134,13135],{},[47,13136,13137],{},"not_null",[2099,13139,13140],{},"Ensures no NULL values",[2099,13142,13143],{},[47,13144,13145],{},"- name: not_null",[2084,13147,13148,13152,13155],{},[2099,13149,13150],{},[47,13151,5459],{},[2099,13153,13154],{},"Ensures no duplicate values",[2099,13156,13157],{},[47,13158,13159],{},"- name: unique",[2084,13161,13162,13167,13170],{},[2099,13163,13164],{},[47,13165,13166],{},"range",[2099,13168,13169],{},"Validates numeric ranges",[2099,13171,13172,13175,13178,13181,13183],{},[47,13173,13174],{},"- name: range",[13176,13177],"br",{},[47,13179,13180],{},"  min: 0",[13176,13182],{},[47,13184,13185],{},"  max: 100",[2084,13187,13188,13193,13196],{},[2099,13189,13190],{},[47,13191,13192],{},"accepted_values",[2099,13194,13195],{},"Validates against allowed values",[2099,13197,13198,13201,13203,13206,13208,13211,13213],{},[47,13199,13200],{},"- name: accepted_values",[13176,13202],{},[47,13204,13205],{},"  value:",[13176,13207],{},[47,13209,13210],{},"    - pending",[13176,13212],{},[47,13214,13215],{},"    - paid",[2084,13217,13218,13223,13226],{},[2099,13219,13220],{},[47,13221,13222],{},"positive",[2099,13224,13225],{},"Ensures positive numbers",[2099,13227,13228],{},[47,13229,13230],{},"- name: positive",[2084,13232,13233,13238,13241],{},[2099,13234,13235],{},[47,13236,13237],{},"regex",[2099,13239,13240],{},"Pattern matching validation",[2099,13242,13243,13246,13248],{},[47,13244,13245],{},"- name: regex",[13176,13247],{},[47,13249,13250],{},"  pattern: '^[A-Z]{3}-\\d{4}$'",[32,13252,13253,13254,13257,13258,13261,13262,13264,13265,13268],{},"Bruin's approach to data quality is ",[1921,13255,13256],{},"declarative and reusable",". Instead of writing custom validation SQL for every table, you define ",[1921,13259,13260],{},"entities and attributes"," in ",[47,13263,200],{},", then reference them in your staging assets using the ",[47,13266,13267],{},"extends:"," keyword.",[32,13270,13271],{},"Here's how the column check system works:",[32,13273,13274],{},[1921,13275,13276],{},"Entity Definition in glossary.yml:",[40,13278,13280],{"className":42,"code":13279,"language":44,"meta":45,"style":45},"entities:\n  Customer:\n    description: Customer is an individual/business registered on our platform.\n    domains:\n      - customer-management\n    attributes:\n      Email:\n        name: email\n        type: string\n        description: E-mail address used during registration.\n        checks:\n          - name: not_null\n      Age:\n        name: age\n        type: integer\n        description: Age of the customer.\n        checks:\n          - name: range\n            min: 0\n",[47,13281,13282,13288,13294,13302,13308,13314,13320,13326,13334,13342,13350,13356,13366,13372,13380,13388,13396,13402,13412],{"__ignoreMap":45},[50,13283,13284,13286],{"class":52,"line":53},[50,13285,377],{"class":56},[50,13287,73],{"class":60},[50,13289,13290,13292],{"class":52,"line":67},[50,13291,608],{"class":56},[50,13293,73],{"class":60},[50,13295,13296,13298,13300],{"class":52,"line":76},[50,13297,221],{"class":56},[50,13299,34],{"class":60},[50,13301,620],{"class":63},[50,13303,13304,13306],{"class":52,"line":84},[50,13305,626],{"class":56},[50,13307,73],{"class":60},[50,13309,13310,13312],{"class":52,"line":92},[50,13311,238],{"class":60},[50,13313,636],{"class":63},[50,13315,13316,13318],{"class":52,"line":100},[50,13317,403],{"class":56},[50,13319,73],{"class":60},[50,13321,13322,13324],{"class":52,"line":114},[50,13323,704],{"class":56},[50,13325,73],{"class":60},[50,13327,13328,13330,13332],{"class":52,"line":125},[50,13329,419],{"class":56},[50,13331,34],{"class":60},[50,13333,716],{"class":63},[50,13335,13336,13338,13340],{"class":52,"line":135},[50,13337,430],{"class":56},[50,13339,34],{"class":60},[50,13341,726],{"class":63},[50,13343,13344,13346,13348],{"class":52,"line":146},[50,13345,453],{"class":56},[50,13347,34],{"class":60},[50,13349,11224],{"class":63},[50,13351,13352,13354],{"class":52,"line":158},[50,13353,464],{"class":56},[50,13355,73],{"class":60},[50,13357,13358,13360,13362,13364],{"class":52,"line":168},[50,13359,472],{"class":60},[50,13361,106],{"class":56},[50,13363,34],{"class":60},[50,13365,479],{"class":63},[50,13367,13368,13370],{"class":52,"line":176},[50,13369,804],{"class":56},[50,13371,73],{"class":60},[50,13373,13374,13376,13378],{"class":52,"line":188},[50,13375,419],{"class":56},[50,13377,34],{"class":60},[50,13379,816],{"class":63},[50,13381,13382,13384,13386],{"class":52,"line":316},[50,13383,430],{"class":56},[50,13385,34],{"class":60},[50,13387,435],{"class":63},[50,13389,13390,13392,13394],{"class":52,"line":324},[50,13391,453],{"class":56},[50,13393,34],{"class":60},[50,13395,11333],{"class":63},[50,13397,13398,13400],{"class":52,"line":334},[50,13399,464],{"class":56},[50,13401,73],{"class":60},[50,13403,13404,13406,13408,13410],{"class":52,"line":341},[50,13405,472],{"class":60},[50,13407,106],{"class":56},[50,13409,34],{"class":60},[50,13411,844],{"class":63},[50,13413,13414,13416,13418],{"class":52,"line":352},[50,13415,850],{"class":56},[50,13417,34],{"class":60},[50,13419,855],{"class":154},[32,13421,13422],{},"Then, at your asset you could easily just extends it, avoiding duplicate validations across other assets:",[40,13424,13426],{"className":1139,"code":13425,"language":1142,"meta":45,"style":45},"/* @bruin\ncolumns:\n  - extends: Customer.Email    # Inherits not_null check\n  - extends: Customer.Age      # Inherits range check (min: 0)\n@bruin */\n",[47,13427,13428,13432,13436,13441,13446],{"__ignoreMap":45},[50,13429,13430],{"class":52,"line":53},[50,13431,1149],{"class":950},[50,13433,13434],{"class":52,"line":67},[50,13435,9798],{"class":950},[50,13437,13438],{"class":52,"line":76},[50,13439,13440],{"class":950},"  - extends: Customer.Email    # Inherits not_null check\n",[50,13442,13443],{"class":52,"line":84},[50,13444,13445],{"class":950},"  - extends: Customer.Age      # Inherits range check (min: 0)\n",[50,13447,13448],{"class":52,"line":92},[50,13449,1209],{"class":950},[32,13451,13452,13453,13456],{},"For complex validations that go beyond column-level checks, Bruin supports ",[1921,13454,13455],{},"custom checks"," with SQL queries:",[40,13458,13460],{"className":1139,"code":13459,"language":1142,"meta":45,"style":45},"custom_checks:\n  - name: validate product variant sizes\n    description: |\n      Ensures that if the product category is 'shoes', the size must be numeric.\n      Otherwise, the size must be one of ['S', 'M', 'L'].\n    value: 0  # Expected result (0 = no violations)\n    query: |\n      SELECT COUNT(*) AS invalid_count\n      FROM raw.product_variants v\n      JOIN stg.products p ON p.product_id = v.product_id\n      WHERE\n        (p.category = 'shoes' AND NOT (v.size ~ '^[0-9]+$'))\n        OR (p.category != 'shoes' AND v.size NOT IN ('S', 'M', 'L'))\n",[47,13461,13462,13466,13475,13482,13516,13526,13548,13552,13571,13579,13595,13599,13628],{"__ignoreMap":45},[50,13463,13464],{"class":52,"line":53},[50,13465,10171],{"class":1221},[50,13467,13468,13470,13472],{"class":52,"line":67},[50,13469,1006],{"class":60},[50,13471,106],{"class":154},[50,13473,13474],{"class":1221},": validate product variant sizes\n",[50,13476,13477,13479],{"class":52,"line":76},[50,13478,221],{"class":154},[50,13480,13481],{"class":1221},": |\n",[50,13483,13484,13487,13489,13492,13495,13497,13499,13501,13504,13507,13510,13513],{"class":52,"line":84},[50,13485,13486],{"class":1221},"      Ensures that ",[50,13488,8092],{"class":154},[50,13490,13491],{"class":1221}," the product category ",[50,13493,13494],{"class":154},"is",[50,13496,1256],{"class":60},[50,13498,3488],{"class":63},[50,13500,1534],{"class":60},[50,13502,13503],{"class":1221},", the ",[50,13505,13506],{"class":154},"size",[50,13508,13509],{"class":1221}," must be ",[50,13511,13512],{"class":1815},"numeric",[50,13514,13515],{"class":1221},".\n",[50,13517,13518,13521,13523],{"class":52,"line":92},[50,13519,13520],{"class":1221},"      Otherwise, the ",[50,13522,13506],{"class":154},[50,13524,13525],{"class":1221}," must be one of ['S', 'M', 'L'].\n",[50,13527,13528,13531,13533,13535,13538,13540,13542,13545],{"class":52,"line":100},[50,13529,13530],{"class":154},"    value",[50,13532,6851],{"class":1221},[50,13534,1879],{"class":154},[50,13536,13537],{"class":1221},"  # Expected result (",[50,13539,1879],{"class":154},[50,13541,5080],{"class":60},[50,13543,13544],{"class":154}," no",[50,13546,13547],{"class":1221}," violations)\n",[50,13549,13550],{"class":52,"line":114},[50,13551,10201],{"class":1221},[50,13553,13554,13557,13560,13562,13564,13566,13568],{"class":52,"line":125},[50,13555,13556],{"class":154},"      SELECT",[50,13558,13559],{"class":1362}," COUNT",[50,13561,1366],{"class":1221},[50,13563,1369],{"class":60},[50,13565,1372],{"class":1221},[50,13567,1225],{"class":154},[50,13569,13570],{"class":1221}," invalid_count\n",[50,13572,13573,13576],{"class":52,"line":135},[50,13574,13575],{"class":154},"      FROM",[50,13577,13578],{"class":1221}," raw.product_variants v\n",[50,13580,13581,13584,13586,13588,13590,13592],{"class":52,"line":146},[50,13582,13583],{"class":154},"      JOIN",[50,13585,1722],{"class":1221},[50,13587,1508],{"class":154},[50,13589,1727],{"class":1221},[50,13591,1514],{"class":60},[50,13593,13594],{"class":1221}," v.product_id\n",[50,13596,13597],{"class":52,"line":158},[50,13598,10221],{"class":154},[50,13600,13601,13604,13606,13608,13610,13612,13614,13616,13619,13621,13624,13626],{"class":52,"line":168},[50,13602,13603],{"class":1221},"        (p.category ",[50,13605,1514],{"class":60},[50,13607,1256],{"class":60},[50,13609,3488],{"class":63},[50,13611,1534],{"class":60},[50,13613,1276],{"class":154},[50,13615,2239],{"class":154},[50,13617,13618],{"class":1221}," (v.size ~ ",[50,13620,1534],{"class":60},[50,13622,13623],{"class":63},"^[0-9]+$",[50,13625,1534],{"class":60},[50,13627,6053],{"class":1221},[50,13629,13630,13633,13636,13639,13641,13643,13645,13647,13650,13653,13656,13658,13660,13662,13664,13666,13668,13670,13672,13674,13676,13678,13680],{"class":52,"line":176},[50,13631,13632],{"class":154},"        OR",[50,13634,13635],{"class":1221}," (p.category ",[50,13637,13638],{"class":60},"!=",[50,13640,1256],{"class":60},[50,13642,3488],{"class":63},[50,13644,1534],{"class":60},[50,13646,1276],{"class":154},[50,13648,13649],{"class":1221}," v.size ",[50,13651,13652],{"class":154},"NOT",[50,13654,13655],{"class":154}," IN",[50,13657,1531],{"class":1221},[50,13659,1534],{"class":60},[50,13661,3579],{"class":63},[50,13663,1534],{"class":60},[50,13665,2140],{"class":1221},[50,13667,1534],{"class":60},[50,13669,3588],{"class":63},[50,13671,1534],{"class":60},[50,13673,2140],{"class":1221},[50,13675,1534],{"class":60},[50,13677,3597],{"class":63},[50,13679,1534],{"class":60},[50,13681,6053],{"class":1221},[32,13683,13684],{},"Now that we understood the basics of Bruin's data quality system, let's run the staging pipeline:",[40,13686,13688],{"className":1997,"code":13687,"language":1999,"meta":45,"style":45},"# Run all staging assets\nbruin run orders-performance --tag staging\n",[47,13689,13690,13695],{"__ignoreMap":45},[50,13691,13692],{"class":52,"line":53},[50,13693,13694],{"class":950},"# Run all staging assets\n",[50,13696,13697,13699,13701,13703,13705],{"class":52,"line":67},[50,13698,2034],{"class":2006},[50,13700,3106],{"class":63},[50,13702,9424],{"class":63},[50,13704,9427],{"class":63},[50,13706,13707],{"class":63}," staging\n",[32,13709,13710],{},"The output must be like:",[3310,13712,13713],{},[40,13714,13716],{"className":1997,"code":13715,"language":1999,"meta":45,"style":45},"\nAnalyzed the pipeline 'orders_performance' with 15 assets.\n\nPipeline: orders_performance (.)\n  No issues found\n\n✓ Successfully validated 15 assets across 1 pipeline, all good.\n\nInterval: 2025-10-17T00:00:00Z - 2025-10-17T23:59:59Z\n\nStarting the pipeline execution...\n\n[20:59:31] Running:  stg.products\n[20:59:31] Running:  stg.order_items\n[20:59:31] Running:  stg.orders\n[20:59:31] Running:  stg.customers\n[20:59:31] Finished: stg.products (28ms)\n[20:59:31] Running:  stg.product_variants\n[20:59:31] Finished: stg.orders (57ms)\n[20:59:31] Finished: stg.order_items (78ms)\n[20:59:31] Finished: stg.customers (101ms)\n[20:59:31] Finished: stg.product_variants (89ms)\n[20:59:31] Running:  stg.product_variants:custom-check:validate_product_variant_sizes\n[20:59:31] Finished: stg.product_variants:custom-check:validate_product_variant_sizes (6ms)\n\n==================================================\n\nPASS stg.products \nPASS stg.orders \nPASS stg.order_items \nPASS stg.customers \nPASS stg.product_variants .\n\n\nbruin run completed successfully in 125ms\n\n ✓ Assets executed      5 succeeded\n ✓ Quality checks       1 succeeded\n\n",[47,13717,13718,13722,13742,13746,13754,13762,13766,13788,13792,13802,13806,13816,13820,13832,13843,13854,13865,13881,13892,13908,13924,13940,13956,13967,13983,13987,13992,13996,14005,14014,14023,14032,14042,14046,14050,14065,14069,14081],{"__ignoreMap":45},[50,13719,13720],{"class":52,"line":53},[50,13721,371],{"emptyLinePlaceholder":370},[50,13723,13724,13726,13728,13730,13732,13734,13736,13738,13740],{"class":52,"line":67},[50,13725,9444],{"class":2006},[50,13727,9447],{"class":63},[50,13729,9450],{"class":63},[50,13731,1256],{"class":60},[50,13733,9455],{"class":63},[50,13735,1534],{"class":60},[50,13737,9460],{"class":63},[50,13739,9463],{"class":154},[50,13741,9466],{"class":63},[50,13743,13744],{"class":52,"line":76},[50,13745,371],{"emptyLinePlaceholder":370},[50,13747,13748,13750,13752],{"class":52,"line":84},[50,13749,9475],{"class":2006},[50,13751,9478],{"class":63},[50,13753,9481],{"class":1221},[50,13755,13756,13758,13760],{"class":52,"line":92},[50,13757,9486],{"class":2006},[50,13759,9489],{"class":63},[50,13761,9492],{"class":63},[50,13763,13764],{"class":52,"line":100},[50,13765,371],{"emptyLinePlaceholder":370},[50,13767,13768,13770,13772,13774,13776,13778,13780,13782,13784,13786],{"class":52,"line":114},[50,13769,9501],{"class":2006},[50,13771,9504],{"class":63},[50,13773,9507],{"class":63},[50,13775,9463],{"class":154},[50,13777,9385],{"class":63},[50,13779,9514],{"class":63},[50,13781,947],{"class":154},[50,13783,9519],{"class":63},[50,13785,9522],{"class":63},[50,13787,9525],{"class":63},[50,13789,13790],{"class":52,"line":125},[50,13791,371],{"emptyLinePlaceholder":370},[50,13793,13794,13796,13798,13800],{"class":52,"line":135},[50,13795,9534],{"class":2006},[50,13797,9537],{"class":63},[50,13799,9540],{"class":63},[50,13801,9543],{"class":63},[50,13803,13804],{"class":52,"line":146},[50,13805,371],{"emptyLinePlaceholder":370},[50,13807,13808,13810,13812,13814],{"class":52,"line":158},[50,13809,9548],{"class":2006},[50,13811,9447],{"class":63},[50,13813,9450],{"class":63},[50,13815,9555],{"class":63},[50,13817,13818],{"class":52,"line":168},[50,13819,371],{"emptyLinePlaceholder":370},[50,13821,13822,13824,13827,13829],{"class":52,"line":176},[50,13823,7444],{"class":60},[50,13825,13826],{"class":1221},"20:59:31",[50,13828,7449],{"class":60},[50,13830,13831],{"class":1221}," Running:  stg.products\n",[50,13833,13834,13836,13838,13840],{"class":52,"line":188},[50,13835,7444],{"class":60},[50,13837,13826],{"class":1221},[50,13839,7449],{"class":60},[50,13841,13842],{"class":1221}," Running:  stg.order_items\n",[50,13844,13845,13847,13849,13851],{"class":52,"line":316},[50,13846,7444],{"class":60},[50,13848,13826],{"class":1221},[50,13850,7449],{"class":60},[50,13852,13853],{"class":1221}," Running:  stg.orders\n",[50,13855,13856,13858,13860,13862],{"class":52,"line":324},[50,13857,7444],{"class":60},[50,13859,13826],{"class":1221},[50,13861,7449],{"class":60},[50,13863,13864],{"class":1221}," Running:  stg.customers\n",[50,13866,13867,13869,13871,13873,13876,13879],{"class":52,"line":334},[50,13868,7444],{"class":60},[50,13870,13826],{"class":1221},[50,13872,7449],{"class":60},[50,13874,13875],{"class":1221}," Finished: stg.products (",[50,13877,13878],{"class":2006},"28ms",[50,13880,1349],{"class":1221},[50,13882,13883,13885,13887,13889],{"class":52,"line":341},[50,13884,7444],{"class":60},[50,13886,13826],{"class":1221},[50,13888,7449],{"class":60},[50,13890,13891],{"class":1221}," Running:  stg.product_variants\n",[50,13893,13894,13896,13898,13900,13903,13906],{"class":52,"line":352},[50,13895,7444],{"class":60},[50,13897,13826],{"class":1221},[50,13899,7449],{"class":60},[50,13901,13902],{"class":1221}," Finished: stg.orders (",[50,13904,13905],{"class":2006},"57ms",[50,13907,1349],{"class":1221},[50,13909,13910,13912,13914,13916,13919,13922],{"class":52,"line":359},[50,13911,7444],{"class":60},[50,13913,13826],{"class":1221},[50,13915,7449],{"class":60},[50,13917,13918],{"class":1221}," Finished: stg.order_items (",[50,13920,13921],{"class":2006},"78ms",[50,13923,1349],{"class":1221},[50,13925,13926,13928,13930,13932,13935,13938],{"class":52,"line":367},[50,13927,7444],{"class":60},[50,13929,13826],{"class":1221},[50,13931,7449],{"class":60},[50,13933,13934],{"class":1221}," Finished: stg.customers (",[50,13936,13937],{"class":2006},"101ms",[50,13939,1349],{"class":1221},[50,13941,13942,13944,13946,13948,13951,13954],{"class":52,"line":374},[50,13943,7444],{"class":60},[50,13945,13826],{"class":1221},[50,13947,7449],{"class":60},[50,13949,13950],{"class":1221}," Finished: stg.product_variants (",[50,13952,13953],{"class":2006},"89ms",[50,13955,1349],{"class":1221},[50,13957,13958,13960,13962,13964],{"class":52,"line":382},[50,13959,7444],{"class":60},[50,13961,13826],{"class":1221},[50,13963,7449],{"class":60},[50,13965,13966],{"class":1221}," Running:  stg.product_variants:custom-check:validate_product_variant_sizes\n",[50,13968,13969,13971,13973,13975,13978,13981],{"class":52,"line":390},[50,13970,7444],{"class":60},[50,13972,13826],{"class":1221},[50,13974,7449],{"class":60},[50,13976,13977],{"class":1221}," Finished: stg.product_variants:custom-check:validate_product_variant_sizes (",[50,13979,13980],{"class":2006},"6ms",[50,13982,1349],{"class":1221},[50,13984,13985],{"class":52,"line":400},[50,13986,371],{"emptyLinePlaceholder":370},[50,13988,13989],{"class":52,"line":408},[50,13990,13991],{"class":63},"==================================================\n",[50,13993,13994],{"class":52,"line":416},[50,13995,371],{"emptyLinePlaceholder":370},[50,13997,13998,14000,14003],{"class":52,"line":427},[50,13999,9628],{"class":2006},[50,14001,14002],{"class":63}," stg.products",[50,14004,9634],{"class":1221},[50,14006,14007,14009,14012],{"class":52,"line":438},[50,14008,9628],{"class":2006},[50,14010,14011],{"class":63}," stg.orders",[50,14013,9634],{"class":1221},[50,14015,14016,14018,14021],{"class":52,"line":450},[50,14017,9628],{"class":2006},[50,14019,14020],{"class":63}," stg.order_items",[50,14022,9634],{"class":1221},[50,14024,14025,14027,14030],{"class":52,"line":461},[50,14026,9628],{"class":2006},[50,14028,14029],{"class":63}," stg.customers",[50,14031,9634],{"class":1221},[50,14033,14034,14036,14039],{"class":52,"line":469},[50,14035,9628],{"class":2006},[50,14037,14038],{"class":63}," stg.product_variants",[50,14040,14041],{"class":63}," .\n",[50,14043,14044],{"class":52,"line":482},[50,14045,371],{"emptyLinePlaceholder":370},[50,14047,14048],{"class":52,"line":494},[50,14049,371],{"emptyLinePlaceholder":370},[50,14051,14052,14054,14056,14058,14060,14062],{"class":52,"line":502},[50,14053,2034],{"class":2006},[50,14055,3106],{"class":63},[50,14057,9683],{"class":63},[50,14059,9686],{"class":63},[50,14061,9689],{"class":63},[50,14063,14064],{"class":63}," 125ms\n",[50,14066,14067],{"class":52,"line":512},[50,14068,371],{"emptyLinePlaceholder":370},[50,14070,14071,14073,14075,14077,14079],{"class":52,"line":522},[50,14072,9701],{"class":2006},[50,14074,9704],{"class":63},[50,14076,9707],{"class":63},[50,14078,9710],{"class":154},[50,14080,9713],{"class":63},[50,14082,14083,14085,14088,14091,14094],{"class":52,"line":532},[50,14084,9701],{"class":2006},[50,14086,14087],{"class":63}," Quality",[50,14089,14090],{"class":63}," checks",[50,14092,14093],{"class":154},"       1",[50,14095,9713],{"class":63},[32,14097,14098],{},"Each asset runs its quality checks alongside transformations, keeping data accurate at every step. You can reuse validation rules across assets, add business context through glossaries, and rely on incremental checks that catch issues early.",[1917,14100,14102],{"id":14101},"_8-designing-your-analytics-layer-mart","8) Designing Your Analytics Layer (Mart)",[32,14104,14105],{},"The analytics (mart) layer turns curated staging tables into business-ready, well-structured datasets. Here we define models with a clear grain, apply final business rules, and expose KPIs for decision-making. These models typically power dashboards and self-service exploration.",[32,14107,14108],{},"Just like in the Raw and Staging sections above, below is a code tree that shows how the mart is structured in our orders-performance pipeline. Each model consumes stg.* tables and produces clean, documented outputs.",[36,14110,14112,14545,14989,15562,15787],{"default-value":14111},"mart.sales_daily.asset.sql",[40,14113,14115],{"className":1139,"code":14114,"filename":14111,"language":1142,"meta":45,"style":45},"/* @bruin\n\nname: mart.sales_daily\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: append\n\ndepends:\n  - stg.order_items\n  - stg.orders\n\ncolumns:\n  - name: sale_date\n    type: date\n    checks:\n      - name: not_null\n  - name: orders_count\n    type: integer\n    checks:\n      - name: not_null\n  - name: items_count\n    type: integer\n    checks:\n      - name: not_null\n  - name: revenue\n    type: numeric\n    checks:\n      - name: not_null\n\ncustom_checks:\n  - name: total revenue non-negative\n    value: 0\n    query: SELECT COUNT(*) FROM mart.sales_daily WHERE revenue \u003C 0\n\n@bruin */\n\nWITH daily_orders AS (SELECT CAST(CAST(order_date AS TIMESTAMP) AS DATE)                               AS sale_date,\n                             COUNT(*)                                                                  AS orders_count,\n                             SUM(CASE WHEN status IN ('paid', 'shipped') THEN total_amount ELSE 0 END) AS revenue\n                      FROM stg.orders\n                      GROUP BY 1),\n     daily_items AS (SELECT CAST(CAST(o.order_date AS TIMESTAMP) AS DATE) AS sale_date,\n                            COUNT(*)                                      AS items_count\n                     FROM stg.order_items oi\n                            JOIN stg.orders o ON o.order_id = oi.order_id\n                     GROUP BY 1)\nSELECT d.sale_date,\n       d.orders_count,\n       COALESCE(i.items_count, 0) AS items_count,\n       d.revenue\nFROM daily_orders d\nORDER BY sale_date;\n",[47,14116,14117,14121,14125,14130,14134,14138,14142,14146,14151,14155,14159,14163,14167,14171,14175,14180,14185,14189,14193,14198,14202,14206,14210,14215,14219,14223,14227,14232,14237,14241,14245,14249,14253,14258,14262,14267,14271,14275,14279,14323,14340,14396,14404,14413,14449,14466,14473,14488,14497,14504,14509,14526,14531,14538],{"__ignoreMap":45},[50,14118,14119],{"class":52,"line":53},[50,14120,1149],{"class":950},[50,14122,14123],{"class":52,"line":67},[50,14124,371],{"emptyLinePlaceholder":370},[50,14126,14127],{"class":52,"line":76},[50,14128,14129],{"class":950},"name: mart.sales_daily\n",[50,14131,14132],{"class":52,"line":84},[50,14133,1159],{"class":950},[50,14135,14136],{"class":52,"line":92},[50,14137,371],{"emptyLinePlaceholder":370},[50,14139,14140],{"class":52,"line":100},[50,14141,1179],{"class":950},[50,14143,14144],{"class":52,"line":114},[50,14145,1184],{"class":950},[50,14147,14148],{"class":52,"line":125},[50,14149,14150],{"class":950},"  strategy: append\n",[50,14152,14153],{"class":52,"line":135},[50,14154,371],{"emptyLinePlaceholder":370},[50,14156,14157],{"class":52,"line":146},[50,14158,1194],{"class":950},[50,14160,14161],{"class":52,"line":158},[50,14162,1456],{"class":950},[50,14164,14165],{"class":52,"line":168},[50,14166,1461],{"class":950},[50,14168,14169],{"class":52,"line":176},[50,14170,371],{"emptyLinePlaceholder":370},[50,14172,14173],{"class":52,"line":188},[50,14174,9798],{"class":950},[50,14176,14177],{"class":52,"line":316},[50,14178,14179],{"class":950},"  - name: sale_date\n",[50,14181,14182],{"class":52,"line":324},[50,14183,14184],{"class":950},"    type: date\n",[50,14186,14187],{"class":52,"line":334},[50,14188,12994],{"class":950},[50,14190,14191],{"class":52,"line":341},[50,14192,13006],{"class":950},[50,14194,14195],{"class":52,"line":352},[50,14196,14197],{"class":950},"  - name: orders_count\n",[50,14199,14200],{"class":52,"line":359},[50,14201,12982],{"class":950},[50,14203,14204],{"class":52,"line":367},[50,14205,12994],{"class":950},[50,14207,14208],{"class":52,"line":374},[50,14209,13006],{"class":950},[50,14211,14212],{"class":52,"line":382},[50,14213,14214],{"class":950},"  - name: items_count\n",[50,14216,14217],{"class":52,"line":390},[50,14218,12982],{"class":950},[50,14220,14221],{"class":52,"line":400},[50,14222,12994],{"class":950},[50,14224,14225],{"class":52,"line":408},[50,14226,13006],{"class":950},[50,14228,14229],{"class":52,"line":416},[50,14230,14231],{"class":950},"  - name: revenue\n",[50,14233,14234],{"class":52,"line":427},[50,14235,14236],{"class":950},"    type: numeric\n",[50,14238,14239],{"class":52,"line":438},[50,14240,12994],{"class":950},[50,14242,14243],{"class":52,"line":450},[50,14244,13006],{"class":950},[50,14246,14247],{"class":52,"line":461},[50,14248,371],{"emptyLinePlaceholder":370},[50,14250,14251],{"class":52,"line":469},[50,14252,10171],{"class":950},[50,14254,14255],{"class":52,"line":482},[50,14256,14257],{"class":950},"  - name: total revenue non-negative\n",[50,14259,14260],{"class":52,"line":494},[50,14261,10196],{"class":950},[50,14263,14264],{"class":52,"line":502},[50,14265,14266],{"class":950},"    query: SELECT COUNT(*) FROM mart.sales_daily WHERE revenue \u003C 0\n",[50,14268,14269],{"class":52,"line":512},[50,14270,371],{"emptyLinePlaceholder":370},[50,14272,14273],{"class":52,"line":522},[50,14274,1209],{"class":950},[50,14276,14277],{"class":52,"line":532},[50,14278,371],{"emptyLinePlaceholder":370},[50,14280,14281,14283,14286,14288,14290,14292,14295,14297,14300,14303,14305,14308,14310,14312,14315,14318,14320],{"class":52,"line":539},[50,14282,1218],{"class":154},[50,14284,14285],{"class":1221}," daily_orders ",[50,14287,1225],{"class":154},[50,14289,1531],{"class":1221},[50,14291,1354],{"class":154},[50,14293,14294],{"class":1362}," CAST",[50,14296,1366],{"class":1221},[50,14298,14299],{"class":1362},"CAST",[50,14301,14302],{"class":1221},"(order_date ",[50,14304,1225],{"class":154},[50,14306,14307],{"class":1815}," TIMESTAMP",[50,14309,1372],{"class":1221},[50,14311,1225],{"class":154},[50,14313,14314],{"class":1815}," DATE",[50,14316,14317],{"class":1221},")                               ",[50,14319,1225],{"class":154},[50,14321,14322],{"class":1221}," sale_date,\n",[50,14324,14325,14328,14330,14332,14335,14337],{"class":52,"line":550},[50,14326,14327],{"class":1362},"                             COUNT",[50,14329,1366],{"class":1221},[50,14331,1369],{"class":60},[50,14333,14334],{"class":1221},")                                                                  ",[50,14336,1225],{"class":154},[50,14338,14339],{"class":1221}," orders_count,\n",[50,14341,14342,14345,14347,14350,14352,14355,14357,14359,14361,14363,14365,14367,14369,14371,14373,14375,14378,14381,14384,14386,14389,14391,14393],{"class":52,"line":558},[50,14343,14344],{"class":1362},"                             SUM",[50,14346,1366],{"class":1221},[50,14348,14349],{"class":154},"CASE",[50,14351,1671],{"class":154},[50,14353,14354],{"class":154}," status",[50,14356,13655],{"class":154},[50,14358,1531],{"class":1221},[50,14360,1534],{"class":60},[50,14362,1537],{"class":63},[50,14364,1534],{"class":60},[50,14366,2140],{"class":1221},[50,14368,1534],{"class":60},[50,14370,1547],{"class":63},[50,14372,1534],{"class":60},[50,14374,1372],{"class":1221},[50,14376,14377],{"class":154},"THEN",[50,14379,14380],{"class":1221}," total_amount ",[50,14382,14383],{"class":154},"ELSE",[50,14385,1681],{"class":154},[50,14387,14388],{"class":154}," END",[50,14390,1372],{"class":1221},[50,14392,1225],{"class":154},[50,14394,14395],{"class":1221}," revenue\n",[50,14397,14398,14401],{"class":52,"line":568},[50,14399,14400],{"class":154},"                      FROM",[50,14402,14403],{"class":1221}," stg.orders\n",[50,14405,14406,14409,14411],{"class":52,"line":577},[50,14407,14408],{"class":154},"                      GROUP BY",[50,14410,947],{"class":154},[50,14412,1556],{"class":1221},[50,14414,14415,14418,14420,14422,14424,14426,14428,14430,14433,14435,14437,14439,14441,14443,14445,14447],{"class":52,"line":587},[50,14416,14417],{"class":1221},"     daily_items ",[50,14419,1225],{"class":154},[50,14421,1531],{"class":1221},[50,14423,1354],{"class":154},[50,14425,14294],{"class":1362},[50,14427,1366],{"class":1221},[50,14429,14299],{"class":1362},[50,14431,14432],{"class":1221},"(o.order_date ",[50,14434,1225],{"class":154},[50,14436,14307],{"class":1815},[50,14438,1372],{"class":1221},[50,14440,1225],{"class":154},[50,14442,14314],{"class":1815},[50,14444,1372],{"class":1221},[50,14446,1225],{"class":154},[50,14448,14322],{"class":1221},[50,14450,14451,14454,14456,14458,14461,14463],{"class":52,"line":594},[50,14452,14453],{"class":1362},"                            COUNT",[50,14455,1366],{"class":1221},[50,14457,1369],{"class":60},[50,14459,14460],{"class":1221},")                                      ",[50,14462,1225],{"class":154},[50,14464,14465],{"class":1221}," items_count\n",[50,14467,14468,14471],{"class":52,"line":605},[50,14469,14470],{"class":154},"                     FROM",[50,14472,1497],{"class":1221},[50,14474,14475,14478,14480,14482,14484,14486],{"class":52,"line":613},[50,14476,14477],{"class":154},"                            JOIN",[50,14479,1505],{"class":1221},[50,14481,1508],{"class":154},[50,14483,1511],{"class":1221},[50,14485,1514],{"class":60},[50,14487,1517],{"class":1221},[50,14489,14490,14493,14495],{"class":52,"line":623},[50,14491,14492],{"class":154},"                     GROUP BY",[50,14494,947],{"class":154},[50,14496,1349],{"class":1221},[50,14498,14499,14501],{"class":52,"line":631},[50,14500,1354],{"class":154},[50,14502,14503],{"class":1221}," d.sale_date,\n",[50,14505,14506],{"class":52,"line":639},[50,14507,14508],{"class":1221},"       d.orders_count,\n",[50,14510,14511,14514,14517,14519,14521,14523],{"class":52,"line":646},[50,14512,14513],{"class":1362},"       COALESCE",[50,14515,14516],{"class":1221},"(i.items_count, ",[50,14518,1879],{"class":154},[50,14520,1372],{"class":1221},[50,14522,1225],{"class":154},[50,14524,14525],{"class":1221}," items_count,\n",[50,14527,14528],{"class":52,"line":653},[50,14529,14530],{"class":1221},"       d.revenue\n",[50,14532,14533,14535],{"class":52,"line":663},[50,14534,1382],{"class":154},[50,14536,14537],{"class":1221}," daily_orders d\n",[50,14539,14540,14542],{"class":52,"line":672},[50,14541,1397],{"class":154},[50,14543,14544],{"class":1221}," sale_date;\n",[40,14546,14549],{"className":1139,"code":14547,"filename":14548,"language":1142,"meta":45,"style":45},"/* @bruin\n\nname: mart.product_performance\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.products\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n\ncolumns:\n  - name: product_id\n    type: BIGINT\n    checks:\n      - name: not_null\n  - name: product_name\n    type: VARCHAR\n    checks:\n      - name: not_null\n  - name: category\n    type: VARCHAR\n    checks:\n      - name: not_null\n  - name: items_sold\n    type: HUGEINT\n    checks:\n      - name: not_null\n  - name: gross_revenue\n    type: DECIMAL(38,2)\n    checks:\n      - name: not_null\n  - name: avg_item_price\n    type: DOUBLE\n    checks:\n      - name: not_null\n\ncustom_checks:\n  - name: no negative prices or revenue\n    value: 0\n    query: SELECT COUNT(*) FROM mart.product_performance WHERE avg_item_price \u003C 0 OR gross_revenue \u003C 0\n\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n), items_with_product AS (\n  SELECT\n    v.product_id,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n)\nSELECT\n  p.product_id,\n  p.name AS product_name,\n  p.category,\n  SUM(i.quantity) AS items_sold,\n  SUM(i.total_price) AS gross_revenue,\n  CASE WHEN SUM(i.quantity) = 0 THEN 0 ELSE SUM(i.total_price) / SUM(i.quantity) END AS avg_item_price\nFROM items_with_product i\nJOIN stg.products p ON p.product_id = i.product_id\nGROUP BY 1,2,3\nORDER BY gross_revenue DESC;\n","mart.product_performance.asset.sql",[47,14550,14551,14555,14559,14563,14567,14571,14575,14579,14583,14587,14591,14595,14599,14603,14607,14611,14615,14620,14625,14629,14633,14638,14643,14647,14651,14656,14660,14664,14668,14673,14678,14682,14686,14691,14696,14700,14704,14709,14714,14718,14722,14726,14730,14735,14739,14744,14748,14752,14756,14766,14774,14780,14794,14820,14829,14833,14837,14841,14845,14851,14865,14869,14873,14877,14885,14889,14899,14909,14945,14951,14965,14979],{"__ignoreMap":45},[50,14552,14553],{"class":52,"line":53},[50,14554,1149],{"class":950},[50,14556,14557],{"class":52,"line":67},[50,14558,371],{"emptyLinePlaceholder":370},[50,14560,14561],{"class":52,"line":76},[50,14562,1421],{"class":950},[50,14564,14565],{"class":52,"line":84},[50,14566,1159],{"class":950},[50,14568,14569],{"class":52,"line":92},[50,14570,371],{"emptyLinePlaceholder":370},[50,14572,14573],{"class":52,"line":100},[50,14574,1179],{"class":950},[50,14576,14577],{"class":52,"line":114},[50,14578,1184],{"class":950},[50,14580,14581],{"class":52,"line":125},[50,14582,1189],{"class":950},[50,14584,14585],{"class":52,"line":135},[50,14586,371],{"emptyLinePlaceholder":370},[50,14588,14589],{"class":52,"line":146},[50,14590,1194],{"class":950},[50,14592,14593],{"class":52,"line":158},[50,14594,1446],{"class":950},[50,14596,14597],{"class":52,"line":168},[50,14598,1451],{"class":950},[50,14600,14601],{"class":52,"line":176},[50,14602,1456],{"class":950},[50,14604,14605],{"class":52,"line":188},[50,14606,1461],{"class":950},[50,14608,14609],{"class":52,"line":316},[50,14610,371],{"emptyLinePlaceholder":370},[50,14612,14613],{"class":52,"line":324},[50,14614,9798],{"class":950},[50,14616,14617],{"class":52,"line":334},[50,14618,14619],{"class":950},"  - name: product_id\n",[50,14621,14622],{"class":52,"line":341},[50,14623,14624],{"class":950},"    type: BIGINT\n",[50,14626,14627],{"class":52,"line":352},[50,14628,12994],{"class":950},[50,14630,14631],{"class":52,"line":359},[50,14632,13006],{"class":950},[50,14634,14635],{"class":52,"line":367},[50,14636,14637],{"class":950},"  - name: product_name\n",[50,14639,14640],{"class":52,"line":374},[50,14641,14642],{"class":950},"    type: VARCHAR\n",[50,14644,14645],{"class":52,"line":382},[50,14646,12994],{"class":950},[50,14648,14649],{"class":52,"line":390},[50,14650,13006],{"class":950},[50,14652,14653],{"class":52,"line":400},[50,14654,14655],{"class":950},"  - name: category\n",[50,14657,14658],{"class":52,"line":408},[50,14659,14642],{"class":950},[50,14661,14662],{"class":52,"line":416},[50,14663,12994],{"class":950},[50,14665,14666],{"class":52,"line":427},[50,14667,13006],{"class":950},[50,14669,14670],{"class":52,"line":438},[50,14671,14672],{"class":950},"  - name: items_sold\n",[50,14674,14675],{"class":52,"line":450},[50,14676,14677],{"class":950},"    type: HUGEINT\n",[50,14679,14680],{"class":52,"line":461},[50,14681,12994],{"class":950},[50,14683,14684],{"class":52,"line":469},[50,14685,13006],{"class":950},[50,14687,14688],{"class":52,"line":482},[50,14689,14690],{"class":950},"  - name: gross_revenue\n",[50,14692,14693],{"class":52,"line":494},[50,14694,14695],{"class":950},"    type: DECIMAL(38,2)\n",[50,14697,14698],{"class":52,"line":502},[50,14699,12994],{"class":950},[50,14701,14702],{"class":52,"line":512},[50,14703,13006],{"class":950},[50,14705,14706],{"class":52,"line":522},[50,14707,14708],{"class":950},"  - name: avg_item_price\n",[50,14710,14711],{"class":52,"line":532},[50,14712,14713],{"class":950},"    type: DOUBLE\n",[50,14715,14716],{"class":52,"line":539},[50,14717,12994],{"class":950},[50,14719,14720],{"class":52,"line":550},[50,14721,13006],{"class":950},[50,14723,14724],{"class":52,"line":558},[50,14725,371],{"emptyLinePlaceholder":370},[50,14727,14728],{"class":52,"line":568},[50,14729,10171],{"class":950},[50,14731,14732],{"class":52,"line":577},[50,14733,14734],{"class":950},"  - name: no negative prices or revenue\n",[50,14736,14737],{"class":52,"line":587},[50,14738,10196],{"class":950},[50,14740,14741],{"class":52,"line":594},[50,14742,14743],{"class":950},"    query: SELECT COUNT(*) FROM mart.product_performance WHERE avg_item_price \u003C 0 OR gross_revenue \u003C 0\n",[50,14745,14746],{"class":52,"line":605},[50,14747,371],{"emptyLinePlaceholder":370},[50,14749,14750],{"class":52,"line":613},[50,14751,1209],{"class":950},[50,14753,14754],{"class":52,"line":623},[50,14755,371],{"emptyLinePlaceholder":370},[50,14757,14758,14760,14762,14764],{"class":52,"line":631},[50,14759,1218],{"class":154},[50,14761,1476],{"class":1221},[50,14763,1225],{"class":154},[50,14765,1228],{"class":1221},[50,14767,14768,14770,14772],{"class":52,"line":639},[50,14769,1233],{"class":154},[50,14771,1487],{"class":1221},[50,14773,1490],{"class":60},[50,14775,14776,14778],{"class":52,"line":646},[50,14777,1341],{"class":154},[50,14779,1497],{"class":1221},[50,14781,14782,14784,14786,14788,14790,14792],{"class":52,"line":653},[50,14783,1502],{"class":154},[50,14785,1505],{"class":1221},[50,14787,1508],{"class":154},[50,14789,1511],{"class":1221},[50,14791,1514],{"class":60},[50,14793,1517],{"class":1221},[50,14795,14796,14798,14800,14802,14804,14806,14808,14810,14812,14814,14816,14818],{"class":52,"line":663},[50,14797,1522],{"class":154},[50,14799,1525],{"class":1221},[50,14801,1528],{"class":154},[50,14803,1531],{"class":1221},[50,14805,1534],{"class":60},[50,14807,1537],{"class":63},[50,14809,1534],{"class":60},[50,14811,1542],{"class":1221},[50,14813,1534],{"class":60},[50,14815,1547],{"class":63},[50,14817,1534],{"class":60},[50,14819,1349],{"class":1221},[50,14821,14822,14825,14827],{"class":52,"line":672},[50,14823,14824],{"class":1221},"), items_with_product ",[50,14826,1225],{"class":154},[50,14828,1228],{"class":1221},[50,14830,14831],{"class":52,"line":679},[50,14832,1570],{"class":154},[50,14834,14835],{"class":52,"line":690},[50,14836,1575],{"class":1221},[50,14838,14839],{"class":52,"line":701},[50,14840,1580],{"class":1221},[50,14842,14843],{"class":52,"line":709},[50,14844,1585],{"class":1221},[50,14846,14847,14849],{"class":52,"line":719},[50,14848,1341],{"class":154},[50,14850,1592],{"class":1221},[50,14852,14853,14855,14857,14859,14861,14863],{"class":52,"line":729},[50,14854,1502],{"class":154},[50,14856,1599],{"class":1221},[50,14858,1508],{"class":154},[50,14860,1604],{"class":1221},[50,14862,1514],{"class":60},[50,14864,1609],{"class":1221},[50,14866,14867],{"class":52,"line":736},[50,14868,1349],{"class":1221},[50,14870,14871],{"class":52,"line":747},[50,14872,1618],{"class":154},[50,14874,14875],{"class":52,"line":755},[50,14876,1623],{"class":1221},[50,14878,14879,14881,14883],{"class":52,"line":765},[50,14880,1628],{"class":1221},[50,14882,1225],{"class":154},[50,14884,1633],{"class":1221},[50,14886,14887],{"class":52,"line":774},[50,14888,1638],{"class":1221},[50,14890,14891,14893,14895,14897],{"class":52,"line":782},[50,14892,1643],{"class":1362},[50,14894,1646],{"class":1221},[50,14896,1225],{"class":154},[50,14898,1651],{"class":1221},[50,14900,14901,14903,14905,14907],{"class":52,"line":792},[50,14902,1643],{"class":1362},[50,14904,1658],{"class":1221},[50,14906,1225],{"class":154},[50,14908,1663],{"class":1221},[50,14910,14911,14913,14915,14917,14919,14921,14923,14925,14927,14929,14931,14933,14935,14937,14939,14941,14943],{"class":52,"line":801},[50,14912,1668],{"class":154},[50,14914,1671],{"class":154},[50,14916,1674],{"class":1362},[50,14918,1646],{"class":1221},[50,14920,1514],{"class":60},[50,14922,1681],{"class":154},[50,14924,1253],{"class":154},[50,14926,1681],{"class":154},[50,14928,1688],{"class":154},[50,14930,1674],{"class":1362},[50,14932,1658],{"class":1221},[50,14934,1695],{"class":60},[50,14936,1674],{"class":1362},[50,14938,1646],{"class":1221},[50,14940,1702],{"class":154},[50,14942,1333],{"class":154},[50,14944,1707],{"class":1221},[50,14946,14947,14949],{"class":52,"line":809},[50,14948,1382],{"class":154},[50,14950,1714],{"class":1221},[50,14952,14953,14955,14957,14959,14961,14963],{"class":52,"line":819},[50,14954,1719],{"class":154},[50,14956,1722],{"class":1221},[50,14958,1508],{"class":154},[50,14960,1727],{"class":1221},[50,14962,1514],{"class":60},[50,14964,1732],{"class":1221},[50,14966,14967,14969,14971,14973,14975,14977],{"class":52,"line":828},[50,14968,1390],{"class":154},[50,14970,947],{"class":154},[50,14972,1542],{"class":1221},[50,14974,1743],{"class":154},[50,14976,1542],{"class":1221},[50,14978,1748],{"class":154},[50,14980,14981,14983,14985,14987],{"class":52,"line":835},[50,14982,1397],{"class":154},[50,14984,1755],{"class":1221},[50,14986,1403],{"class":154},[50,14988,1406],{"class":1221},[40,14990,14993],{"className":1139,"code":14991,"filename":14992,"language":1142,"meta":45,"style":45},"/* @bruin\n\nname: mart.variant_profitability\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.product_variants\n  - stg.order_items\n  - stg.orders\n  - stg.products\n\ncolumns:\n  - name: variant_id\n    type: integer\n    checks:\n      - name: not_null\n      - name: unique\n  - name: variant_sku\n    type: string\n    checks:\n      - name: not_null\n  - name: product_id\n    type: integer\n    checks:\n      - name: not_null\n  - name: items_sold\n    type: integer\n    checks:\n      - name: not_null\n  - name: revenue\n    type: numeric\n    checks:\n      - name: not_null\n  - name: cost\n    type: numeric\n    checks:\n      - name: not_null\n  - name: profit\n    type: numeric\n    checks:\n      - name: not_null\n  - name: margin_pct\n    type: numeric\n    checks:\n      - name: not_null\n\n@bruin */\n\nWITH paid_items AS (\n  SELECT oi.*\n  FROM stg.order_items oi\n  JOIN stg.orders o ON o.order_id = oi.order_id\n  WHERE o.status IN ('paid','shipped')\n), joined AS (\n  SELECT\n    v.variant_id,\n    p.name as product_name,\n    v.variant_sku,\n    v.product_id,\n    v.manufacturing_price,\n    v.selling_price,\n    oi.quantity,\n    oi.total_price\n  FROM paid_items oi\n  JOIN stg.product_variants v ON v.variant_id = oi.variant_id\n  JOIN stg.products p ON p.product_id = v.product_id\n)\nSELECT\n    j.product_name,\n  j.variant_id,\n  j.variant_sku,\n  j.product_id,\n  SUM(j.quantity) AS items_sold,\n  SUM(j.total_price) AS revenue,\n  SUM(j.quantity * j.manufacturing_price) AS cost,\n  SUM(j.total_price) - SUM(j.quantity * j.manufacturing_price) AS profit,\n  CASE WHEN SUM(j.total_price) = 0 THEN 0\n       ELSE (SUM(j.total_price) - SUM(j.quantity * j.manufacturing_price)) / SUM(j.total_price)\n  END AS margin_pct,\n  BOOL_OR(j.selling_price \u003C j.manufacturing_price) AS selling_price_below_cost\nFROM joined j\nGROUP BY 1,2,3,4\nORDER BY profit DESC;\n","mart.variant_profitability.asset.sql",[47,14994,14995,14999,15003,15008,15012,15016,15020,15024,15028,15032,15036,15040,15044,15048,15052,15056,15060,15065,15069,15073,15077,15081,15086,15091,15095,15099,15103,15107,15111,15115,15119,15123,15127,15131,15135,15139,15143,15147,15152,15156,15160,15164,15169,15173,15177,15181,15186,15190,15194,15198,15202,15206,15210,15220,15228,15234,15248,15274,15283,15287,15292,15302,15307,15311,15316,15321,15325,15329,15335,15349,15363,15367,15371,15376,15381,15386,15391,15402,15414,15431,15452,15470,15500,15510,15524,15531,15551],{"__ignoreMap":45},[50,14996,14997],{"class":52,"line":53},[50,14998,1149],{"class":950},[50,15000,15001],{"class":52,"line":67},[50,15002,371],{"emptyLinePlaceholder":370},[50,15004,15005],{"class":52,"line":76},[50,15006,15007],{"class":950},"name: mart.variant_profitability\n",[50,15009,15010],{"class":52,"line":84},[50,15011,1159],{"class":950},[50,15013,15014],{"class":52,"line":92},[50,15015,371],{"emptyLinePlaceholder":370},[50,15017,15018],{"class":52,"line":100},[50,15019,1179],{"class":950},[50,15021,15022],{"class":52,"line":114},[50,15023,1184],{"class":950},[50,15025,15026],{"class":52,"line":125},[50,15027,1189],{"class":950},[50,15029,15030],{"class":52,"line":135},[50,15031,371],{"emptyLinePlaceholder":370},[50,15033,15034],{"class":52,"line":146},[50,15035,1194],{"class":950},[50,15037,15038],{"class":52,"line":158},[50,15039,1451],{"class":950},[50,15041,15042],{"class":52,"line":168},[50,15043,1456],{"class":950},[50,15045,15046],{"class":52,"line":176},[50,15047,1461],{"class":950},[50,15049,15050],{"class":52,"line":188},[50,15051,1446],{"class":950},[50,15053,15054],{"class":52,"line":316},[50,15055,371],{"emptyLinePlaceholder":370},[50,15057,15058],{"class":52,"line":324},[50,15059,9798],{"class":950},[50,15061,15062],{"class":52,"line":334},[50,15063,15064],{"class":950},"  - name: variant_id\n",[50,15066,15067],{"class":52,"line":341},[50,15068,12982],{"class":950},[50,15070,15071],{"class":52,"line":352},[50,15072,12994],{"class":950},[50,15074,15075],{"class":52,"line":359},[50,15076,13006],{"class":950},[50,15078,15079],{"class":52,"line":367},[50,15080,13000],{"class":950},[50,15082,15083],{"class":52,"line":374},[50,15084,15085],{"class":950},"  - name: variant_sku\n",[50,15087,15088],{"class":52,"line":382},[50,15089,15090],{"class":950},"    type: string\n",[50,15092,15093],{"class":52,"line":390},[50,15094,12994],{"class":950},[50,15096,15097],{"class":52,"line":400},[50,15098,13006],{"class":950},[50,15100,15101],{"class":52,"line":408},[50,15102,14619],{"class":950},[50,15104,15105],{"class":52,"line":416},[50,15106,12982],{"class":950},[50,15108,15109],{"class":52,"line":427},[50,15110,12994],{"class":950},[50,15112,15113],{"class":52,"line":438},[50,15114,13006],{"class":950},[50,15116,15117],{"class":52,"line":450},[50,15118,14672],{"class":950},[50,15120,15121],{"class":52,"line":461},[50,15122,12982],{"class":950},[50,15124,15125],{"class":52,"line":469},[50,15126,12994],{"class":950},[50,15128,15129],{"class":52,"line":482},[50,15130,13006],{"class":950},[50,15132,15133],{"class":52,"line":494},[50,15134,14231],{"class":950},[50,15136,15137],{"class":52,"line":502},[50,15138,14236],{"class":950},[50,15140,15141],{"class":52,"line":512},[50,15142,12994],{"class":950},[50,15144,15145],{"class":52,"line":522},[50,15146,13006],{"class":950},[50,15148,15149],{"class":52,"line":532},[50,15150,15151],{"class":950},"  - name: cost\n",[50,15153,15154],{"class":52,"line":539},[50,15155,14236],{"class":950},[50,15157,15158],{"class":52,"line":550},[50,15159,12994],{"class":950},[50,15161,15162],{"class":52,"line":558},[50,15163,13006],{"class":950},[50,15165,15166],{"class":52,"line":568},[50,15167,15168],{"class":950},"  - name: profit\n",[50,15170,15171],{"class":52,"line":577},[50,15172,14236],{"class":950},[50,15174,15175],{"class":52,"line":587},[50,15176,12994],{"class":950},[50,15178,15179],{"class":52,"line":594},[50,15180,13006],{"class":950},[50,15182,15183],{"class":52,"line":605},[50,15184,15185],{"class":950},"  - name: margin_pct\n",[50,15187,15188],{"class":52,"line":613},[50,15189,14236],{"class":950},[50,15191,15192],{"class":52,"line":623},[50,15193,12994],{"class":950},[50,15195,15196],{"class":52,"line":631},[50,15197,13006],{"class":950},[50,15199,15200],{"class":52,"line":639},[50,15201,371],{"emptyLinePlaceholder":370},[50,15203,15204],{"class":52,"line":646},[50,15205,1209],{"class":950},[50,15207,15208],{"class":52,"line":653},[50,15209,371],{"emptyLinePlaceholder":370},[50,15211,15212,15214,15216,15218],{"class":52,"line":663},[50,15213,1218],{"class":154},[50,15215,1476],{"class":1221},[50,15217,1225],{"class":154},[50,15219,1228],{"class":1221},[50,15221,15222,15224,15226],{"class":52,"line":672},[50,15223,1233],{"class":154},[50,15225,1487],{"class":1221},[50,15227,1490],{"class":60},[50,15229,15230,15232],{"class":52,"line":679},[50,15231,1341],{"class":154},[50,15233,1497],{"class":1221},[50,15235,15236,15238,15240,15242,15244,15246],{"class":52,"line":690},[50,15237,1502],{"class":154},[50,15239,1505],{"class":1221},[50,15241,1508],{"class":154},[50,15243,1511],{"class":1221},[50,15245,1514],{"class":60},[50,15247,1517],{"class":1221},[50,15249,15250,15252,15254,15256,15258,15260,15262,15264,15266,15268,15270,15272],{"class":52,"line":701},[50,15251,1522],{"class":154},[50,15253,1525],{"class":1221},[50,15255,1528],{"class":154},[50,15257,1531],{"class":1221},[50,15259,1534],{"class":60},[50,15261,1537],{"class":63},[50,15263,1534],{"class":60},[50,15265,1542],{"class":1221},[50,15267,1534],{"class":60},[50,15269,1547],{"class":63},[50,15271,1534],{"class":60},[50,15273,1349],{"class":1221},[50,15275,15276,15279,15281],{"class":52,"line":709},[50,15277,15278],{"class":1221},"), joined ",[50,15280,1225],{"class":154},[50,15282,1228],{"class":1221},[50,15284,15285],{"class":52,"line":719},[50,15286,1570],{"class":154},[50,15288,15289],{"class":52,"line":729},[50,15290,15291],{"class":1221},"    v.variant_id,\n",[50,15293,15294,15297,15300],{"class":52,"line":736},[50,15295,15296],{"class":1221},"    p.name ",[50,15298,15299],{"class":154},"as",[50,15301,1633],{"class":1221},[50,15303,15304],{"class":52,"line":747},[50,15305,15306],{"class":1221},"    v.variant_sku,\n",[50,15308,15309],{"class":52,"line":755},[50,15310,1575],{"class":1221},[50,15312,15313],{"class":52,"line":765},[50,15314,15315],{"class":1221},"    v.manufacturing_price,\n",[50,15317,15318],{"class":52,"line":774},[50,15319,15320],{"class":1221},"    v.selling_price,\n",[50,15322,15323],{"class":52,"line":782},[50,15324,1580],{"class":1221},[50,15326,15327],{"class":52,"line":792},[50,15328,1585],{"class":1221},[50,15330,15331,15333],{"class":52,"line":801},[50,15332,1341],{"class":154},[50,15334,1592],{"class":1221},[50,15336,15337,15339,15341,15343,15345,15347],{"class":52,"line":809},[50,15338,1502],{"class":154},[50,15340,1599],{"class":1221},[50,15342,1508],{"class":154},[50,15344,1604],{"class":1221},[50,15346,1514],{"class":60},[50,15348,1609],{"class":1221},[50,15350,15351,15353,15355,15357,15359,15361],{"class":52,"line":819},[50,15352,1502],{"class":154},[50,15354,1722],{"class":1221},[50,15356,1508],{"class":154},[50,15358,1727],{"class":1221},[50,15360,1514],{"class":60},[50,15362,13594],{"class":1221},[50,15364,15365],{"class":52,"line":828},[50,15366,1349],{"class":1221},[50,15368,15369],{"class":52,"line":835},[50,15370,1618],{"class":154},[50,15372,15373],{"class":52,"line":847},[50,15374,15375],{"class":1221},"    j.product_name,\n",[50,15377,15378],{"class":52,"line":4131},[50,15379,15380],{"class":1221},"  j.variant_id,\n",[50,15382,15383],{"class":52,"line":4137},[50,15384,15385],{"class":1221},"  j.variant_sku,\n",[50,15387,15388],{"class":52,"line":4143},[50,15389,15390],{"class":1221},"  j.product_id,\n",[50,15392,15393,15395,15398,15400],{"class":52,"line":4149},[50,15394,1643],{"class":1362},[50,15396,15397],{"class":1221},"(j.quantity) ",[50,15399,1225],{"class":154},[50,15401,1651],{"class":1221},[50,15403,15404,15406,15409,15411],{"class":52,"line":4158},[50,15405,1643],{"class":1362},[50,15407,15408],{"class":1221},"(j.total_price) ",[50,15410,1225],{"class":154},[50,15412,15413],{"class":1221}," revenue,\n",[50,15415,15416,15418,15421,15423,15426,15428],{"class":52,"line":4171},[50,15417,1643],{"class":1362},[50,15419,15420],{"class":1221},"(j.quantity ",[50,15422,1369],{"class":60},[50,15424,15425],{"class":1221}," j.manufacturing_price) ",[50,15427,1225],{"class":154},[50,15429,15430],{"class":1221}," cost,\n",[50,15432,15433,15435,15437,15439,15441,15443,15445,15447,15449],{"class":52,"line":4177},[50,15434,1643],{"class":1362},[50,15436,15408],{"class":1221},[50,15438,5283],{"class":60},[50,15440,1674],{"class":1362},[50,15442,15420],{"class":1221},[50,15444,1369],{"class":60},[50,15446,15425],{"class":1221},[50,15448,1225],{"class":154},[50,15450,15451],{"class":1221}," profit,\n",[50,15453,15454,15456,15458,15460,15462,15464,15466,15468],{"class":52,"line":4182},[50,15455,1668],{"class":154},[50,15457,1671],{"class":154},[50,15459,1674],{"class":1362},[50,15461,15408],{"class":1221},[50,15463,1514],{"class":60},[50,15465,1681],{"class":154},[50,15467,1253],{"class":154},[50,15469,855],{"class":154},[50,15471,15472,15475,15477,15480,15482,15484,15486,15488,15490,15493,15495,15497],{"class":52,"line":4193},[50,15473,15474],{"class":154},"       ELSE",[50,15476,1531],{"class":1221},[50,15478,15479],{"class":1362},"SUM",[50,15481,15408],{"class":1221},[50,15483,5283],{"class":60},[50,15485,1674],{"class":1362},[50,15487,15420],{"class":1221},[50,15489,1369],{"class":60},[50,15491,15492],{"class":1221}," j.manufacturing_price)) ",[50,15494,1695],{"class":60},[50,15496,1674],{"class":1362},[50,15498,15499],{"class":1221},"(j.total_price)\n",[50,15501,15502,15505,15507],{"class":52,"line":4215},[50,15503,15504],{"class":154},"  END",[50,15506,1333],{"class":154},[50,15508,15509],{"class":1221}," margin_pct,\n",[50,15511,15512,15515,15517,15519,15521],{"class":52,"line":4236},[50,15513,15514],{"class":1221},"  BOOL_OR(j.selling_price ",[50,15516,1247],{"class":60},[50,15518,15425],{"class":1221},[50,15520,1225],{"class":154},[50,15522,15523],{"class":1221}," selling_price_below_cost\n",[50,15525,15526,15528],{"class":52,"line":4257},[50,15527,1382],{"class":154},[50,15529,15530],{"class":1221}," joined j\n",[50,15532,15533,15535,15537,15539,15541,15543,15546,15548],{"class":52,"line":4284},[50,15534,1390],{"class":154},[50,15536,947],{"class":154},[50,15538,1542],{"class":1221},[50,15540,1743],{"class":154},[50,15542,1542],{"class":1221},[50,15544,15545],{"class":154},"3",[50,15547,1542],{"class":1221},[50,15549,15550],{"class":154},"4\n",[50,15552,15553,15555,15558,15560],{"class":52,"line":4298},[50,15554,1397],{"class":154},[50,15556,15557],{"class":1221}," profit ",[50,15559,1403],{"class":154},[50,15561,1406],{"class":1221},[40,15563,15566],{"className":1139,"code":15564,"filename":15565,"language":1142,"meta":45,"style":45},"/* @bruin\n\nname: mart.customers_by_age\ntype: duckdb.sql\ntags:\n  - mart\n  - amazing-tag\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.customers\nowner: danielhe4rt@gmail.com\n\n@bruin */\n\nWITH src AS (SELECT CASE\n                        WHEN age \u003C 25 THEN '18-24'\n                        WHEN age BETWEEN 25 AND 34 THEN '25-34'\n                        WHEN age BETWEEN 35 AND 49 THEN '35-49'\n                        ELSE '50+'\n                        END AS age_group\n             FROM stg.customers)\nSELECT age_group,\n       COUNT(*) AS total_customers\nFROM src\nGROUP BY age_group\nORDER BY total_customers DESC;\n","mart.customers_by_age.asset.sql",[47,15567,15568,15572,15576,15580,15584,15588,15592,15596,15600,15604,15608,15612,15616,15620,15624,15628,15632,15636,15640,15654,15673,15695,15717,15728,15737,15745,15751,15765,15771,15777],{"__ignoreMap":45},[50,15569,15570],{"class":52,"line":53},[50,15571,1149],{"class":950},[50,15573,15574],{"class":52,"line":67},[50,15575,371],{"emptyLinePlaceholder":370},[50,15577,15578],{"class":52,"line":76},[50,15579,1154],{"class":950},[50,15581,15582],{"class":52,"line":84},[50,15583,1159],{"class":950},[50,15585,15586],{"class":52,"line":92},[50,15587,1164],{"class":950},[50,15589,15590],{"class":52,"line":100},[50,15591,1169],{"class":950},[50,15593,15594],{"class":52,"line":114},[50,15595,1174],{"class":950},[50,15597,15598],{"class":52,"line":125},[50,15599,371],{"emptyLinePlaceholder":370},[50,15601,15602],{"class":52,"line":135},[50,15603,1179],{"class":950},[50,15605,15606],{"class":52,"line":146},[50,15607,1184],{"class":950},[50,15609,15610],{"class":52,"line":158},[50,15611,1189],{"class":950},[50,15613,15614],{"class":52,"line":168},[50,15615,371],{"emptyLinePlaceholder":370},[50,15617,15618],{"class":52,"line":176},[50,15619,1194],{"class":950},[50,15621,15622],{"class":52,"line":188},[50,15623,1199],{"class":950},[50,15625,15626],{"class":52,"line":316},[50,15627,1204],{"class":950},[50,15629,15630],{"class":52,"line":324},[50,15631,371],{"emptyLinePlaceholder":370},[50,15633,15634],{"class":52,"line":334},[50,15635,1209],{"class":950},[50,15637,15638],{"class":52,"line":341},[50,15639,371],{"emptyLinePlaceholder":370},[50,15641,15642,15644,15646,15648,15650,15652],{"class":52,"line":352},[50,15643,1218],{"class":154},[50,15645,1222],{"class":1221},[50,15647,1225],{"class":154},[50,15649,1531],{"class":1221},[50,15651,1354],{"class":154},[50,15653,1236],{"class":154},[50,15655,15656,15659,15661,15663,15665,15667,15669,15671],{"class":52,"line":359},[50,15657,15658],{"class":154},"                        WHEN",[50,15660,1244],{"class":1221},[50,15662,1247],{"class":60},[50,15664,1250],{"class":154},[50,15666,1253],{"class":154},[50,15668,1256],{"class":60},[50,15670,1259],{"class":63},[50,15672,1262],{"class":60},[50,15674,15675,15677,15679,15681,15683,15685,15687,15689,15691,15693],{"class":52,"line":367},[50,15676,15658],{"class":154},[50,15678,1244],{"class":1221},[50,15680,1271],{"class":154},[50,15682,1250],{"class":154},[50,15684,1276],{"class":154},[50,15686,1279],{"class":154},[50,15688,1253],{"class":154},[50,15690,1256],{"class":60},[50,15692,1286],{"class":63},[50,15694,1262],{"class":60},[50,15696,15697,15699,15701,15703,15705,15707,15709,15711,15713,15715],{"class":52,"line":374},[50,15698,15658],{"class":154},[50,15700,1244],{"class":1221},[50,15702,1271],{"class":154},[50,15704,1299],{"class":154},[50,15706,1276],{"class":154},[50,15708,1304],{"class":154},[50,15710,1253],{"class":154},[50,15712,1256],{"class":60},[50,15714,1311],{"class":63},[50,15716,1262],{"class":60},[50,15718,15719,15722,15724,15726],{"class":52,"line":382},[50,15720,15721],{"class":154},"                        ELSE",[50,15723,1256],{"class":60},[50,15725,1323],{"class":63},[50,15727,1262],{"class":60},[50,15729,15730,15733,15735],{"class":52,"line":390},[50,15731,15732],{"class":154},"                        END",[50,15734,1333],{"class":154},[50,15736,1336],{"class":1221},[50,15738,15739,15742],{"class":52,"line":400},[50,15740,15741],{"class":154},"             FROM",[50,15743,15744],{"class":1221}," stg.customers)\n",[50,15746,15747,15749],{"class":52,"line":408},[50,15748,1354],{"class":154},[50,15750,1357],{"class":1221},[50,15752,15753,15755,15757,15759,15761,15763],{"class":52,"line":416},[50,15754,1363],{"class":1362},[50,15756,1366],{"class":1221},[50,15758,1369],{"class":60},[50,15760,1372],{"class":1221},[50,15762,1225],{"class":154},[50,15764,1377],{"class":1221},[50,15766,15767,15769],{"class":52,"line":427},[50,15768,1382],{"class":154},[50,15770,1385],{"class":1221},[50,15772,15773,15775],{"class":52,"line":438},[50,15774,1390],{"class":154},[50,15776,1336],{"class":1221},[50,15778,15779,15781,15783,15785],{"class":52,"line":450},[50,15780,1397],{"class":154},[50,15782,1400],{"class":1221},[50,15784,1403],{"class":154},[50,15786,1406],{"class":1221},[40,15788,15791],{"className":1139,"code":15789,"filename":15790,"language":1142,"meta":45,"style":45},"/* @bruin\n\nname: mart.customers_by_country\ntype: duckdb.sql\n\nmaterialization:\n  type: table\n  strategy: create+replace\n\ndepends:\n  - stg.customers\n\n@bruin */\n\nSELECT\n    country,\n    COUNT(*) AS total_customers\n  FROM stg.customers\n  GROUP BY country\n  ORDER BY total_customers DESC\n","mart.customers_by_county.asset.sql",[47,15792,15793,15797,15801,15806,15810,15814,15818,15822,15826,15830,15834,15838,15842,15846,15850,15854,15859,15874,15880,15887],{"__ignoreMap":45},[50,15794,15795],{"class":52,"line":53},[50,15796,1149],{"class":950},[50,15798,15799],{"class":52,"line":67},[50,15800,371],{"emptyLinePlaceholder":370},[50,15802,15803],{"class":52,"line":76},[50,15804,15805],{"class":950},"name: mart.customers_by_country\n",[50,15807,15808],{"class":52,"line":84},[50,15809,1159],{"class":950},[50,15811,15812],{"class":52,"line":92},[50,15813,371],{"emptyLinePlaceholder":370},[50,15815,15816],{"class":52,"line":100},[50,15817,1179],{"class":950},[50,15819,15820],{"class":52,"line":114},[50,15821,1184],{"class":950},[50,15823,15824],{"class":52,"line":125},[50,15825,1189],{"class":950},[50,15827,15828],{"class":52,"line":135},[50,15829,371],{"emptyLinePlaceholder":370},[50,15831,15832],{"class":52,"line":146},[50,15833,1194],{"class":950},[50,15835,15836],{"class":52,"line":158},[50,15837,1199],{"class":950},[50,15839,15840],{"class":52,"line":168},[50,15841,371],{"emptyLinePlaceholder":370},[50,15843,15844],{"class":52,"line":176},[50,15845,1209],{"class":950},[50,15847,15848],{"class":52,"line":188},[50,15849,371],{"emptyLinePlaceholder":370},[50,15851,15852],{"class":52,"line":316},[50,15853,1618],{"class":154},[50,15855,15856],{"class":52,"line":324},[50,15857,15858],{"class":1221},"    country,\n",[50,15860,15861,15864,15866,15868,15870,15872],{"class":52,"line":334},[50,15862,15863],{"class":1362},"    COUNT",[50,15865,1366],{"class":1221},[50,15867,1369],{"class":60},[50,15869,1372],{"class":1221},[50,15871,1225],{"class":154},[50,15873,1377],{"class":1221},[50,15875,15876,15878],{"class":52,"line":341},[50,15877,1341],{"class":154},[50,15879,1344],{"class":1221},[50,15881,15882,15885],{"class":52,"line":352},[50,15883,15884],{"class":154},"  GROUP BY",[50,15886,789],{"class":1221},[50,15888,15889,15892,15894],{"class":52,"line":359},[50,15890,15891],{"class":154},"  ORDER BY",[50,15893,1400],{"class":1221},[50,15895,15896],{"class":154},"DESC\n",[32,15898,15899],{},"::",[15901,15902,15905],"prose-code-tree-from-path",{"path":15903,"default-value":15904,"expand-all":45},"/examples/pipeline","main.sql",[32,15906,15899],{},[15908,15909,15910],"style",{},"html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html pre.shiki code .sbssI, html code.shiki .sbssI{--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sfNiH, html code.shiki .sfNiH{--shiki-light:#FF5370;--shiki-default:#FF9CAC;--shiki-dark:#FF9CAC}html pre.shiki code .sHwdD, html code.shiki .sHwdD{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#546E7A;--shiki-default-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html pre.shiki code .s2Zo4, html code.shiki .s2Zo4{--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF}html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .sBMFI, html code.shiki .sBMFI{--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B}html pre.shiki code .s7zQu, html code.shiki .s7zQu{--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#89DDFF;--shiki-default-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic}html pre.shiki code .sHdIc, html code.shiki .sHdIc{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#EEFFFF;--shiki-default-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic}",{"title":45,"searchDepth":53,"depth":67,"links":15912},[15913,15914,15915,15916,15917,15918,15919,15920,15921],{"id":1919,"depth":67,"text":1923},{"id":1968,"depth":67,"text":1969},{"id":2057,"depth":67,"text":2058},{"id":3085,"depth":67,"text":3086},{"id":3271,"depth":67,"text":3272},{"id":8589,"depth":67,"text":8590},{"id":8716,"depth":67,"text":8717},{"id":9725,"depth":67,"text":9726},{"id":14101,"depth":67,"text":14102},"Building an E‑commerce Analytics Pipeline with Bruin, PostgresSQL and DuckDB","md",null,{},{"icon":22},{"title":19,"description":15922},"J4lCZi-n3TUDkY_u-s27FIDR1Kdv54-YJ1KBE2ZnDpk",[15930,15924],{"title":10,"path":6,"stem":7,"description":15931,"icon":11,"children":-1},"Welcome to Bruin University.",1760922605344]