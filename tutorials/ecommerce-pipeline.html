<!DOCTYPE html><html  lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style id="nuxt-ui-colors">@layer base {
  :root {
  --ui-color-primary-50: var(--color-green-50, oklch(98.2% 0.018 155.826));
  --ui-color-primary-100: var(--color-green-100, oklch(96.2% 0.044 156.743));
  --ui-color-primary-200: var(--color-green-200, oklch(92.5% 0.084 155.995));
  --ui-color-primary-300: var(--color-green-300, oklch(87.1% 0.15 154.449));
  --ui-color-primary-400: var(--color-green-400, oklch(79.2% 0.209 151.711));
  --ui-color-primary-500: var(--color-green-500, oklch(72.3% 0.219 149.579));
  --ui-color-primary-600: var(--color-green-600, oklch(62.7% 0.194 149.214));
  --ui-color-primary-700: var(--color-green-700, oklch(52.7% 0.154 150.069));
  --ui-color-primary-800: var(--color-green-800, oklch(44.8% 0.119 151.328));
  --ui-color-primary-900: var(--color-green-900, oklch(39.3% 0.095 152.535));
  --ui-color-primary-950: var(--color-green-950, oklch(26.6% 0.065 152.934));
  --ui-color-secondary-50: var(--color-blue-50, oklch(97% 0.014 254.604));
  --ui-color-secondary-100: var(--color-blue-100, oklch(93.2% 0.032 255.585));
  --ui-color-secondary-200: var(--color-blue-200, oklch(88.2% 0.059 254.128));
  --ui-color-secondary-300: var(--color-blue-300, oklch(80.9% 0.105 251.813));
  --ui-color-secondary-400: var(--color-blue-400, oklch(70.7% 0.165 254.624));
  --ui-color-secondary-500: var(--color-blue-500, oklch(62.3% 0.214 259.815));
  --ui-color-secondary-600: var(--color-blue-600, oklch(54.6% 0.245 262.881));
  --ui-color-secondary-700: var(--color-blue-700, oklch(48.8% 0.243 264.376));
  --ui-color-secondary-800: var(--color-blue-800, oklch(42.4% 0.199 265.638));
  --ui-color-secondary-900: var(--color-blue-900, oklch(37.9% 0.146 265.522));
  --ui-color-secondary-950: var(--color-blue-950, oklch(28.2% 0.091 267.935));
  --ui-color-success-50: var(--color-green-50, oklch(98.2% 0.018 155.826));
  --ui-color-success-100: var(--color-green-100, oklch(96.2% 0.044 156.743));
  --ui-color-success-200: var(--color-green-200, oklch(92.5% 0.084 155.995));
  --ui-color-success-300: var(--color-green-300, oklch(87.1% 0.15 154.449));
  --ui-color-success-400: var(--color-green-400, oklch(79.2% 0.209 151.711));
  --ui-color-success-500: var(--color-green-500, oklch(72.3% 0.219 149.579));
  --ui-color-success-600: var(--color-green-600, oklch(62.7% 0.194 149.214));
  --ui-color-success-700: var(--color-green-700, oklch(52.7% 0.154 150.069));
  --ui-color-success-800: var(--color-green-800, oklch(44.8% 0.119 151.328));
  --ui-color-success-900: var(--color-green-900, oklch(39.3% 0.095 152.535));
  --ui-color-success-950: var(--color-green-950, oklch(26.6% 0.065 152.934));
  --ui-color-info-50: var(--color-blue-50, oklch(97% 0.014 254.604));
  --ui-color-info-100: var(--color-blue-100, oklch(93.2% 0.032 255.585));
  --ui-color-info-200: var(--color-blue-200, oklch(88.2% 0.059 254.128));
  --ui-color-info-300: var(--color-blue-300, oklch(80.9% 0.105 251.813));
  --ui-color-info-400: var(--color-blue-400, oklch(70.7% 0.165 254.624));
  --ui-color-info-500: var(--color-blue-500, oklch(62.3% 0.214 259.815));
  --ui-color-info-600: var(--color-blue-600, oklch(54.6% 0.245 262.881));
  --ui-color-info-700: var(--color-blue-700, oklch(48.8% 0.243 264.376));
  --ui-color-info-800: var(--color-blue-800, oklch(42.4% 0.199 265.638));
  --ui-color-info-900: var(--color-blue-900, oklch(37.9% 0.146 265.522));
  --ui-color-info-950: var(--color-blue-950, oklch(28.2% 0.091 267.935));
  --ui-color-warning-50: var(--color-yellow-50, oklch(98.7% 0.026 102.212));
  --ui-color-warning-100: var(--color-yellow-100, oklch(97.3% 0.071 103.193));
  --ui-color-warning-200: var(--color-yellow-200, oklch(94.5% 0.129 101.54));
  --ui-color-warning-300: var(--color-yellow-300, oklch(90.5% 0.182 98.111));
  --ui-color-warning-400: var(--color-yellow-400, oklch(85.2% 0.199 91.936));
  --ui-color-warning-500: var(--color-yellow-500, oklch(79.5% 0.184 86.047));
  --ui-color-warning-600: var(--color-yellow-600, oklch(68.1% 0.162 75.834));
  --ui-color-warning-700: var(--color-yellow-700, oklch(55.4% 0.135 66.442));
  --ui-color-warning-800: var(--color-yellow-800, oklch(47.6% 0.114 61.907));
  --ui-color-warning-900: var(--color-yellow-900, oklch(42.1% 0.095 57.708));
  --ui-color-warning-950: var(--color-yellow-950, oklch(28.6% 0.066 53.813));
  --ui-color-error-50: var(--color-red-50, oklch(97.1% 0.013 17.38));
  --ui-color-error-100: var(--color-red-100, oklch(93.6% 0.032 17.717));
  --ui-color-error-200: var(--color-red-200, oklch(88.5% 0.062 18.334));
  --ui-color-error-300: var(--color-red-300, oklch(80.8% 0.114 19.571));
  --ui-color-error-400: var(--color-red-400, oklch(70.4% 0.191 22.216));
  --ui-color-error-500: var(--color-red-500, oklch(63.7% 0.237 25.331));
  --ui-color-error-600: var(--color-red-600, oklch(57.7% 0.245 27.325));
  --ui-color-error-700: var(--color-red-700, oklch(50.5% 0.213 27.518));
  --ui-color-error-800: var(--color-red-800, oklch(44.4% 0.177 26.899));
  --ui-color-error-900: var(--color-red-900, oklch(39.6% 0.141 25.723));
  --ui-color-error-950: var(--color-red-950, oklch(25.8% 0.092 26.042));
  --ui-color-neutral-50: var(--color-zinc-50, oklch(98.5% 0 0));
  --ui-color-neutral-100: var(--color-zinc-100, oklch(96.7% 0.001 286.375));
  --ui-color-neutral-200: var(--color-zinc-200, oklch(92% 0.004 286.32));
  --ui-color-neutral-300: var(--color-zinc-300, oklch(87.1% 0.006 286.286));
  --ui-color-neutral-400: var(--color-zinc-400, oklch(70.5% 0.015 286.067));
  --ui-color-neutral-500: var(--color-zinc-500, oklch(55.2% 0.016 285.938));
  --ui-color-neutral-600: var(--color-zinc-600, oklch(44.2% 0.017 285.786));
  --ui-color-neutral-700: var(--color-zinc-700, oklch(37% 0.013 285.805));
  --ui-color-neutral-800: var(--color-zinc-800, oklch(27.4% 0.006 286.033));
  --ui-color-neutral-900: var(--color-zinc-900, oklch(21% 0.006 285.885));
  --ui-color-neutral-950: var(--color-zinc-950, oklch(14.1% 0.005 285.823));
  }
  :root, .light {
  --ui-primary: var(--ui-color-primary-500);
  --ui-secondary: var(--ui-color-secondary-500);
  --ui-success: var(--ui-color-success-500);
  --ui-info: var(--ui-color-info-500);
  --ui-warning: var(--ui-color-warning-500);
  --ui-error: var(--ui-color-error-500);
  }
  .dark {
  --ui-primary: var(--ui-color-primary-400);
  --ui-secondary: var(--ui-color-secondary-400);
  --ui-success: var(--ui-color-success-400);
  --ui-info: var(--ui-color-info-400);
  --ui-warning: var(--ui-color-warning-400);
  --ui-error: var(--ui-color-error-400);
  }
}</style><script type="importmap">{"imports":{"#entry":"/_nuxt/krPQEBAk.js"}}</script><title>E-commerce Showcase - Nuxt Docs Template</title><style>/*! tailwindcss v4.1.14 | MIT License | https://tailwindcss.com */.shiki span.line{display:block}.shiki span.line.highlight{background-color:var(--ui-bg-accented);margin:0 -16px;padding:0 16px}@supports (color:color-mix(in lab,red,red)){.shiki span.line.highlight{background-color:color-mix(in oklab,var(--ui-bg-accented)50%,transparent)}}</style><link rel="stylesheet" href="/_nuxt/entry.DhJTFatc.css" crossorigin><style>@layer components {:where(.i-lucide\:arrow-up-right){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M7 7h10v10M7 17L17 7'/%3E%3C/svg%3E")}:where(.i-lucide\:book-open){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 7v14m-9-3a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4a4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3a3 3 0 0 0-3-3z'/%3E%3C/svg%3E")}:where(.i-lucide\:chevron-down){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 9l6 6l6-6'/%3E%3C/svg%3E")}:where(.i-lucide\:copy){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Crect width='14' height='14' x='8' y='8' rx='2' ry='2'/%3E%3Cpath d='M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:external-link){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15 3h6v6m-11 5L21 3m-3 10v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6'/%3E%3C/svg%3E")}:where(.i-lucide\:folder){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z'/%3E%3C/svg%3E")}:where(.i-lucide\:folder-open){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 14l1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2'/%3E%3C/svg%3E")}:where(.i-lucide\:hash){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 9h16M4 15h16M10 3L8 21m8-18l-2 18'/%3E%3C/svg%3E")}:where(.i-lucide\:house){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8'/%3E%3Cpath d='M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:info){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='10'/%3E%3Cpath d='M12 16v-4m0-4h.01'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:menu){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 5h16M4 12h16M4 19h16'/%3E%3C/svg%3E")}:where(.i-lucide\:search){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='m21 21l-4.34-4.34'/%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:shopping-cart){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Ccircle cx='8' cy='21' r='1'/%3E%3Ccircle cx='19' cy='21' r='1'/%3E%3Cpath d='M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:star){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.12 2.12 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.12 2.12 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.12 2.12 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.12 2.12 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.12 2.12 0 0 0 1.597-1.16z'/%3E%3C/svg%3E")}:where(.i-simple-icons\:discord){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='black' d='M20.317 4.37a19.8 19.8 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.3 18.3 0 0 0-5.487 0a13 13 0 0 0-.617-1.25a.08.08 0 0 0-.079-.037A19.7 19.7 0 0 0 3.677 4.37a.1.1 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.08.08 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.08.08 0 0 0 .084-.028a14 14 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13 13 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10 10 0 0 0 .372-.292a.07.07 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.07.07 0 0 1 .078.01q.181.149.373.292a.077.077 0 0 1-.006.127a12.3 12.3 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.08.08 0 0 0 .084.028a19.8 19.8 0 0 0 6.002-3.03a.08.08 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.06.06 0 0 0-.031-.03M8.02 15.33c-1.182 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418m7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418'/%3E%3C/svg%3E")}:where(.i-simple-icons\:github){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='black' d='M12 .297c-6.63 0-12 5.373-12 12c0 5.303 3.438 9.8 8.205 11.385c.6.113.82-.258.82-.577c0-.285-.01-1.04-.015-2.04c-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729c1.205.084 1.838 1.236 1.838 1.236c1.07 1.835 2.809 1.305 3.495.998c.108-.776.417-1.305.76-1.605c-2.665-.3-5.466-1.332-5.466-5.93c0-1.31.465-2.38 1.235-3.22c-.135-.303-.54-1.523.105-3.176c0 0 1.005-.322 3.3 1.23c.96-.267 1.98-.399 3-.405c1.02.006 2.04.138 3 .405c2.28-1.552 3.285-1.23 3.285-1.23c.645 1.653.24 2.873.12 3.176c.765.84 1.23 1.91 1.23 3.22c0 4.61-2.805 5.625-5.475 5.92c.42.36.81 1.096.81 2.22c0 1.606-.015 2.896-.015 3.286c0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E")}:where(.i-simple-icons\:x){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='black' d='M14.234 10.162L22.977 0h-2.072l-7.591 8.824L7.251 0H.258l9.168 13.343L.258 24H2.33l8.016-9.318L16.749 24h6.993zm-2.837 3.299l-.929-1.329L3.076 1.56h3.182l5.965 8.532l.929 1.329l7.754 11.09h-3.182z'/%3E%3C/svg%3E")}:where(.i-tabler\:chart-bar){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M3 13a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm12-4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1zM9 5a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1zM4 20h14'/%3E%3C/svg%3E")}:where(.i-tabler\:database-import){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='M4 6c0 1.657 3.582 3 8 3s8-1.343 8-3s-3.582-3-8-3s-8 1.343-8 3'/%3E%3Cpath d='M4 6v6c0 1.657 3.582 3 8 3c.856 0 1.68-.05 2.454-.144M20 12V6'/%3E%3Cpath d='M4 12v6c0 1.657 3.582 3 8 3q.256 0 .51-.006M19 22v-6m3 3l-3-3l-3 3'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-tabler\:shield-check){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M11.46 20.846A12 12 0 0 1 3.5 6A12 12 0 0 0 12 3a12 12 0 0 0 8.5 3a12 12 0 0 1-.09 7.06M15 19l2 2l4-4'/%3E%3C/svg%3E")}:where(.i-tabler\:transform){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M3 6a3 3 0 1 0 6 0a3 3 0 0 0-6 0m18 5V8a2 2 0 0 0-2-2h-6l3 3m0-6l-3 3M3 13v3a2 2 0 0 0 2 2h6l-3-3m0 6l3-3m4 0a3 3 0 1 0 6 0a3 3 0 0 0-6 0'/%3E%3C/svg%3E")}:where(.i-vscode-icons\:file-type-python){display:inline-block;width:1em;height:1em;background-repeat:no-repeat;background-size:100% 100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32'%3E%3Cdefs%3E%3ClinearGradient id='SVGX8aSrdTv' x1='-133.268' x2='-133.198' y1='-202.91' y2='-202.84' gradientTransform='matrix(189.38 0 0 189.81 25243.061 38519.17)' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23387eb8'/%3E%3Cstop offset='1' stop-color='%23366994'/%3E%3C/linearGradient%3E%3ClinearGradient id='SVGgyPQvciu' x1='-133.575' x2='-133.495' y1='-203.203' y2='-203.133' gradientTransform='matrix(189.38 0 0 189.81 25309.061 38583.42)' gradientUnits='userSpaceOnUse'%3E%3Cstop offset='0' stop-color='%23ffe052'/%3E%3Cstop offset='1' stop-color='%23ffc331'/%3E%3C/linearGradient%3E%3C/defs%3E%3Cpath fill='url(%23SVGX8aSrdTv)' d='M15.885 2.1c-7.1 0-6.651 3.07-6.651 3.07v3.19h6.752v1H6.545S2 8.8 2 16.005s4.013 6.912 4.013 6.912H8.33v-3.361s-.13-4.013 3.9-4.013h6.762s3.772.06 3.772-3.652V5.8s.572-3.712-6.842-3.712Zm-3.732 2.137a1.214 1.214 0 1 1-1.183 1.244v-.02a1.214 1.214 0 0 1 1.214-1.214Z'/%3E%3Cpath fill='url(%23SVGgyPQvciu)' d='M16.085 29.91c7.1 0 6.651-3.08 6.651-3.08v-3.18h-6.751v-1h9.47S30 23.158 30 15.995s-4.013-6.912-4.013-6.912H23.64V12.4s.13 4.013-3.9 4.013h-6.765S9.2 16.356 9.2 20.068V26.2s-.572 3.712 6.842 3.712h.04Zm3.732-2.147A1.214 1.214 0 1 1 21 26.519v.03a1.214 1.214 0 0 1-1.214 1.214z'/%3E%3C/svg%3E")}:where(.i-vscode-icons\:file-type-sql){display:inline-block;width:1em;height:1em;background-repeat:no-repeat;background-size:100% 100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32'%3E%3Cpath fill='%23ffda44' d='M8.562 15.256A21.2 21.2 0 0 0 16 16.449a21.2 21.2 0 0 0 7.438-1.194c1.864-.727 2.525-1.535 2.525-2V9.7a10.4 10.4 0 0 1-2.084 1.076A22.3 22.3 0 0 1 16 12.078a22.4 22.4 0 0 1-7.879-1.3A10.3 10.3 0 0 1 6.037 9.7v3.55c0 .474.663 1.278 2.525 2.006m0 6.705a15.6 15.6 0 0 0 2.6.741a25 25 0 0 0 4.838.453a25 25 0 0 0 4.838-.452a15.6 15.6 0 0 0 2.6-.741c1.864-.727 2.525-1.535 2.525-2v-3.39a10.7 10.7 0 0 1-1.692.825A23.5 23.5 0 0 1 16 18.74a23.5 23.5 0 0 1-8.271-1.348a11 11 0 0 1-1.692-.825v3.393c0 .466.663 1.271 2.525 2.001M16 30c5.5 0 9.963-1.744 9.963-3.894v-2.837a10.5 10.5 0 0 1-1.535.762l-.157.063A23.5 23.5 0 0 1 16 25.445a23.4 23.4 0 0 1-8.271-1.351l-.157-.063a10.5 10.5 0 0 1-1.535-.762v2.837C6.037 28.256 10.5 30 16 30'/%3E%3Cellipse cx='16' cy='5.894' fill='%23ffda44' rx='9.963' ry='3.894'/%3E%3C/svg%3E")}:where(.i-vscode-icons\:file-type-yaml){display:inline-block;width:1em;height:1em;background-repeat:no-repeat;background-size:100% 100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32'%3E%3Cpath fill='%23ffe885' d='M2 12.218c.755 0 1.51-.008 2.264 0l.053.038l2.761 2.758c.891-.906 1.8-1.794 2.7-2.7c.053-.052.11-.113.192-.1h1.823a1.4 1.4 0 0 1 .353.019c-.7.67-1.377 1.369-2.069 2.05L5.545 18.8c-.331.324-.648.663-.989.975c-.754.022-1.511.007-2.266.007c1.223-1.209 2.431-2.433 3.658-3.637c-1.321-1.304-2.63-2.62-3.948-3.927m10.7 0h1.839v7.566c-.611 0-1.222.012-1.832-.008v-4.994c-1.6 1.607-3.209 3.2-4.811 4.8c-.089.08-.166.217-.305.194c-.824-.006-1.649 0-2.474 0Q8.916 16 12.7 12.218m2.258.002c.47-.009.939 0 1.409 0c.836.853 1.69 1.689 2.536 2.532q1.268-1.267 2.539-2.532h1.4q-.008 3.784 0 7.567c-.471 0-.943.006-1.414 0q.008-2.387 0-4.773c-.844.843-1.676 1.7-2.526 2.536c-.856-.835-1.687-1.695-2.532-2.541c0 1.594-.006 3.188.006 4.781c-.472 0-.943.005-1.415 0q-.003-3.79-.003-7.57m8.301-.003c.472 0 .944-.007 1.416 0q-.007 3.083 0 6.166h3.782c.063.006.144-.012.191.045c.448.454.907.9 1.353 1.354q-3.371.007-6.741 0q.007-3.782-.001-7.565'/%3E%3C/svg%3E")}}</style><link rel="preload" as="fetch" crossorigin="anonymous" href="/tutorials/ecommerce-pipeline/_payload.json?005c2f49-71f6-4db7-9ce9-af20ab351679"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/krPQEBAk.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DT-U_-VL.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C_gTWtfU.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHjUtTFN.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/p1xcoZdF.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BN_7HF1G.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/9toAk5aT.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Du62FfiF.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cfu7gret.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/47JZPomr.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/lDCt5PN4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/IwaH01oE.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DpCTlY-H.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/UV2TsU4X.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/cZtp3vDo.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/EumJ0uNn.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/tijRrzkl.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CiS7vzDN.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CUBXs9yN.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DWoyacC4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DJupRnTw.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/fYZLF0MO.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CgYtpQo4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DPU3W3x-.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/SpWnBOSj.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/SxanQqgT.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C4rlBs3T.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DCkVonrh.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/DDThj8XS.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/A5pnLYDk.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CgnkRLJn.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/B3xoavPd.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/SouBecZC.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CgzVpHwL.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/005c2f49-71f6-4db7-9ce9-af20ab351679.json"><link rel="prefetch" as="style" crossorigin href="/_nuxt/index.C1qFlIse.css"><link rel="prefetch" as="script" crossorigin href="/_nuxt/CvgV3k72.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/81TucBUT.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/N26Zuyju.js"><meta property="og:image" content="/__og-image__/static/tutorials/ecommerce-pipeline/og.png"><meta property="og:image:type" content="image/png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="/__og-image__/static/tutorials/ecommerce-pipeline/og.png"><meta name="twitter:image:src" content="/__og-image__/static/tutorials/ecommerce-pipeline/og.png"><meta property="og:image:width" content="1200"><meta name="twitter:image:width" content="1200"><meta property="og:image:height" content="600"><meta name="twitter:image:height" content="600"><link rel="icon" href="/favicon.ico"><meta property="og:site_name" content="Nuxt Docs Template"><meta property="og:title" content="E-commerce Showcase"><meta name="description" content="Building an E‑commerce Analytics Pipeline with Bruin, PostgresSQL and DuckDB"><meta property="og:description" content="Building an E‑commerce Analytics Pipeline with Bruin, PostgresSQL and DuckDB"><script type="module" src="/_nuxt/krPQEBAk.js" crossorigin></script><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt" class="isolate"><!--[--><!--[--><!--[--><!--[--><!--[--><div class="nuxt-loading-indicator" style="position:fixed;top:0;right:0;left:0;pointer-events:none;width:auto;height:3px;opacity:0;background:repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%);background-size:0% auto;transform:scaleX(0%);transform-origin:left;transition:transform 0.1s, height 0.4s, opacity 0.4s;z-index:999999;"></div><!--[--><!----><!----><!----><header class="bg-default/75 backdrop-blur border-b border-default h-(--ui-header-height) sticky top-0 z-50"><!--[--><!--]--><div class="w-full max-w-(--ui-container) mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between gap-3 h-full"><!--[--><div class="lg:flex-1 flex items-center gap-1.5"><!----><!--[--><a href="/" class=""><svg width="1020" height="200" viewbox="0 0 1020 200" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-auto h-6 shrink-0"><g clip-path="url(#clip0_5_57)"><path opacity="0.995" fill-rule="evenodd" clip-rule="evenodd" d="M807.983 -0.133179C808.797 -0.133179 809.608 -0.133179 810.422 -0.133179C821.896 0.525311 830.279 5.31891 835.571 14.2476C839.927 26.1776 836.117 35.543 824.139 42.3435C813.763 46.9307 803.499 46.7531 793.35 41.8109C782.004 34.801 778.602 25.5245 783.138 13.9813C788.409 5.2215 796.691 0.516664 807.983 -0.133179Z" fill="#D95E5E"></path><path opacity="0.995" fill-rule="evenodd" clip-rule="evenodd" d="M33.0751 13.715C105.323 13.6706 177.57 13.715 249.818 13.8482C250.65 13.9542 251.209 14.3537 251.494 15.0466C251.697 15.8455 251.697 16.6444 251.494 17.4434C247.836 22.9472 244.178 28.4508 240.52 33.9547C240.158 34.3659 240.056 34.8098 240.215 35.2863C254.238 47.5366 268.26 59.7869 282.283 72.0373C282.949 73.6737 282.848 75.2716 281.978 76.8309C236.265 116.767 190.386 156.847 144.342 197.071C142.412 197.958 140.481 197.958 138.55 197.071C92.5068 156.847 46.6281 116.767 0.914358 76.8309C0.0234514 75.2796 -0.0781624 73.6817 0.609516 72.0373C14.6322 59.7869 28.6549 47.5366 42.6777 35.2863C42.756 34.6159 42.5527 33.9946 42.068 33.4221C38.5157 28.1044 34.9591 22.7782 31.3985 17.4434C30.8772 15.7859 31.436 14.5431 33.0751 13.715Z" fill="#D95F5F"></path><path opacity="0.998" fill-rule="evenodd" clip-rule="evenodd" d="M300.726 13.4487C319.727 13.4487 338.731 13.4487 357.731 13.4487C357.631 36.8849 357.731 60.3204 358.036 83.755C367.776 64.935 384.542 56.3686 408.335 58.0559C429.324 60.3358 444.718 69.6122 454.519 85.8855C459.948 95.2644 463.097 105.207 463.969 115.712C465.325 128.039 464.716 140.289 462.14 152.463C459.094 166.357 451.726 178.119 440.039 187.75C425.132 198.151 408.262 201.702 389.435 198.402C374.772 195.173 364.459 187.494 358.494 175.366C358.079 175.132 357.622 175.043 357.122 175.1C357.122 182.645 357.122 190.191 357.122 197.736C338.322 197.736 319.526 197.736 300.726 197.736C300.726 136.307 300.726 74.878 300.726 13.4487ZM379.375 96.0053C390.41 95.923 397.98 100.362 402.086 109.321C407.149 122.279 407.149 135.24 402.086 148.202C395.596 160.42 385.179 164.015 370.84 158.988C364.517 155.276 360.402 150.172 358.494 143.675C355.899 134.358 355.695 125.038 357.884 115.712C359.472 108.712 363.487 103.075 369.925 98.8016C372.876 97.2498 376.028 96.3177 379.375 96.0053Z" fill="#D95E5E"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M73.6191 27.5632C79.6151 27.5187 85.6104 27.5632 91.6048 27.6963C94.3959 28.5342 95.3614 30.1765 94.5008 32.6231C91.9605 36.5291 89.42 40.4348 86.8797 44.3408C85.6985 46.3733 83.8185 47.1278 81.2402 46.6045C80.5973 46.3006 80.0385 45.9011 79.5635 45.4061C76.6413 41.0995 73.7959 36.7499 71.028 32.3568C70.8247 31.5579 70.8247 30.7589 71.028 29.96C71.748 29.0207 72.6119 28.2218 73.6191 27.5632Z" fill="#FEFCFC"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M140.685 27.5633C142.205 27.5148 143.17 28.1361 143.581 29.4275C162.512 59.2214 181.362 89.0483 200.129 118.908C200.014 119.41 199.709 119.809 199.214 120.107C160.703 120.284 122.191 120.284 83.6791 120.107C82.8905 119.7 82.6366 119.123 82.917 118.376C102.013 88.0288 121.269 57.758 140.685 27.5633Z" fill="#FEFEFE"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M190.983 27.5632C196.877 27.5187 202.771 27.5632 208.664 27.6963C211.365 28.3733 212.432 29.9267 211.865 32.3568C208.887 36.9978 205.788 41.5696 202.567 46.0718C200.273 47.1914 198.292 46.8806 196.623 45.1398C193.619 40.7789 190.773 36.3403 188.087 31.8242C187.88 29.789 188.845 28.3685 190.983 27.5632Z" fill="#FEFCFC"></path><path opacity="0.998" fill-rule="evenodd" clip-rule="evenodd" d="M568.987 57.9227C575.392 57.4841 581.641 58.1057 587.735 59.7869C587.887 73.9012 587.939 88.0157 587.887 102.13C578.339 99.8836 568.685 99.3954 558.927 100.666C548.602 103.294 541.947 109.108 538.96 118.109C538.497 119.774 538.192 121.461 538.045 123.169C537.893 148.025 537.841 172.88 537.893 197.736C518.892 197.736 499.888 197.736 480.888 197.736C480.888 151.664 480.888 105.592 480.888 59.5206C499.279 59.4761 517.673 59.5206 536.064 59.6537C536.369 68.3781 536.469 77.1219 536.369 85.8854C536.869 85.9424 537.326 85.8535 537.741 85.6191C539.78 77.3046 544.301 70.2474 551.306 64.4474C556.549 60.8948 562.442 58.7201 568.987 57.9227Z" fill="#D85E5E"></path><path opacity="0.997" fill-rule="evenodd" clip-rule="evenodd" d="M958.27 57.9227C970.756 56.9525 982.44 59.1272 993.326 64.4473C1006.64 72.1983 1014.81 82.984 1017.87 96.8042C1018.47 99.5339 1018.88 102.286 1019.09 105.06C1019.24 135.952 1019.29 166.844 1019.24 197.736C1000.24 197.736 981.233 197.736 962.232 197.736C962.376 170.302 962.223 142.872 961.775 115.446C959.797 104.485 952.481 98.8031 939.827 98.4021C927.895 98.5975 920.475 103.746 917.573 113.848C917.287 115.527 917.082 117.214 916.963 118.908C916.811 145.184 916.759 171.46 916.811 197.736C897.81 197.736 878.806 197.736 859.806 197.736C859.806 151.664 859.806 105.592 859.806 59.5206C878.605 59.5206 897.402 59.5206 916.201 59.5206C916.201 68.3089 916.201 77.0971 916.201 85.8854C916.607 85.8854 917.015 85.8854 917.421 85.8854C923.042 71.3435 934.422 62.3334 951.563 58.8548C953.837 58.5086 956.072 58.1978 958.27 57.9227Z" fill="#D95E5E"></path><path opacity="0.998" fill-rule="evenodd" clip-rule="evenodd" d="M599.471 59.5206C618.576 59.5206 637.677 59.5206 656.782 59.5206C656.635 87.4008 656.788 115.275 657.239 143.142C659.476 153.441 666.588 158.768 678.578 159.121C690.448 159.093 697.966 154.122 701.136 144.208C701.368 143.058 701.572 141.904 701.746 140.746C701.898 113.671 701.95 86.5957 701.898 59.5206C721.002 59.5206 740.104 59.5206 759.208 59.5206C759.208 105.593 759.208 151.664 759.208 197.736C741.018 197.736 722.832 197.736 704.642 197.736C704.642 189.037 704.642 180.337 704.642 171.638C704.142 171.581 703.684 171.67 703.27 171.904C696.234 187.701 683.074 196.8 663.793 199.201C651.209 200.624 639.217 198.937 627.822 194.141C610.912 185.162 601.614 171.98 599.929 154.594C599.483 122.906 599.331 91.2146 599.471 59.5206Z" fill="#D95E5E"></path><path opacity="0.997" fill-rule="evenodd" clip-rule="evenodd" d="M780.852 59.5206C799.852 59.5206 818.856 59.5206 837.857 59.5206C837.857 105.593 837.857 151.664 837.857 197.736C818.856 197.736 799.852 197.736 780.852 197.736C780.852 151.664 780.852 105.593 780.852 59.5206Z" fill="#D85E5E"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M128.186 87.217C136.925 87.1725 145.664 87.217 154.402 87.3502C158.099 88.7081 159.268 91.0607 157.908 94.4074C153.892 100.179 150.031 106.038 146.324 111.984C144.545 113.922 142.258 114.588 139.465 113.981C138.324 113.518 137.359 112.853 136.569 111.984C132.441 105.836 128.478 99.6223 124.68 93.3422C124.067 90.5067 125.236 88.4649 128.186 87.217Z" fill="#D95F5F"></path></g><defs><clipPath id="clip0_5_57"><rect width="1020" height="200" fill="white"></rect></clipPath></defs></svg></a><!--[--><!--[--><!--[--><!--[--><!--[--><button type="button" id="reka-dropdown-menu-trigger-v-0-0" aria-haspopup="menu" aria-expanded="false" data-state="closed" class="inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors px-2 py-1 text-xs gap-1 text-primary ring ring-inset ring-primary/25 bg-primary/10 hover:bg-primary/15 active:bg-primary/15 disabled:bg-primary/10 aria-disabled:bg-primary/10 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary -mb-[6px] font-semibold rounded-full truncate"><!--[--><!--[--><!----><!--]--><!--[--><span class="truncate">Docs</span><!--]--><!--[--><span class="iconify i-lucide:chevron-down shrink-0 size-4 transition-transform duration-200" aria-hidden="true" style=""></span><!--]--><!--]--></button><!--]--><!--]--><!--[--><!----><!--v-if--><!--]--><!--]--><!--]--><!--]--><!--]--></div><div class="hidden lg:flex flex-1"><!--[--><!--[--><!----><!--[--><!--[--><button type="button" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors px-2.5 py-1.5 text-sm gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted w-full"><!--[--><!--[--><span class="iconify i-lucide:search shrink-0 size-5" aria-hidden="true" style=""></span><!--]--><!--[--><span class="truncate">Search…</span><!--]--><!--[--><div class="hidden lg:flex items-center gap-0.5 ms-auto"><!--[--><!--[--><kbd class="inline-flex items-center justify-center px-1 rounded-sm font-medium font-sans h-5 min-w-[20px] text-[11px] ring ring-inset ring-accented text-default bg-elevated"><!--[--> <!--]--></kbd><kbd class="inline-flex items-center justify-center px-1 rounded-sm font-medium font-sans h-5 min-w-[20px] text-[11px] ring ring-inset ring-accented text-default bg-elevated"><!--[-->K<!--]--></kbd><!--]--><!--]--></div><!--]--><!--]--></button><!--]--><!--]--><!--]--><!--]--></div><div class="flex items-center justify-end lg:flex-1 gap-1.5"><!--[--><!--[--><!----><!--[--><!--[--><button type="button" aria-label="Search…" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors text-sm gap-1.5 text-default hover:bg-elevated active:bg-elevated focus:outline-none focus-visible:bg-elevated hover:disabled:bg-transparent dark:hover:disabled:bg-transparent hover:aria-disabled:bg-transparent dark:hover:aria-disabled:bg-transparent p-1.5 lg:hidden"><!--[--><!--[--><span class="iconify i-lucide:search shrink-0 size-5" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><!--]--><!--[--><!--[--><div class="size-8"></div><!--]--><!--]--><!--[--><!--[--><!--[--><a href="https://github.com/nuxt-ui-templates/docs" rel="noopener noreferrer" target="_blank" aria-label="GitHub" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors text-sm gap-1.5 text-default hover:bg-elevated active:bg-elevated focus:outline-none focus-visible:bg-elevated hover:disabled:bg-transparent dark:hover:disabled:bg-transparent hover:aria-disabled:bg-transparent dark:hover:aria-disabled:bg-transparent p-1.5"><!--[--><!--[--><span class="iconify i-simple-icons:github shrink-0 size-5" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></a><!--]--><!--]--><!--]--><!--]--><!--[--><!--[--><!--[--><button type="button" aria-label="Open menu" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors text-sm gap-1.5 text-default hover:bg-elevated active:bg-elevated focus:outline-none focus-visible:bg-elevated hover:disabled:bg-transparent dark:hover:disabled:bg-transparent hover:aria-disabled:bg-transparent dark:hover:aria-disabled:bg-transparent p-1.5 lg:hidden -me-1.5"><!--[--><!--[--><span class="iconify i-lucide:menu shrink-0 size-5" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><!--]--></div><!--]--></div><!--[--><!--]--></header><!--[--><!----><!--v-if--><!--]--><!--]--><main class="min-h-[calc(100vh-var(--ui-header-height))]"><!--[--><div class="w-full max-w-(--ui-container) mx-auto px-4 sm:px-6 lg:px-8"><!--[--><div class="flex flex-col lg:grid lg:grid-cols-10 lg:gap-10"><aside class="hidden overflow-y-auto lg:block lg:max-h-[calc(100vh-var(--ui-header-height))] lg:sticky lg:top-(--ui-header-height) py-8 lg:ps-4 lg:-ms-4 lg:pe-6.5 lg:col-span-2"><div class="relative"><!----><!--[--><!--[--><!----><nav><ul class="isolate -mx-2.5 -mt-1.5"><!--[--><!--[--><!--[--><li data-state="open" data-orientation="vertical" class="flex flex-col data-[state=open]:mb-1.5"><!--[--><!--[--><button type="button" aria-controls aria-expanded="true" data-state="open" id="reka-accordion-trigger-v-0-5-0" data-reka-collection-item data-orientation="vertical" class="group relative w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 focus-visible:before:ring-primary text-muted hover:text-highlighted hover:before:bg-elevated/50 data-[state=open]:text-highlighted transition-colors before:transition-colors font-semibold focus-visible:ring-primary"><!--[--><!--[--><!--[--><!--[--><!----><!--]--><span class="truncate"><!--[-->Getting Started<!--]--><!----></span><span class="ms-auto inline-flex gap-1.5 items-center"><!--[--><!----><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[state=open]:rotate-180" aria-hidden="true" style=""></span><!--]--></span><!--]--><!--]--><!--]--></button><div role="region" aria-labelledby="reka-accordion-trigger-v-0-5-0" data-orientation="vertical" style="--reka-accordion-content-width:var(--reka-collapsible-content-width);--reka-accordion-content-height:var(--reka-collapsible-content-height);--reka-collapsible-content-height:0px;--reka-collapsible-content-width:0px;" class="data-[state=open]:animate-[accordion-down_200ms_ease-out] data-[state=closed]:animate-[accordion-up_200ms_ease-out] overflow-hidden focus:outline-none" id="reka-collapsible-content-v-0-5-1"><!--[--><!--[--><!--[--><!----><ul class="ms-5 border-s border-default"><!--[--><!--[--><!--[--><li class="ps-1.5 -ms-px"><!--[--><a href="/getting-started" class="group relative w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 focus-visible:before:ring-primary text-muted after:absolute after:-left-1.5 after:inset-y-0.5 after:block after:w-px after:rounded-full after:transition-colors hover:text-highlighted hover:before:bg-elevated/50 data-[state=open]:text-highlighted transition-colors before:transition-colors"><!--[--><!--[--><!--[--><span class="iconify i-lucide:house shrink-0 size-5 text-dimmed group-hover:text-default group-data-[state=open]:text-default transition-colors" aria-hidden="true" style=""></span><!--]--><span class="truncate"><!--[-->Introduction<!--]--><!----></span><!----><!--]--><!--]--></a><!--]--></li><!--]--><!--]--><!--]--></ul><!--]--><!--]--><!--]--></div><!--]--><!--]--></li><!--]--><!--[--><li data-state="open" data-orientation="vertical" class="flex flex-col data-[state=open]:mb-1.5"><!--[--><!--[--><button type="button" aria-controls aria-expanded="true" data-state="open" id="reka-accordion-trigger-v-0-5-2" data-reka-collection-item data-orientation="vertical" class="group relative w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 focus-visible:before:ring-primary text-muted hover:text-highlighted hover:before:bg-elevated/50 data-[state=open]:text-highlighted transition-colors before:transition-colors font-semibold focus-visible:ring-primary"><!--[--><!--[--><!--[--><!--[--><!----><!--]--><span class="truncate"><!--[-->Tutorials<!--]--><!----></span><span class="ms-auto inline-flex gap-1.5 items-center"><!--[--><!----><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[state=open]:rotate-180" aria-hidden="true" style=""></span><!--]--></span><!--]--><!--]--><!--]--></button><div role="region" aria-labelledby="reka-accordion-trigger-v-0-5-2" data-orientation="vertical" style="--reka-accordion-content-width:var(--reka-collapsible-content-width);--reka-accordion-content-height:var(--reka-collapsible-content-height);--reka-collapsible-content-height:0px;--reka-collapsible-content-width:0px;" class="data-[state=open]:animate-[accordion-down_200ms_ease-out] data-[state=closed]:animate-[accordion-up_200ms_ease-out] overflow-hidden focus:outline-none" id="reka-collapsible-content-v-0-5-3"><!--[--><!--[--><!--[--><!----><ul class="ms-5 border-s border-default"><!--[--><!--[--><!--[--><li class="ps-1.5 -ms-px"><!--[--><a href="/tutorials/ecommerce-pipeline" class="group relative w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 focus-visible:before:ring-primary font-medium after:absolute after:-left-1.5 after:inset-y-0.5 after:block after:w-px after:rounded-full after:transition-colors text-primary hover:before:bg-elevated/50 before:transition-colors after:bg-primary"><!--[--><!--[--><!--[--><span class="iconify i-lucide:shopping-cart shrink-0 size-5 text-primary group-data-[state=open]:text-primary" aria-hidden="true" style=""></span><!--]--><span class="truncate"><!--[-->E-commerce Showcase<!--]--><!----></span><!----><!--]--><!--]--></a><!--]--></li><!--]--><!--]--><!--]--></ul><!--]--><!--]--><!--]--></div><!--]--><!--]--></li><!--]--><!--]--><!--]--></ul></nav><!--]--><!--]--><!--[--><!--]--></div></aside><div class="lg:col-span-8"><!--[--><!--[--><div class="flex flex-col lg:grid lg:grid-cols-10 lg:gap-10"><!----><div class="lg:col-span-8"><!--[--><div class="relative border-b border-default py-8"><div class="mb-2.5 text-sm font-semibold text-primary flex items-center gap-1.5"><!--[-->Tutorials<!--]--></div><div class=""><div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"><h1 class="text-3xl sm:text-4xl text-pretty font-bold text-highlighted"><!--[-->E-commerce Showcase<!--]--></h1><div class="flex flex-wrap items-center gap-1.5"><!--[--><!--[--><!--]--><!----><!--]--></div></div><div class="text-lg text-pretty text-muted mt-4"><!--[-->Building an E‑commerce Analytics Pipeline with Bruin, PostgresSQL and DuckDB<!--]--></div><!--[--><!--]--></div></div><div class="mt-8 pb-24 space-y-12"><!--[--><div><div class="relative my-5 group"><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none"><!--[--><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->:<!--]--></p><!--[--><!----><div class="relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md"><ul class="isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto" tabindex="-1" data-orientation="vertical" dir="ltr" style="outline:none;" role="tree"><!--[--><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-expanded="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-lucide:folder size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">orders-performance</span><span class="ms-auto inline-flex gap-1.5 items-center"><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[expanded=true]:rotate-180" aria-hidden="true" style=""></span></span></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="true" aria-level="1" data-indent="1" data-selected data-expanded><!--[--><button type="button" data-expanded="true" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 text-highlighted before:bg-elevated"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">.bruin.yml</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">glossary.yml</span><!----></button><!----><!--]--></li><!--]--><!--]--></ul><div class="overflow-hidden lg:col-span-2 flex flex-col [&amp;&gt;div]:my-0 [&amp;&gt;div]:flex-1 [&amp;&gt;div]:flex [&amp;&gt;div]:flex-col [&amp;&gt;div&gt;div]:border-0 [&amp;&gt;div&gt;pre]:border-b-0 [&amp;&gt;div&gt;pre]:border-s-0 [&amp;&gt;div&gt;pre]:border-e-0 [&amp;&gt;div&gt;pre]:rounded-l-none [&amp;&gt;div&gt;pre]:flex-1 [&amp;&gt;div]:overflow-y-auto"><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="text-default text-sm/6">.bruin.yml</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-yaml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="swJcz">default_environment</span><span class="sMK4o">:</span><span class="sfazB"> default
</span></span><span class="line" line="2"><span class="swJcz">environments</span><span class="sMK4o">:
</span></span><span class="line" line="3"><span class="swJcz">    default</span><span class="sMK4o">:
</span></span><span class="line" line="4"><span class="swJcz">        connections</span><span class="sMK4o">:
</span></span><span class="line" line="5"><span class="swJcz">            postgres</span><span class="sMK4o">:
</span></span><span class="line" line="6"><span class="sMK4o">                -</span><span class="swJcz"> name</span><span class="sMK4o">:</span><span class="sfazB"> pg-default
</span></span><span class="line" line="7"><span class="swJcz">                  username</span><span class="sMK4o">:</span><span class="sfazB"> postgres
</span></span><span class="line" line="8"><span class="swJcz">                  password</span><span class="sMK4o">:</span><span class="sfazB"> postgres
</span></span><span class="line" line="9"><span class="swJcz">                  host</span><span class="sMK4o">:</span><span class="sfazB"> localhost
</span></span><span class="line" line="10"><span class="swJcz">                  port</span><span class="sMK4o">:</span><span class="sbssI"> 5432
</span></span><span class="line" line="11"><span class="swJcz">                  database</span><span class="sMK4o">:</span><span class="sfazB"> postgres
</span></span><span class="line" line="12"><span class="swJcz">            duckdb</span><span class="sMK4o">:
</span></span><span class="line" line="13"><span class="sMK4o">                -</span><span class="swJcz"> name</span><span class="sMK4o">:</span><span class="sfazB"> duckdb-default
</span></span><span class="line" line="14"><span class="swJcz">                  path</span><span class="sMK4o">:</span><span class="sfazB"> duckdb.db
</span></span></code><!--]--></pre></div></div></div><!--]--><h2 id="what-this-hands-on-tutorial-covers" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#what-this-hands-on-tutorial-covers" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[--><strong><!--[-->What this hands-on tutorial covers<!--]--></strong><!--]--></a></h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-5 my-5 *:my-0 w-full"><!--[--><div class="group relative block my-5 p-4 sm:p-6 border border-default rounded-md bg-default transition-colors"><!----><span class="iconify i-tabler:database-import size-6 mb-2 block text-primary" aria-hidden="true" style=""></span><!----><p class="text-highlighted font-semibold"><!--[-->Ingestion Layer<!--]--></p><div class="text-[15px] text-muted *:first:mt-0 *:last:mb-0 *:my-1 mt-1"><!--[--><p class="my-5 leading-7 text-pretty"><!--[-->Learn how to configure Bruin assets for incremental ingestion from Postgres into DuckDB.<!--]--></p><!--]--></div></div><div class="group relative block my-5 p-4 sm:p-6 border border-default rounded-md bg-default transition-colors"><!----><span class="iconify i-tabler:transform size-6 mb-2 block text-primary" aria-hidden="true" style=""></span><!----><p class="text-highlighted font-semibold"><!--[-->Transformation Layer<!--]--></p><div class="text-[15px] text-muted *:first:mt-0 *:last:mb-0 *:my-1 mt-1"><!--[--><p class="my-5 leading-7 text-pretty"><!--[-->Explore staging and mart patterns that turn raw e-commerce data into usable analytics.<!--]--></p><!--]--></div></div><div class="group relative block my-5 p-4 sm:p-6 border border-default rounded-md bg-default transition-colors"><!----><span class="iconify i-tabler:shield-check size-6 mb-2 block text-primary" aria-hidden="true" style=""></span><!----><p class="text-highlighted font-semibold"><!--[-->Quality Checks<!--]--></p><div class="text-[15px] text-muted *:first:mt-0 *:last:mb-0 *:my-1 mt-1"><!--[--><p class="my-5 leading-7 text-pretty"><!--[-->Implement column-level and business logic validations to ensure data integrity.<!--]--></p><!--]--></div></div><div class="group relative block my-5 p-4 sm:p-6 border border-default rounded-md bg-default transition-colors"><!----><span class="iconify i-tabler:chart-bar size-6 mb-2 block text-primary" aria-hidden="true" style=""></span><!----><p class="text-highlighted font-semibold"><!--[-->Analytics &amp; Insights<!--]--></p><div class="text-[15px] text-muted *:first:mt-0 *:last:mb-0 *:my-1 mt-1"><!--[--><p class="my-5 leading-7 text-pretty"><!--[-->Build daily revenue and customer lifetime value dashboards from validated datasets.<!--]--></p><!--]--></div></div><!--]--></div><p class="my-5 leading-7 text-pretty"><!--[-->This tutorial is structured to give you a <strong><!--[-->straightforward, engineering-first path<!--]--></strong> to building a production-ready analytics pipeline. It’s about understanding how each component — ingestion, transformation, validation, and analysis — fits together under Bruin’s unified workflow.<!--]--></p><h2 id="_1-prerequisites-setup" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_1-prerequisites-setup" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->1) Prerequisites &amp; Setup<!--]--></a></h2><ul class="list-disc ps-6 my-5 marker:text-(--ui-border-accented)"><!--[--><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Docker (for Postgres)<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Python 3.11+<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->uv<!--]--></code> (fast Python toolchain manager) → <!--[--><a href="https://docs.astral.sh/uv/" rel="nofollow" class="text-primary border-b border-transparent hover:border-primary font-medium focus-visible:outline-primary [&amp;&gt;code]:border-dashed hover:[&amp;&gt;code]:border-primary hover:[&amp;&gt;code]:text-primary transition-colors [&amp;&gt;code]:transition-colors"><!--[--><!--[--><!--[-->https://docs.astral.sh/uv/<!--]--><!--]--><!--]--></a><!--]--><!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Git, Bash<!--]--></li><!--]--></ul><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">git</span><span class="sfazB"> clone</span><span class="sfazB"> https://github.com/danielhe4rt/bruin-ecommerce-pipeline
</span></span><span class="line" line="2"><span class="s2Zo4">cd</span><span class="sfazB"> bruin-ecommerce-pipeline
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->Or use the bruin templates directly from the CLI:<!--]--></p><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">bruin</span><span class="sfazB"> init</span><span class="sfazB"> ecommerce
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span class="s2Zo4">cd</span><span class="sfazB"> bruin
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->Then, open the project in your favorite code editor and let&#39;s get started!<!--]--></p><h2 id="_2-understanding-the-data-model-oltp-analytics" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_2-understanding-the-data-model-oltp-analytics" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->2) Understanding the Data Model (OLTP → Analytics)<!--]--></a></h2><p class="my-5 leading-7 text-pretty"><!--[-->In e-commerce — and most analytics-driven businesses — data pipelines are typically organized into <strong><!--[-->layers<!--]--></strong>, each
serving a specific purpose. This layered structure keeps data <strong><!--[-->reliable, interpretable, and adaptable<!--]--></strong> as the business
scales.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->The ultimate goal is to make data analysis effortless and focused on <strong><!--[-->answering real business questions<!--]--></strong> across key
domains, such as:<!--]--></p><div class="relative my-5 overflow-x-auto"><table class="w-full border-separate border-spacing-0 rounded-md"><!--[--><thead class="bg-muted"><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Domain<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Analysis Focus<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><strong><!--[-->Customers<!--]--></strong><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Segmentation by age, geography, and behavior patterns<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><strong><!--[-->Products and Product Variants<!--]--></strong><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Performance by category, profitability, and pricing insights<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><strong><!--[-->Orders and Order Items<!--]--></strong><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Daily revenue, order volume, and purchasing trends<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><strong><!--[-->KPI layer<!--]--></strong><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Metrics like <strong><!--[-->AOV<!--]--></strong>, <strong><!--[-->units per order<!--]--></strong>, <strong><!--[-->top SKUs<!--]--></strong>, and <strong><!--[-->repeat purchase rate<!--]--></strong><!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><p class="my-5 leading-7 text-pretty"><!--[-->By structuring data this way, teams can move from raw information to actionable insights with clarity and confidence.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->At this tutorial, it&#39;s important to understand the data relationships that form the backbone of most e-commerce
systems. These relationships define how information flows across entities — from customers placing orders to
products being sold and analyzed.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->Here’s the simplified schema we’ll use throughout this tutorial:<!--]--></p><div class="relative my-5 overflow-x-auto"><table class="w-full border-separate border-spacing-0 rounded-md"><!--[--><thead class="bg-muted"><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->From<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->To<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Relationship Type<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->customers(id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->orders(customer_id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->1:N (One-to-Many)<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->orders(id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->order_items(order_id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->1:N (One-to-Many)<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->products(id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->product_variants(product_id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->1:N (One-to-Many)<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->product_variants(id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->order_items(variant_id)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->1:N (One-to-Many)<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><!--[--><!----><div class="relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md"><ul class="isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto" tabindex="-1" data-orientation="vertical" dir="ltr" style="outline:none;" role="tree"><!--[--><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="true" aria-level="1" data-indent="1" data-selected data-expanded><!--[--><button type="button" data-expanded="true" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 text-highlighted before:bg-elevated"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">customers.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">order_items.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">orders.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">product_variants.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">products.sql</span><!----></button><!----><!--]--></li><!--]--><!--]--></ul><div class="overflow-hidden lg:col-span-2 flex flex-col [&amp;&gt;div]:my-0 [&amp;&gt;div]:flex-1 [&amp;&gt;div]:flex [&amp;&gt;div]:flex-col [&amp;&gt;div&gt;div]:border-0 [&amp;&gt;div&gt;pre]:border-b-0 [&amp;&gt;div&gt;pre]:border-s-0 [&amp;&gt;div&gt;pre]:border-e-0 [&amp;&gt;div&gt;pre]:rounded-l-none [&amp;&gt;div&gt;pre]:flex-1 [&amp;&gt;div]:overflow-y-auto"><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="text-default text-sm/6">customers.sql</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sbssI">CREATE</span><span class="sbssI"> TABLE</span><span class="s2Zo4"> IF</span><span class="sbssI"> NOT</span><span class="sbssI"> EXISTS</span><span class="sTEyZ"> customers (
</span></span><span class="line" line="2"><span class="sTEyZ">    id          </span><span class="spNyl">BIGSERIAL</span><span class="spNyl"> PRIMARY KEY</span><span class="sTEyZ">,
</span></span><span class="line" line="3"><span class="sTEyZ">    full_name   </span><span class="spNyl">TEXT</span><span class="sbssI">        NOT NULL</span><span class="sTEyZ">,
</span></span><span class="line" line="4"><span class="sTEyZ">    email       </span><span class="spNyl">TEXT</span><span class="sbssI">        NOT NULL</span><span class="sbssI"> UNIQUE</span><span class="sTEyZ">,
</span></span><span class="line" line="5"><span class="sTEyZ">    country     </span><span class="spNyl">TEXT</span><span class="sbssI">        NOT NULL</span><span class="sTEyZ">,
</span></span><span class="line" line="6"><span class="sTEyZ">    age         </span><span class="spNyl">INTEGER</span><span class="sbssI">     NOT NULL</span><span class="spNyl"> CHECK</span><span class="sTEyZ"> (age </span><span class="sMK4o">&gt;=</span><span class="sbssI"> 0</span><span class="sTEyZ">),
</span></span><span class="line" line="7"><span class="sTEyZ">    created_at  </span><span class="spNyl">TIMESTAMPTZ</span><span class="sbssI"> NOT NULL</span><span class="spNyl"> DEFAULT</span><span class="sbssI"> now</span><span class="sMK4o">()</span><span class="sTEyZ">,
</span></span><span class="line" line="8"><span class="sTEyZ">    updated_at  </span><span class="spNyl">TIMESTAMPTZ</span><span class="sbssI"> NOT NULL</span><span class="spNyl"> DEFAULT</span><span class="sbssI"> now</span><span class="sMK4o">()
</span></span><span class="line" line="9"><span class="sTEyZ">);
</span></span></code><!--]--></pre></div></div></div><!--]--><p class="my-5 leading-7 text-pretty"><!--[-->This model mirrors a real-world e-commerce workflow:<!--]--></p><ul class="list-disc ps-6 my-5 marker:text-(--ui-border-accented)"><!--[--><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->A customer makes one or more orders.<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Each order contains one or more items.<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Each item points to a specific product variant (like a red T-shirt, size M).<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Each variant belongs to a broader product (e.g., “Classic T-Shirt”).<!--]--></li><!--]--></ul><p class="my-5 leading-7 text-pretty"><!--[-->These foreign key relationships allow us to join datasets efficiently and enable downstream analytics like:<!--]--></p><div class="relative my-5 overflow-x-auto"><table class="w-full border-separate border-spacing-0 rounded-md"><!--[--><thead class="bg-muted"><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted" align="left"><!--[-->Domain<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Materialized Table<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Depends On<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5" align="left"><!--[-->Customers<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->mart.customers_by_age<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.customers<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5" align="left"><!--[-->Customers<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->mart.customers_by_country<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.customers<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5" align="left"><!--[-->Products<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->mart.revenue_by_product<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->raw.order_items<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->raw.product_variants<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->raw.products<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5" align="left"><!--[-->Products<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->mart.revenue_by_category<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->raw.order_items<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->raw.product_variants<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->raw.products<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5" align="left"><!--[-->Products<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->mart.revenue_by_product_variant<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.product_variants<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.order_items<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.orders<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.products<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5" align="left"><!--[-->Sales<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->mart.sales_daily<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.order_items<!--]--></code>, <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->stg.orders<!--]--></code><!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><p class="my-5 leading-7 text-pretty"><!--[-->By establishing these links early, every layer of the pipeline — raw, staging, and mart — can remain consistent and
traceable across transformations.<!--]--></p><h2 id="_3-setting-up-the-source-database-docker-postgres" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_3-setting-up-the-source-database-docker-postgres" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->3) Setting Up the Source Database (Docker + Postgres)<!--]--></a></h2><p class="my-5 leading-7 text-pretty"><!--[-->First, let&#39;s spin up our PostgreSQL instance:<!--]--></p><div dir="ltr" data-orientation="horizontal" class="relative group *:not-first:!my-0 *:not-first:!static my-5"><!--[--><div class="relative flex items-center gap-1 border border-muted bg-default border-b-0 rounded-t-md overflow-x-auto p-2" tabindex="-1" data-orientation="horizontal" dir="ltr" style="outline:none;" role="tablist" aria-orientation="horizontal"><!--[--><!--v-if--><!--[--><button class="relative inline-flex items-center gap-1.5 text-default data-[state=active]:text-highlighted hover:bg-elevated/50 px-2 py-1.5 text-sm rounded-md disabled:cursor-not-allowed disabled:opacity-75 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary focus:outline-none transition-colors" data-reka-collection-item tabindex="-1" data-orientation="horizontal" data-active id="reka-tabs-v-0-5-4-0-28-0-trigger-0" role="tab" type="button" aria-selected="true" aria-controls="reka-tabs-v-0-5-4-0-28-0-content-0" data-state="active"><!--[--><!----><span class="truncate">Docker Run</span><!--]--></button><button class="relative inline-flex items-center gap-1.5 text-default data-[state=active]:text-highlighted hover:bg-elevated/50 px-2 py-1.5 text-sm rounded-md disabled:cursor-not-allowed disabled:opacity-75 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary focus:outline-none transition-colors" data-reka-collection-item tabindex="-1" data-orientation="horizontal" id="reka-tabs-v-0-5-4-0-28-0-trigger-1" role="tab" type="button" aria-selected="false" aria-controls="reka-tabs-v-0-5-4-0-28-0-content-1" data-state="inactive"><!--[--><!----><span class="truncate">Docker Compose</span><!--]--></button><button class="relative inline-flex items-center gap-1.5 text-default data-[state=active]:text-highlighted hover:bg-elevated/50 px-2 py-1.5 text-sm rounded-md disabled:cursor-not-allowed disabled:opacity-75 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary focus:outline-none transition-colors" data-reka-collection-item tabindex="-1" data-orientation="horizontal" id="reka-tabs-v-0-5-4-0-28-0-trigger-2" role="tab" type="button" aria-selected="false" aria-controls="reka-tabs-v-0-5-4-0-28-0-content-2" data-state="inactive"><!--[--><!----><span class="truncate">Makefile</span><!--]--></button><!--]--><!--]--></div><!--[--><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" id="reka-tabs-v-0-5-4-0-28-0-content-0" role="tabpanel" data-state="active" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-28-0-trigger-0" tabindex="-1" style="animation-duration:0s;"><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" id="reka-tabs-v-0-5-4-0-28-0-content-0" role="tabpanel" data-state="active" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-28-0-trigger-0" tabindex="-1" style="animation-duration:0s;"><!--[--><code><span class="line" line="1"><span class="sBMFI">docker</span><span class="sfazB"> run</span><span class="sfazB"> -d</span><span class="sTEyZ"> \
</span></span><span class="line" line="2"><span class="sfazB">  --name</span><span class="sfazB"> bruin-postgres</span><span class="sTEyZ"> \
</span></span><span class="line" line="3"><span class="sfazB">  -e</span><span class="sfazB"> POSTGRES_USER=postgres</span><span class="sTEyZ"> \
</span></span><span class="line" line="4"><span class="sfazB">  -e</span><span class="sfazB"> POSTGRES_PASSWORD=postgres</span><span class="sTEyZ"> \
</span></span><span class="line" line="5"><span class="sfazB">  -e</span><span class="sfazB"> POSTGRES_DB=postgres</span><span class="sTEyZ"> \
</span></span><span class="line" line="6"><span class="sfazB">  -p</span><span class="sfazB"> 5432:5432</span><span class="sTEyZ"> \
</span></span><span class="line" line="7"><span class="sfazB">  postgres:18-alpine
</span></span></code><!--]--></pre></div><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" id="reka-tabs-v-0-5-4-0-28-0-content-1" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-28-0-trigger-1" hidden tabindex="-1" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" id="reka-tabs-v-0-5-4-0-28-0-content-1" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-28-0-trigger-1" hidden tabindex="-1" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">docker</span><span class="sfazB"> compose</span><span class="sfazB"> up</span><span class="sfazB"> -d
</span></span></code><!--]--></pre></div><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" id="reka-tabs-v-0-5-4-0-28-0-content-2" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-28-0-trigger-2" hidden tabindex="-1" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" id="reka-tabs-v-0-5-4-0-28-0-content-2" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-28-0-trigger-2" hidden tabindex="-1" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">make</span><span class="sfazB"> docker-up
</span></span></code><!--]--></pre></div><!--]--><!--]--></div><p class="my-5 leading-7 text-pretty"><!--[-->Now, we must ingest the DDL inside the PostgresSQL instance:<!--]--></p><div dir="ltr" data-orientation="horizontal" class="relative group *:not-first:!my-0 *:not-first:!static my-5"><!--[--><div class="relative flex items-center gap-1 border border-muted bg-default border-b-0 rounded-t-md overflow-x-auto p-2" tabindex="-1" data-orientation="horizontal" dir="ltr" style="outline:none;" role="tablist" aria-orientation="horizontal"><!--[--><!--v-if--><!--[--><button class="relative inline-flex items-center gap-1.5 text-default data-[state=active]:text-highlighted hover:bg-elevated/50 px-2 py-1.5 text-sm rounded-md disabled:cursor-not-allowed disabled:opacity-75 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary focus:outline-none transition-colors" data-reka-collection-item tabindex="-1" data-orientation="horizontal" data-active id="reka-tabs-v-0-5-4-0-30-0-trigger-0" role="tab" type="button" aria-selected="true" aria-controls="reka-tabs-v-0-5-4-0-30-0-content-0" data-state="active"><!--[--><!----><span class="truncate">Docker Exec</span><!--]--></button><button class="relative inline-flex items-center gap-1.5 text-default data-[state=active]:text-highlighted hover:bg-elevated/50 px-2 py-1.5 text-sm rounded-md disabled:cursor-not-allowed disabled:opacity-75 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary focus:outline-none transition-colors" data-reka-collection-item tabindex="-1" data-orientation="horizontal" id="reka-tabs-v-0-5-4-0-30-0-trigger-1" role="tab" type="button" aria-selected="false" aria-controls="reka-tabs-v-0-5-4-0-30-0-content-1" data-state="inactive"><!--[--><!----><span class="truncate">Makefile</span><!--]--></button><!--]--><!--]--></div><!--[--><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" id="reka-tabs-v-0-5-4-0-30-0-content-0" role="tabpanel" data-state="active" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-30-0-trigger-0" tabindex="-1" style="animation-duration:0s;"><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" id="reka-tabs-v-0-5-4-0-30-0-content-0" role="tabpanel" data-state="active" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-30-0-trigger-0" tabindex="-1" style="animation-duration:0s;"><!--[--><code><span class="line" line="1"><span class="sBMFI">cat</span><span class="sfazB"> sql/ddl.sql</span><span class="sMK4o"> |</span><span class="sBMFI"> docker</span><span class="sfazB"> exec</span><span class="sfazB"> -i</span><span class="sfazB"> bruin-ecommerce</span><span class="sfazB"> psql</span><span class="sfazB"> -U</span><span class="sfazB"> postgres</span><span class="sfazB"> -d</span><span class="sfazB"> postgres
</span></span></code><!--]--></pre></div><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" id="reka-tabs-v-0-5-4-0-30-0-content-1" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-30-0-trigger-1" hidden tabindex="-1" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" id="reka-tabs-v-0-5-4-0-30-0-content-1" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-30-0-trigger-1" hidden tabindex="-1" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">make</span><span class="sfazB"> db-migrate
</span></span></code><!--]--></pre></div><!--]--><!--]--></div><div class="group relative block px-4 py-3 rounded-md text-sm/6 last:mb-0 [&amp;_code]:text-xs/5 [&amp;_code]:bg-default [&amp;_pre]:bg-default [&amp;&gt;div]:my-2.5 [&amp;_ul]:my-2.5 [&amp;_ol]:my-2.5 [&amp;&gt;*]:last:!mb-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:my-0 transition-colors border border-info/25 bg-info/10 text-info-600 dark:text-info-300 [&amp;_a]:text-info [&amp;_a]:hover:border-info [&amp;_code]:text-info-600 dark:[&amp;_code]:text-info-300 [&amp;_code]:border-info/25 [&amp;_a]:hover:[&amp;&gt;code]:border-info [&amp;_a]:hover:[&amp;&gt;code]:text-info [&amp;&gt;ul]:marker:text-info/50 w-full my-0"><!----><span class="iconify i-lucide:info size-4 shrink-0 align-sub me-1.5 transition-colors text-info" aria-hidden="true" style=""></span><!----><!--[--><!--[-->If you&#39;re using Makefile, check the commands available using <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->make help<!--]--></code><!--]--><!--]--></div><h2 id="_4-populating-test-data" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_4-populating-test-data" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->4) Populating Test Data<!--]--></a></h2><p class="my-5 leading-7 text-pretty"><!--[-->We’ll use Python with uv— a fast, lightweight Python environment manager — to handle dependencies and execution.
This approach lets us install only what’s needed (no global dependencies, no virtualenv folders), and it’s fully idempotent.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->Dependencies<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->Inside the project, you’ll find a script called <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->generate_data.py<!--]--></code>.
This script populates our five main tables (customers, products, product_variants, orders, and order_items) with realistic, time-distributed data that mimics an actual e-commerce platform.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->To make this possible, we rely on two lightweight Python libraries:<!--]--></p><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-diff shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span>+ faker==37     # For realistic names, emails, and categorical data
</span></span><span class="line" line="2"><span>+ psycopg==3    # For direct PostgreSQL database access
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->These are automatically handled when running with uv.<!--]--></p><div class="relative [&amp;_pre]:h-[200px] [&amp;_pre]:overflow-hidden"><!--[--><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><span class="iconify i-vscode-icons:file-type-python size-4 shrink-0" aria-hidden="true" style=""></span><span class="text-default text-sm/6">generate_data.py</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-python shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sHwdD">#!/usr/bin/env python3
</span></span><span class="line" line="2"><span class="s7zQu">&quot;&quot;&quot;
</span></span><span class="line" line="3"><span class="sHwdD">E-commerce demo data generator (Postgres).
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span class="sHwdD">Usage:
</span></span><span class="line" line="6"><span class="sHwdD">    uv run generate-data --dsn postgresql://user:pass@host:5432/db
</span></span><span class="line" line="7"><span class="s7zQu">&quot;&quot;&quot;
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span class="s7zQu">import</span><span class="sTEyZ"> argparse</span><span class="sMK4o">,</span><span class="sTEyZ"> random
</span></span><span class="line" line="10"><span class="s7zQu">from</span><span class="sTEyZ"> datetime </span><span class="s7zQu">import</span><span class="sTEyZ"> datetime</span><span class="sMK4o">,</span><span class="sTEyZ"> timedelta</span><span class="sMK4o">,</span><span class="sTEyZ"> timezone
</span></span><span class="line" line="11"><span class="s7zQu">from</span><span class="sTEyZ"> faker </span><span class="s7zQu">import</span><span class="sTEyZ"> Faker
</span></span><span class="line" line="12"><span class="s7zQu">import</span><span class="sTEyZ"> psycopg
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span class="sHwdD"># -------------------------------------------------------------------
</span></span><span class="line" line="15"><span class="sHwdD"># GLOBAL CONFIGURATION
</span></span><span class="line" line="16"><span class="sHwdD"># -------------------------------------------------------------------
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span class="sTEyZ">fake </span><span class="sMK4o">=</span><span class="s2Zo4"> Faker</span><span class="sMK4o">()
</span></span><span class="line" line="19"><span emptylineplaceholder="true">
</span></span><span class="line" line="20"><span class="sHwdD"># --- Static categorical constants ---
</span></span><span class="line" line="21"><span class="sTEyZ">PRODUCT_CATEGORIES </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sMK4o">&quot;</span><span class="sfazB">t-shirts</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">hoodies</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">shoes</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">accessories</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">jackets</span><span class="sMK4o">&quot;</span><span class="sMK4o">]
</span></span><span class="line" line="22"><span class="sTEyZ">COLORS </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sMK4o">&quot;</span><span class="sfazB">Red</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">Blue</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">Black</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">White</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">Green</span><span class="sMK4o">&quot;</span><span class="sMK4o">]
</span></span><span class="line" line="23"><span class="sTEyZ">SIZES_APPAREL </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sMK4o">&quot;</span><span class="sfazB">S</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">M</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">L</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">XL</span><span class="sMK4o">&quot;</span><span class="sMK4o">]
</span></span><span class="line" line="24"><span class="sTEyZ">SIZES_SHOES </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sbssI">36</span><span class="sMK4o">,</span><span class="sbssI"> 38</span><span class="sMK4o">,</span><span class="sbssI"> 40</span><span class="sMK4o">,</span><span class="sbssI"> 42</span><span class="sMK4o">,</span><span class="sbssI"> 44</span><span class="sMK4o">]
</span></span><span class="line" line="25"><span class="sTEyZ">ORDER_STATUSES </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sMK4o">&quot;</span><span class="sfazB">pending</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">paid</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">cancelled</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> &quot;</span><span class="sfazB">shipped</span><span class="sMK4o">&quot;</span><span class="sMK4o">]
</span></span><span class="line" line="26"><span class="sTEyZ">ORDER_STATUS_WEIGHTS </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sbssI">0.2</span><span class="sMK4o">,</span><span class="sbssI"> 0.5</span><span class="sMK4o">,</span><span class="sbssI"> 0.1</span><span class="sMK4o">,</span><span class="sbssI"> 0.2</span><span class="sMK4o">]
</span></span><span class="line" line="27"><span emptylineplaceholder="true">
</span></span><span class="line" line="28"><span class="sHwdD"># --- SQL Statements ---
</span></span><span class="line" line="29"><span class="sTEyZ">SQL_INSERT_CUSTOMERS </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="30"><span class="sfazB">                       INSERT INTO customers(full_name, email, country, age, created_at, updated_at)
</span></span><span class="line" line="31"><span class="sfazB">                       VALUES (</span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">) ON CONFLICT (email) DO
</span></span><span class="line" line="32"><span class="sfazB">                       UPDATE
</span></span><span class="line" line="33"><span class="sfazB">                           SET full_name=EXCLUDED.full_name, country=EXCLUDED.country,
</span></span><span class="line" line="34"><span class="sfazB">                           age=EXCLUDED.age, updated_at=EXCLUDED.updated_at; </span><span class="sMK4o">\
</span></span><span class="line" line="35"><span class="sMK4o">                       &quot;&quot;&quot;
</span></span><span class="line" line="36"><span emptylineplaceholder="true">
</span></span><span class="line" line="37"><span class="sTEyZ">SQL_INSERT_PRODUCTS </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="38"><span class="sfazB">                      INSERT INTO products(name, category, sku, created_at, updated_at)
</span></span><span class="line" line="39"><span class="sfazB">                      VALUES (</span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">) ON CONFLICT (sku) DO
</span></span><span class="line" line="40"><span class="sfazB">                      UPDATE
</span></span><span class="line" line="41"><span class="sfazB">                          SET name=EXCLUDED.name, category=EXCLUDED.category,
</span></span><span class="line" line="42"><span class="sfazB">                          updated_at=EXCLUDED.updated_at; </span><span class="sMK4o">\
</span></span><span class="line" line="43"><span class="sMK4o">                      &quot;&quot;&quot;
</span></span><span class="line" line="44"><span emptylineplaceholder="true">
</span></span><span class="line" line="45"><span class="sTEyZ">SQL_INSERT_VARIANTS </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="46"><span class="sfazB">                      INSERT INTO product_variants
</span></span><span class="line" line="47"><span class="sfazB">                      (product_id, variant_sku, color, size, manufacturing_price, selling_price,
</span></span><span class="line" line="48"><span class="sfazB">                       stock_quantity, is_active, created_at, updated_at)
</span></span><span class="line" line="49"><span class="sfazB">                      VALUES (</span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">) ON CONFLICT (variant_sku) DO
</span></span><span class="line" line="50"><span class="sfazB">                      UPDATE
</span></span><span class="line" line="51"><span class="sfazB">                          SET color=EXCLUDED.color, size =EXCLUDED.size,
</span></span><span class="line" line="52"><span class="sfazB">                          manufacturing_price=EXCLUDED.manufacturing_price,
</span></span><span class="line" line="53"><span class="sfazB">                          selling_price=EXCLUDED.selling_price,
</span></span><span class="line" line="54"><span class="sfazB">                          stock_quantity=EXCLUDED.stock_quantity,
</span></span><span class="line" line="55"><span class="sfazB">                          updated_at=EXCLUDED.updated_at; </span><span class="sMK4o">\
</span></span><span class="line" line="56"><span class="sMK4o">                      &quot;&quot;&quot;
</span></span><span class="line" line="57"><span emptylineplaceholder="true">
</span></span><span class="line" line="58"><span class="sTEyZ">SQL_DELETE_ORDERS_IN_WINDOW </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;</span><span class="sfazB">DELETE FROM orders WHERE order_date BETWEEN </span><span class="sbssI">%s</span><span class="sfazB"> AND </span><span class="sbssI">%s</span><span class="sfazB">;</span><span class="sMK4o">&quot;
</span></span><span class="line" line="59"><span emptylineplaceholder="true">
</span></span><span class="line" line="60"><span class="sTEyZ">SQL_INSERT_ORDERS </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="61"><span class="sfazB">                    INSERT INTO orders(customer_id, order_date, status, total_amount, created_at, updated_at)
</span></span><span class="line" line="62"><span class="sfazB">                    VALUES (</span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">); </span><span class="sMK4o">\
</span></span><span class="line" line="63"><span class="sMK4o">                    &quot;&quot;&quot;
</span></span><span class="line" line="64"><span emptylineplaceholder="true">
</span></span><span class="line" line="65"><span class="sTEyZ">SQL_INSERT_ORDER_ITEMS </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="66"><span class="sfazB">                         INSERT INTO order_items(order_id, variant_id, quantity, unit_price, created_at)
</span></span><span class="line" line="67"><span class="sfazB">                         VALUES (</span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">, </span><span class="sbssI">%s</span><span class="sfazB">); </span><span class="sMK4o">\
</span></span><span class="line" line="68"><span class="sMK4o">                         &quot;&quot;&quot;
</span></span><span class="line" line="69"><span emptylineplaceholder="true">
</span></span><span class="line" line="70"><span class="sTEyZ">SQL_UPDATE_ORDER_TOTALS </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="71"><span class="sfazB">                          UPDATE orders o
</span></span><span class="line" line="72"><span class="sfazB">                          SET total_amount = COALESCE(oi.sum_total, 0) FROM (
</span></span><span class="line" line="73"><span class="sfazB">  SELECT order_id, SUM(total_price) sum_total
</span></span><span class="line" line="74"><span class="sfazB">  FROM order_items GROUP BY order_id
</span></span><span class="line" line="75"><span class="sfazB">) oi
</span></span><span class="line" line="76"><span class="sfazB">                          WHERE o.id = oi.order_id
</span></span><span class="line" line="77"><span class="sfazB">                            AND o.order_date BETWEEN </span><span class="sbssI">%s
</span></span><span class="line" line="78"><span class="sfazB">                            AND </span><span class="sbssI">%s</span><span class="sfazB">; </span><span class="sMK4o">\
</span></span><span class="line" line="79"><span class="sMK4o">                          &quot;&quot;&quot;
</span></span><span class="line" line="80"><span emptylineplaceholder="true">
</span></span><span class="line" line="81"><span class="sTEyZ">SQL_STATS_COUNTS </span><span class="sMK4o">=</span><span class="sMK4o"> {
</span></span><span class="line" line="82"><span class="sMK4o">    &quot;</span><span class="sfazB">customers</span><span class="sMK4o">&quot;</span><span class="sMK4o">:</span><span class="sMK4o"> &quot;</span><span class="sfazB">SELECT COUNT(*) FROM customers</span><span class="sMK4o">&quot;</span><span class="sMK4o">,
</span></span><span class="line" line="83"><span class="sMK4o">    &quot;</span><span class="sfazB">products</span><span class="sMK4o">&quot;</span><span class="sMK4o">:</span><span class="sMK4o"> &quot;</span><span class="sfazB">SELECT COUNT(*) FROM products</span><span class="sMK4o">&quot;</span><span class="sMK4o">,
</span></span><span class="line" line="84"><span class="sMK4o">    &quot;</span><span class="sfazB">variants</span><span class="sMK4o">&quot;</span><span class="sMK4o">:</span><span class="sMK4o"> &quot;</span><span class="sfazB">SELECT COUNT(*) FROM product_variants</span><span class="sMK4o">&quot;</span><span class="sMK4o">,
</span></span><span class="line" line="85"><span class="sMK4o">    &quot;</span><span class="sfazB">orders</span><span class="sMK4o">&quot;</span><span class="sMK4o">:</span><span class="sMK4o"> &quot;</span><span class="sfazB">SELECT COUNT(*) FROM orders WHERE order_date BETWEEN </span><span class="sbssI">%s</span><span class="sfazB"> AND </span><span class="sbssI">%s</span><span class="sMK4o">&quot;</span><span class="sMK4o">,
</span></span><span class="line" line="86"><span class="sMK4o">    &quot;</span><span class="sfazB">items</span><span class="sMK4o">&quot;</span><span class="sMK4o">:</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="87"><span class="sfazB">             SELECT COUNT(*)
</span></span><span class="line" line="88"><span class="sfazB">             FROM order_items oi
</span></span><span class="line" line="89"><span class="sfazB">                      JOIN orders o ON o.id = oi.order_id
</span></span><span class="line" line="90"><span class="sfazB">             WHERE o.order_date BETWEEN </span><span class="sbssI">%s</span><span class="sfazB"> AND </span><span class="sbssI">%s</span><span class="sfazB">;
</span></span><span class="line" line="91"><span class="sMK4o">             &quot;&quot;&quot;</span><span class="sMK4o">,
</span></span><span class="line" line="92"><span class="sMK4o">}
</span></span><span class="line" line="93"><span emptylineplaceholder="true">
</span></span><span class="line" line="94"><span class="sTEyZ">SQL_CHAOS_VALIDATION </span><span class="sMK4o">=</span><span class="sMK4o"> &quot;&quot;&quot;
</span></span><span class="line" line="95"><span class="sfazB">                       SELECT p.category,
</span></span><span class="line" line="96"><span class="sfazB">                              SUM(CASE
</span></span><span class="line" line="97"><span class="sfazB">                                      WHEN (p.category = &#39;shoes&#39; AND v.size !~ &#39;^[0-9]+$&#39;)
</span></span><span class="line" line="98"><span class="sfazB">                                          OR (p.category &lt;&gt; &#39;shoes&#39; AND v.size NOT IN (&#39;S&#39;, &#39;M&#39;, &#39;L&#39;, &#39;XL&#39;))
</span></span><span class="line" line="99"><span class="sfazB">                                          THEN 1
</span></span><span class="line" line="100"><span class="sfazB">                                      ELSE 0 END) invalid
</span></span><span class="line" line="101"><span class="sfazB">                       FROM product_variants v
</span></span><span class="line" line="102"><span class="sfazB">                                JOIN products p ON p.id = v.product_id
</span></span><span class="line" line="103"><span class="sfazB">                       GROUP BY 1
</span></span><span class="line" line="104"><span class="sfazB">                       ORDER BY 1; </span><span class="sMK4o">\
</span></span><span class="line" line="105"><span class="sMK4o">                       &quot;&quot;&quot;
</span></span><span class="line" line="106"><span emptylineplaceholder="true">
</span></span><span class="line" line="107"><span emptylineplaceholder="true">
</span></span><span class="line" line="108"><span class="spNyl">def</span><span class="s2Zo4"> parse_args</span><span class="sMK4o">():
</span></span><span class="line" line="109"><span class="sTEyZ">    now </span><span class="sMK4o">=</span><span class="sTEyZ"> datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">)
</span></span><span class="line" line="110"><span class="sTEyZ">    day_start </span><span class="sMK4o">=</span><span class="sTEyZ"> now</span><span class="sMK4o">.</span><span class="s2Zo4">replace</span><span class="sMK4o">(</span><span class="sHdIc">hour</span><span class="sMK4o">=</span><span class="sbssI">0</span><span class="sMK4o">,</span><span class="sHdIc"> minute</span><span class="sMK4o">=</span><span class="sbssI">0</span><span class="sMK4o">,</span><span class="sHdIc"> second</span><span class="sMK4o">=</span><span class="sbssI">0</span><span class="sMK4o">,</span><span class="sHdIc"> microsecond</span><span class="sMK4o">=</span><span class="sbssI">0</span><span class="sMK4o">)
</span></span><span class="line" line="111"><span class="sTEyZ">    day_end </span><span class="sMK4o">=</span><span class="sTEyZ"> now</span><span class="sMK4o">.</span><span class="s2Zo4">replace</span><span class="sMK4o">(</span><span class="sHdIc">hour</span><span class="sMK4o">=</span><span class="sbssI">23</span><span class="sMK4o">,</span><span class="sHdIc"> minute</span><span class="sMK4o">=</span><span class="sbssI">59</span><span class="sMK4o">,</span><span class="sHdIc"> second</span><span class="sMK4o">=</span><span class="sbssI">59</span><span class="sMK4o">,</span><span class="sHdIc"> microsecond</span><span class="sMK4o">=</span><span class="sbssI">999999</span><span class="sMK4o">)
</span></span><span class="line" line="112"><span emptylineplaceholder="true">
</span></span><span class="line" line="113"><span class="sTEyZ">    p </span><span class="sMK4o">=</span><span class="sTEyZ"> argparse</span><span class="sMK4o">.</span><span class="s2Zo4">ArgumentParser</span><span class="sMK4o">(</span><span class="sHdIc">description</span><span class="sMK4o">=</span><span class="sMK4o">&quot;</span><span class="sfazB">Generate demo ecommerce data (idempotent).</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="114"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--dsn</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> required</span><span class="sMK4o">=True,</span><span class="sHdIc"> help</span><span class="sMK4o">=</span><span class="sMK4o">&quot;</span><span class="sfazB">PostgreSQL DSN</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="115"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--customers</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">int</span><span class="sMK4o">,</span><span class="sHdIc"> default</span><span class="sMK4o">=</span><span class="sbssI">100</span><span class="sMK4o">)
</span></span><span class="line" line="116"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--products</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">int</span><span class="sMK4o">,</span><span class="sHdIc"> default</span><span class="sMK4o">=</span><span class="sbssI">50</span><span class="sMK4o">)
</span></span><span class="line" line="117"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--orders</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">int</span><span class="sMK4o">,</span><span class="sHdIc"> default</span><span class="sMK4o">=</span><span class="sbssI">500</span><span class="sMK4o">)
</span></span><span class="line" line="118"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--max-items-per-order</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">int</span><span class="sMK4o">,</span><span class="sHdIc"> default</span><span class="sMK4o">=</span><span class="sbssI">5</span><span class="sMK4o">)
</span></span><span class="line" line="119"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--chaos-percent</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">float</span><span class="sMK4o">,</span><span class="sHdIc"> default</span><span class="sMK4o">=</span><span class="sbssI">0.0</span><span class="sMK4o">,</span><span class="sHdIc"> help</span><span class="sMK4o">=</span><span class="sMK4o">&quot;</span><span class="sbssI">%%</span><span class="sfazB"> of variants with invalid sizes</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="120"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--scale</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">int</span><span class="sMK4o">,</span><span class="sHdIc"> default</span><span class="sMK4o">=</span><span class="sbssI">1</span><span class="sMK4o">,</span><span class="sHdIc"> help</span><span class="sMK4o">=</span><span class="sMK4o">&quot;</span><span class="sfazB">Multiply base volumes</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="121"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--seed</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">int</span><span class="sMK4o">,</span><span class="sHdIc"> default</span><span class="sMK4o">=</span><span class="sbssI">42</span><span class="sMK4o">,</span><span class="sHdIc"> help</span><span class="sMK4o">=</span><span class="sMK4o">&quot;</span><span class="sfazB">Deterministic RNG seed</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="122"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--starting-at</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">str</span><span class="sMK4o">,</span><span class="sHdIc"> help</span><span class="sMK4o">=</span><span class="sMK4o">&quot;</span><span class="sfazB">ISO start (e.g. 2024-01-01)</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="123"><span class="sTEyZ">    p</span><span class="sMK4o">.</span><span class="s2Zo4">add_argument</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">--ending-at</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sHdIc"> type</span><span class="sMK4o">=</span><span class="sBMFI">str</span><span class="sMK4o">,</span><span class="sHdIc"> help</span><span class="sMK4o">=</span><span class="sMK4o">&quot;</span><span class="sfazB">ISO end (e.g. 2024-06-30)</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="124"><span emptylineplaceholder="true">
</span></span><span class="line" line="125"><span class="sTEyZ">    a </span><span class="sMK4o">=</span><span class="sTEyZ"> p</span><span class="sMK4o">.</span><span class="s2Zo4">parse_args</span><span class="sMK4o">()
</span></span><span class="line" line="126"><span class="sTEyZ">    a</span><span class="sMK4o">.</span><span class="swJcz">starting_at</span><span class="sMK4o"> =</span><span class="sTEyZ"> a</span><span class="sMK4o">.</span><span class="swJcz">starting_at</span><span class="sMK4o"> or</span><span class="sTEyZ"> day_start</span><span class="sMK4o">.</span><span class="s2Zo4">isoformat</span><span class="sMK4o">()
</span></span><span class="line" line="127"><span class="sTEyZ">    a</span><span class="sMK4o">.</span><span class="swJcz">ending_at</span><span class="sMK4o"> =</span><span class="sTEyZ"> a</span><span class="sMK4o">.</span><span class="swJcz">ending_at</span><span class="sMK4o"> or</span><span class="sTEyZ"> day_end</span><span class="sMK4o">.</span><span class="s2Zo4">isoformat</span><span class="sMK4o">()
</span></span><span class="line" line="128"><span class="s7zQu">    return</span><span class="sTEyZ"> a
</span></span><span class="line" line="129"><span emptylineplaceholder="true">
</span></span><span class="line" line="130"><span emptylineplaceholder="true">
</span></span><span class="line" line="131"><span class="spNyl">def</span><span class="s2Zo4"> iso</span><span class="sMK4o">(</span><span class="sHdIc">dt</span><span class="sMK4o">):
</span></span><span class="line" line="132"><span class="s7zQu">    return</span><span class="sTEyZ"> datetime</span><span class="sMK4o">.</span><span class="s2Zo4">fromisoformat</span><span class="sMK4o">(</span><span class="s2Zo4">dt</span><span class="sMK4o">).</span><span class="s2Zo4">astimezone</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">)
</span></span><span class="line" line="133"><span emptylineplaceholder="true">
</span></span><span class="line" line="134"><span emptylineplaceholder="true">
</span></span><span class="line" line="135"><span class="spNyl">def</span><span class="s2Zo4"> rdate</span><span class="sMK4o">(</span><span class="sHdIc">s</span><span class="sMK4o">,</span><span class="sHdIc"> e</span><span class="sMK4o">):
</span></span><span class="line" line="136"><span class="s7zQu">    &quot;&quot;&quot;</span><span class="sHwdD">Return random datetime between s and e.</span><span class="s7zQu">&quot;&quot;&quot;
</span></span><span class="line" line="137"><span class="s7zQu">    return</span><span class="sTEyZ"> s </span><span class="sMK4o">+</span><span class="s2Zo4"> timedelta</span><span class="sMK4o">(</span><span class="sHdIc">seconds</span><span class="sMK4o">=</span><span class="s2Zo4">random</span><span class="sMK4o">.</span><span class="s2Zo4">randint</span><span class="sMK4o">(</span><span class="sbssI">0</span><span class="sMK4o">,</span><span class="sBMFI"> int</span><span class="sMK4o">((</span><span class="s2Zo4">e </span><span class="sMK4o">-</span><span class="s2Zo4"> s</span><span class="sMK4o">).</span><span class="s2Zo4">total_seconds</span><span class="sMK4o">())))
</span></span><span class="line" line="138"><span emptylineplaceholder="true">
</span></span><span class="line" line="139"><span emptylineplaceholder="true">
</span></span><span class="line" line="140"><span class="spNyl">def</span><span class="s2Zo4"> execmany</span><span class="sMK4o">(</span><span class="sHdIc">conn</span><span class="sMK4o">,</span><span class="sHdIc"> sql</span><span class="sMK4o">,</span><span class="sHdIc"> rows</span><span class="sMK4o">):
</span></span><span class="line" line="141"><span class="s7zQu">    with</span><span class="sTEyZ"> conn</span><span class="sMK4o">.</span><span class="s2Zo4">cursor</span><span class="sMK4o">()</span><span class="s7zQu"> as</span><span class="sTEyZ"> cur</span><span class="sMK4o">:
</span></span><span class="line" line="142"><span class="sTEyZ">        cur</span><span class="sMK4o">.</span><span class="s2Zo4">executemany</span><span class="sMK4o">(</span><span class="s2Zo4">sql</span><span class="sMK4o">,</span><span class="s2Zo4"> rows</span><span class="sMK4o">)
</span></span><span class="line" line="143"><span class="sTEyZ">    conn</span><span class="sMK4o">.</span><span class="s2Zo4">commit</span><span class="sMK4o">()
</span></span><span class="line" line="144"><span emptylineplaceholder="true">
</span></span><span class="line" line="145"><span class="spNyl">def</span><span class="s2Zo4"> gen_customers</span><span class="sMK4o">(</span><span class="sHdIc">n</span><span class="sMK4o">):
</span></span><span class="line" line="146"><span class="s7zQu">    for</span><span class="sTEyZ"> _ </span><span class="s7zQu">in</span><span class="s2Zo4"> range</span><span class="sMK4o">(</span><span class="s2Zo4">n</span><span class="sMK4o">):
</span></span><span class="line" line="147"><span class="s7zQu">        yield</span><span class="sMK4o"> (
</span></span><span class="line" line="148"><span class="sTEyZ">            fake</span><span class="sMK4o">.</span><span class="s2Zo4">name</span><span class="sMK4o">(),
</span></span><span class="line" line="149"><span class="sTEyZ">            fake</span><span class="sMK4o">.</span><span class="swJcz">unique</span><span class="sMK4o">.</span><span class="s2Zo4">email</span><span class="sMK4o">(),
</span></span><span class="line" line="150"><span class="sTEyZ">            fake</span><span class="sMK4o">.</span><span class="s2Zo4">country</span><span class="sMK4o">(),
</span></span><span class="line" line="151"><span class="sTEyZ">            random</span><span class="sMK4o">.</span><span class="s2Zo4">randint</span><span class="sMK4o">(</span><span class="sbssI">18</span><span class="sMK4o">,</span><span class="sbssI"> 70</span><span class="sMK4o">),
</span></span><span class="line" line="152"><span class="sTEyZ">            datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),
</span></span><span class="line" line="153"><span class="sTEyZ">            datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),
</span></span><span class="line" line="154"><span class="sMK4o">        )
</span></span><span class="line" line="155"><span emptylineplaceholder="true">
</span></span><span class="line" line="156"><span emptylineplaceholder="true">
</span></span><span class="line" line="157"><span class="spNyl">def</span><span class="s2Zo4"> gen_products</span><span class="sMK4o">(</span><span class="sHdIc">n</span><span class="sMK4o">):
</span></span><span class="line" line="158"><span class="s7zQu">    for</span><span class="sTEyZ"> _ </span><span class="s7zQu">in</span><span class="s2Zo4"> range</span><span class="sMK4o">(</span><span class="s2Zo4">n</span><span class="sMK4o">):
</span></span><span class="line" line="159"><span class="sTEyZ">        cat </span><span class="sMK4o">=</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">choice</span><span class="sMK4o">(</span><span class="s2Zo4">PRODUCT_CATEGORIES</span><span class="sMK4o">)
</span></span><span class="line" line="160"><span class="s7zQu">        yield</span><span class="sMK4o"> (
</span></span><span class="line" line="161"><span class="spNyl">            f</span><span class="sfazB">&quot;</span><span class="sbssI">{</span><span class="sTEyZ">fake</span><span class="sMK4o">.</span><span class="s2Zo4">word</span><span class="sMK4o">().</span><span class="s2Zo4">capitalize</span><span class="sMK4o">()</span><span class="sbssI">}</span><span class="sbssI"> {</span><span class="sTEyZ">cat</span><span class="sbssI">}</span><span class="sfazB">&quot;</span><span class="sMK4o">,
</span></span><span class="line" line="162"><span class="sTEyZ">            cat</span><span class="sMK4o">,
</span></span><span class="line" line="163"><span class="sTEyZ">            fake</span><span class="sMK4o">.</span><span class="swJcz">unique</span><span class="sMK4o">.</span><span class="s2Zo4">bothify</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">SKU-####-??</span><span class="sMK4o">&quot;</span><span class="sMK4o">).</span><span class="s2Zo4">upper</span><span class="sMK4o">(),
</span></span><span class="line" line="164"><span class="sTEyZ">            datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),
</span></span><span class="line" line="165"><span class="sTEyZ">            datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),
</span></span><span class="line" line="166"><span class="sMK4o">        )
</span></span><span class="line" line="167"><span emptylineplaceholder="true">
</span></span><span class="line" line="168"><span emptylineplaceholder="true">
</span></span><span class="line" line="169"><span class="spNyl">def</span><span class="s2Zo4"> gen_variants</span><span class="sMK4o">(</span><span class="sHdIc">prod_rows</span><span class="sMK4o">,</span><span class="sHdIc"> chaos</span><span class="sMK4o">):
</span></span><span class="line" line="170"><span class="s7zQu">    for</span><span class="sTEyZ"> pid</span><span class="sMK4o">,</span><span class="sTEyZ"> cat </span><span class="s7zQu">in</span><span class="sTEyZ"> prod_rows</span><span class="sMK4o">:
</span></span><span class="line" line="171"><span class="s7zQu">        for</span><span class="sTEyZ"> _ </span><span class="s7zQu">in</span><span class="s2Zo4"> range</span><span class="sMK4o">(</span><span class="s2Zo4">random</span><span class="sMK4o">.</span><span class="s2Zo4">randint</span><span class="sMK4o">(</span><span class="sbssI">1</span><span class="sMK4o">,</span><span class="sbssI"> 4</span><span class="sMK4o">)):
</span></span><span class="line" line="172"><span class="sTEyZ">            sku </span><span class="sMK4o">=</span><span class="sTEyZ"> fake</span><span class="sMK4o">.</span><span class="swJcz">unique</span><span class="sMK4o">.</span><span class="s2Zo4">bothify</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">VAR-####-??</span><span class="sMK4o">&quot;</span><span class="sMK4o">).</span><span class="s2Zo4">upper</span><span class="sMK4o">()
</span></span><span class="line" line="173"><span class="sTEyZ">            color </span><span class="sMK4o">=</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">choice</span><span class="sMK4o">(</span><span class="s2Zo4">COLORS</span><span class="sMK4o">)
</span></span><span class="line" line="174"><span class="sTEyZ">            size </span><span class="sMK4o">=</span><span class="sBMFI"> str</span><span class="sMK4o">(</span><span class="s2Zo4">random</span><span class="sMK4o">.</span><span class="s2Zo4">choice</span><span class="sMK4o">(</span><span class="s2Zo4">SIZES_SHOES</span><span class="sMK4o">))</span><span class="s7zQu"> if</span><span class="sTEyZ"> cat </span><span class="sMK4o">==</span><span class="sMK4o"> &quot;</span><span class="sfazB">shoes</span><span class="sMK4o">&quot;</span><span class="s7zQu"> else</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">choice</span><span class="sMK4o">(</span><span class="s2Zo4">SIZES_APPAREL</span><span class="sMK4o">)
</span></span><span class="line" line="175"><span emptylineplaceholder="true">
</span></span><span class="line" line="176"><span class="sHwdD">            # Chaos mode
</span></span><span class="line" line="177"><span class="s7zQu">            if</span><span class="sTEyZ"> chaos </span><span class="sMK4o">&gt;</span><span class="sbssI"> 0</span><span class="sMK4o"> and</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">random</span><span class="sMK4o">()</span><span class="sMK4o"> &lt;</span><span class="sMK4o"> (</span><span class="sTEyZ">chaos </span><span class="sMK4o">/</span><span class="sbssI"> 100</span><span class="sMK4o">):
</span></span><span class="line" line="178"><span class="s7zQu">                if</span><span class="sTEyZ"> cat </span><span class="sMK4o">==</span><span class="sMK4o"> &quot;</span><span class="sfazB">shoes</span><span class="sMK4o">&quot;</span><span class="sMK4o">:
</span></span><span class="line" line="179"><span class="sTEyZ">                    size </span><span class="sMK4o">=</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">choice</span><span class="sMK4o">(</span><span class="s2Zo4">SIZES_APPAREL</span><span class="sMK4o">)
</span></span><span class="line" line="180"><span class="s7zQu">                else</span><span class="sMK4o">:
</span></span><span class="line" line="181"><span class="sTEyZ">                    size </span><span class="sMK4o">=</span><span class="sBMFI"> str</span><span class="sMK4o">(</span><span class="s2Zo4">random</span><span class="sMK4o">.</span><span class="s2Zo4">choice</span><span class="sMK4o">(</span><span class="s2Zo4">SIZES_SHOES</span><span class="sMK4o">))
</span></span><span class="line" line="182"><span emptylineplaceholder="true">
</span></span><span class="line" line="183"><span class="sTEyZ">            manuf </span><span class="sMK4o">=</span><span class="s2Zo4"> round</span><span class="sMK4o">(</span><span class="s2Zo4">random</span><span class="sMK4o">.</span><span class="s2Zo4">uniform</span><span class="sMK4o">(</span><span class="sbssI">10</span><span class="sMK4o">,</span><span class="sbssI"> 80</span><span class="sMK4o">),</span><span class="sbssI"> 2</span><span class="sMK4o">)
</span></span><span class="line" line="184"><span class="sTEyZ">            sell </span><span class="sMK4o">=</span><span class="s2Zo4"> round</span><span class="sMK4o">(</span><span class="s2Zo4">manuf </span><span class="sMK4o">*</span><span class="s2Zo4"> random</span><span class="sMK4o">.</span><span class="s2Zo4">uniform</span><span class="sMK4o">(</span><span class="sbssI">1.2</span><span class="sMK4o">,</span><span class="sbssI"> 2.0</span><span class="sMK4o">),</span><span class="sbssI"> 2</span><span class="sMK4o">)
</span></span><span class="line" line="185"><span class="s7zQu">            yield</span><span class="sMK4o"> (
</span></span><span class="line" line="186"><span class="sTEyZ">                pid</span><span class="sMK4o">,</span><span class="sTEyZ"> sku</span><span class="sMK4o">,</span><span class="sTEyZ"> color</span><span class="sMK4o">,</span><span class="sTEyZ"> size</span><span class="sMK4o">,</span><span class="sTEyZ"> manuf</span><span class="sMK4o">,</span><span class="sTEyZ"> sell</span><span class="sMK4o">,
</span></span><span class="line" line="187"><span class="sTEyZ">                random</span><span class="sMK4o">.</span><span class="s2Zo4">randint</span><span class="sMK4o">(</span><span class="sbssI">0</span><span class="sMK4o">,</span><span class="sbssI"> 200</span><span class="sMK4o">),</span><span class="sMK4o"> True,
</span></span><span class="line" line="188"><span class="sTEyZ">                datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),</span><span class="sTEyZ"> datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),
</span></span><span class="line" line="189"><span class="sMK4o">            )
</span></span><span class="line" line="190"><span emptylineplaceholder="true">
</span></span><span class="line" line="191"><span emptylineplaceholder="true">
</span></span><span class="line" line="192"><span class="spNyl">def</span><span class="s2Zo4"> gen_orders</span><span class="sMK4o">(</span><span class="sHdIc">cust_ids</span><span class="sMK4o">,</span><span class="sHdIc"> n</span><span class="sMK4o">,</span><span class="sHdIc"> s</span><span class="sMK4o">,</span><span class="sHdIc"> e</span><span class="sMK4o">):
</span></span><span class="line" line="193"><span class="s7zQu">    for</span><span class="sTEyZ"> _ </span><span class="s7zQu">in</span><span class="s2Zo4"> range</span><span class="sMK4o">(</span><span class="s2Zo4">n</span><span class="sMK4o">):
</span></span><span class="line" line="194"><span class="s7zQu">        yield</span><span class="sMK4o"> (</span><span class="sTEyZ">random</span><span class="sMK4o">.</span><span class="s2Zo4">choice</span><span class="sMK4o">(</span><span class="s2Zo4">cust_ids</span><span class="sMK4o">),</span><span class="s2Zo4"> rdate</span><span class="sMK4o">(</span><span class="s2Zo4">s</span><span class="sMK4o">,</span><span class="s2Zo4"> e</span><span class="sMK4o">),</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">choices</span><span class="sMK4o">(</span><span class="s2Zo4">ORDER_STATUSES</span><span class="sMK4o">,</span><span class="s2Zo4"> ORDER_STATUS_WEIGHTS</span><span class="sMK4o">)[</span><span class="sbssI">0</span><span class="sMK4o">],</span><span class="sbssI"> 0.0</span><span class="sMK4o">,
</span></span><span class="line" line="195"><span class="sTEyZ">               datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),</span><span class="sTEyZ"> datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">),)
</span></span><span class="line" line="196"><span emptylineplaceholder="true">
</span></span><span class="line" line="197"><span emptylineplaceholder="true">
</span></span><span class="line" line="198"><span class="spNyl">def</span><span class="s2Zo4"> gen_items</span><span class="sMK4o">(</span><span class="sHdIc">order_ids</span><span class="sMK4o">,</span><span class="sHdIc"> variant_ids</span><span class="sMK4o">,</span><span class="sHdIc"> max_items</span><span class="sMK4o">):
</span></span><span class="line" line="199"><span class="s7zQu">    for</span><span class="sTEyZ"> oid </span><span class="s7zQu">in</span><span class="sTEyZ"> order_ids</span><span class="sMK4o">:
</span></span><span class="line" line="200"><span class="s7zQu">        for</span><span class="sTEyZ"> vid </span><span class="s7zQu">in</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">sample</span><span class="sMK4o">(</span><span class="s2Zo4">variant_ids</span><span class="sMK4o">,</span><span class="s2Zo4"> random</span><span class="sMK4o">.</span><span class="s2Zo4">randint</span><span class="sMK4o">(</span><span class="sbssI">1</span><span class="sMK4o">,</span><span class="s2Zo4"> max</span><span class="sMK4o">(</span><span class="sbssI">1</span><span class="sMK4o">,</span><span class="s2Zo4"> max_items</span><span class="sMK4o">))):
</span></span><span class="line" line="201"><span class="s7zQu">            yield</span><span class="sMK4o"> (</span><span class="sTEyZ">oid</span><span class="sMK4o">,</span><span class="sTEyZ"> vid</span><span class="sMK4o">,</span><span class="sTEyZ"> random</span><span class="sMK4o">.</span><span class="s2Zo4">randint</span><span class="sMK4o">(</span><span class="sbssI">1</span><span class="sMK4o">,</span><span class="sbssI"> 3</span><span class="sMK4o">),</span><span class="s2Zo4"> round</span><span class="sMK4o">(</span><span class="s2Zo4">random</span><span class="sMK4o">.</span><span class="s2Zo4">uniform</span><span class="sMK4o">(</span><span class="sbssI">20</span><span class="sMK4o">,</span><span class="sbssI"> 200</span><span class="sMK4o">),</span><span class="sbssI"> 2</span><span class="sMK4o">),</span><span class="sTEyZ"> datetime</span><span class="sMK4o">.</span><span class="s2Zo4">now</span><span class="sMK4o">(</span><span class="s2Zo4">timezone</span><span class="sMK4o">.</span><span class="swJcz">utc</span><span class="sMK4o">))
</span></span><span class="line" line="202"><span emptylineplaceholder="true">
</span></span><span class="line" line="203"><span emptylineplaceholder="true">
</span></span><span class="line" line="204"><span class="spNyl">def</span><span class="s2Zo4"> print_box_summary</span><span class="sMK4o">(</span><span class="sHdIc">S</span><span class="sMK4o">,</span><span class="sHdIc"> E</span><span class="sMK4o">,</span><span class="sHdIc"> c_cnt</span><span class="sMK4o">,</span><span class="sHdIc"> p_cnt</span><span class="sMK4o">,</span><span class="sHdIc"> v_cnt</span><span class="sMK4o">,</span><span class="sHdIc"> o_cnt</span><span class="sMK4o">,</span><span class="sHdIc"> i_cnt</span><span class="sMK4o">,</span><span class="sHdIc"> max_items</span><span class="sMK4o">,</span><span class="sHdIc"> bad_by_cat</span><span class="sMK4o">):
</span></span><span class="line" line="205"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sTEyZ">\n</span><span class="sfazB">✅ Data generation complete (idempotent window load)</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="206"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="spNyl">f</span><span class="sfazB">&quot;Window: </span><span class="sbssI">{</span><span class="s2Zo4">S</span><span class="sMK4o">.</span><span class="s2Zo4">isoformat</span><span class="sMK4o">()</span><span class="sbssI">}</span><span class="sfazB"> → </span><span class="sbssI">{</span><span class="s2Zo4">E</span><span class="sMK4o">.</span><span class="s2Zo4">isoformat</span><span class="sMK4o">()</span><span class="sbssI">}</span><span class="sfazB">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="207"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="spNyl">f</span><span class="sfazB">&quot;Counts — Customers: </span><span class="sbssI">{</span><span class="s2Zo4">c_cnt</span><span class="spNyl">:,</span><span class="sbssI">}</span><span class="sfazB"> | Products: </span><span class="sbssI">{</span><span class="s2Zo4">p_cnt</span><span class="spNyl">:,</span><span class="sbssI">}</span><span class="sfazB"> | Variants: </span><span class="sbssI">{</span><span class="s2Zo4">v_cnt</span><span class="spNyl">:,</span><span class="sbssI">}</span><span class="sfazB">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="208"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="spNyl">f</span><span class="sfazB">&quot;Window Facts — Orders: </span><span class="sbssI">{</span><span class="s2Zo4">o_cnt</span><span class="spNyl">:,</span><span class="sbssI">}</span><span class="sfazB"> | Items: </span><span class="sbssI">{</span><span class="s2Zo4">i_cnt</span><span class="spNyl">:,</span><span class="sbssI">}</span><span class="sfazB"> | MaxItems/Order: </span><span class="sbssI">{</span><span class="s2Zo4">max_items</span><span class="sbssI">}</span><span class="sfazB">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="209"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">Chaos check (invalid sizes per category):</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="210"><span class="s7zQu">    for</span><span class="sTEyZ"> cat</span><span class="sMK4o">,</span><span class="sTEyZ"> bad </span><span class="s7zQu">in</span><span class="sTEyZ"> bad_by_cat</span><span class="sMK4o">:
</span></span><span class="line" line="211"><span class="s2Zo4">        print</span><span class="sMK4o">(</span><span class="spNyl">f</span><span class="sfazB">&quot;  • </span><span class="sbssI">{</span><span class="s2Zo4">cat</span><span class="sbssI">}</span><span class="sfazB">: </span><span class="sbssI">{</span><span class="s2Zo4">bad</span><span class="spNyl">:,</span><span class="sbssI">}</span><span class="sfazB"> invalid&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="212"><span emptylineplaceholder="true">
</span></span><span class="line" line="213"><span emptylineplaceholder="true">
</span></span><span class="line" line="214"><span class="spNyl">def</span><span class="s2Zo4"> main</span><span class="sMK4o">():
</span></span><span class="line" line="215"><span class="sTEyZ">    args </span><span class="sMK4o">=</span><span class="s2Zo4"> parse_args</span><span class="sMK4o">()
</span></span><span class="line" line="216"><span class="sTEyZ">    random</span><span class="sMK4o">.</span><span class="s2Zo4">seed</span><span class="sMK4o">(</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">seed</span><span class="sMK4o">)
</span></span><span class="line" line="217"><span class="sTEyZ">    Faker</span><span class="sMK4o">.</span><span class="s2Zo4">seed</span><span class="sMK4o">(</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">seed</span><span class="sMK4o">)
</span></span><span class="line" line="218"><span class="sTEyZ">    S</span><span class="sMK4o">,</span><span class="sTEyZ"> E </span><span class="sMK4o">=</span><span class="s2Zo4"> iso</span><span class="sMK4o">(</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">starting_at</span><span class="sMK4o">),</span><span class="s2Zo4"> iso</span><span class="sMK4o">(</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">ending_at</span><span class="sMK4o">)
</span></span><span class="line" line="219"><span emptylineplaceholder="true">
</span></span><span class="line" line="220"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sTEyZ">\n</span><span class="sfazB">=== Generating E-commerce Demo Data ===</span><span class="sMK4o">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="221"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="spNyl">f</span><span class="sfazB">&quot;Window: </span><span class="sbssI">{</span><span class="s2Zo4">S</span><span class="sMK4o">.</span><span class="s2Zo4">isoformat</span><span class="sMK4o">()</span><span class="sbssI">}</span><span class="sfazB"> → </span><span class="sbssI">{</span><span class="s2Zo4">E</span><span class="sMK4o">.</span><span class="s2Zo4">isoformat</span><span class="sMK4o">()</span><span class="sbssI">}</span><span class="sfazB">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="222"><span class="s2Zo4">    print</span><span class="sMK4o">(</span><span class="spNyl">f</span><span class="sfazB">&quot;Scale x</span><span class="sbssI">{</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">scale</span><span class="sbssI">}</span><span class="sfazB"> | Seed </span><span class="sbssI">{</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">seed</span><span class="sbssI">}</span><span class="sfazB"> | Chaos </span><span class="sbssI">{</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">chaos_percent</span><span class="spNyl">:.1f</span><span class="sbssI">}</span><span class="sfazB">%</span><span class="sTEyZ">\n</span><span class="sfazB">&quot;</span><span class="sMK4o">)
</span></span><span class="line" line="223"><span emptylineplaceholder="true">
</span></span><span class="line" line="224"><span class="sTEyZ">    base_c</span><span class="sMK4o">,</span><span class="sTEyZ"> base_p</span><span class="sMK4o">,</span><span class="sTEyZ"> base_o </span><span class="sMK4o">=</span><span class="sTEyZ"> args</span><span class="sMK4o">.</span><span class="swJcz">customers</span><span class="sMK4o">,</span><span class="sTEyZ"> args</span><span class="sMK4o">.</span><span class="swJcz">products</span><span class="sMK4o">,</span><span class="sTEyZ"> args</span><span class="sMK4o">.</span><span class="swJcz">orders
</span></span><span class="line" line="225"><span class="sTEyZ">    n_c</span><span class="sMK4o">,</span><span class="sTEyZ"> n_p</span><span class="sMK4o">,</span><span class="sTEyZ"> n_o </span><span class="sMK4o">=</span><span class="sTEyZ"> base_c </span><span class="sMK4o">*</span><span class="sTEyZ"> args</span><span class="sMK4o">.</span><span class="swJcz">scale</span><span class="sMK4o">,</span><span class="sTEyZ"> base_p </span><span class="sMK4o">*</span><span class="sTEyZ"> args</span><span class="sMK4o">.</span><span class="swJcz">scale</span><span class="sMK4o">,</span><span class="sTEyZ"> base_o </span><span class="sMK4o">*</span><span class="sTEyZ"> args</span><span class="sMK4o">.</span><span class="swJcz">scale
</span></span><span class="line" line="226"><span emptylineplaceholder="true">
</span></span><span class="line" line="227"><span class="s7zQu">    with</span><span class="sTEyZ"> psycopg</span><span class="sMK4o">.</span><span class="s2Zo4">connect</span><span class="sMK4o">(</span><span class="s2Zo4">args</span><span class="sMK4o">.</span><span class="swJcz">dsn</span><span class="sMK4o">)</span><span class="s7zQu"> as</span><span class="sTEyZ"> conn</span><span class="sMK4o">:
</span></span><span class="line" line="228"><span class="s2Zo4">        execmany</span><span class="sMK4o">(</span><span class="s2Zo4">conn</span><span class="sMK4o">,</span><span class="s2Zo4"> SQL_INSERT_CUSTOMERS</span><span class="sMK4o">,</span><span class="s2Zo4"> gen_customers</span><span class="sMK4o">(</span><span class="s2Zo4">n_c</span><span class="sMK4o">))
</span></span><span class="line" line="229"><span class="s2Zo4">        execmany</span><span class="sMK4o">(</span><span class="s2Zo4">conn</span><span class="sMK4o">,</span><span class="s2Zo4"> SQL_INSERT_PRODUCTS</span><span class="sMK4o">,</span><span class="s2Zo4"> gen_products</span><span class="sMK4o">(</span><span class="s2Zo4">n_p</span><span class="sMK4o">))
</span></span><span class="line" line="230"><span emptylineplaceholder="true">
</span></span><span class="line" line="231"><span class="sTEyZ">        prod_rows </span><span class="sMK4o">=</span><span class="sBMFI"> list</span><span class="sMK4o">(</span><span class="s2Zo4">conn</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">SELECT id, category FROM products</span><span class="sMK4o">&quot;</span><span class="sMK4o">))
</span></span><span class="line" line="232"><span class="s2Zo4">        execmany</span><span class="sMK4o">(</span><span class="s2Zo4">conn</span><span class="sMK4o">,</span><span class="s2Zo4"> SQL_INSERT_VARIANTS</span><span class="sMK4o">,</span><span class="s2Zo4"> gen_variants</span><span class="sMK4o">(</span><span class="s2Zo4">prod_rows</span><span class="sMK4o">,</span><span class="s2Zo4"> args</span><span class="sMK4o">.</span><span class="swJcz">chaos_percent</span><span class="sMK4o">))
</span></span><span class="line" line="233"><span emptylineplaceholder="true">
</span></span><span class="line" line="234"><span class="s7zQu">        with</span><span class="sTEyZ"> conn</span><span class="sMK4o">.</span><span class="s2Zo4">cursor</span><span class="sMK4o">()</span><span class="s7zQu"> as</span><span class="sTEyZ"> cur</span><span class="sMK4o">:
</span></span><span class="line" line="235"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_DELETE_ORDERS_IN_WINDOW</span><span class="sMK4o">,</span><span class="sMK4o"> (</span><span class="s2Zo4">S</span><span class="sMK4o">,</span><span class="s2Zo4"> E</span><span class="sMK4o">))
</span></span><span class="line" line="236"><span class="sTEyZ">        conn</span><span class="sMK4o">.</span><span class="s2Zo4">commit</span><span class="sMK4o">()
</span></span><span class="line" line="237"><span emptylineplaceholder="true">
</span></span><span class="line" line="238"><span class="sTEyZ">        cust_ids </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sTEyZ">r</span><span class="sMK4o">[</span><span class="sbssI">0</span><span class="sMK4o">]</span><span class="s7zQu"> for</span><span class="sTEyZ"> r </span><span class="s7zQu">in</span><span class="sTEyZ"> conn</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">SELECT id FROM customers</span><span class="sMK4o">&quot;</span><span class="sMK4o">)]
</span></span><span class="line" line="239"><span class="s2Zo4">        execmany</span><span class="sMK4o">(</span><span class="s2Zo4">conn</span><span class="sMK4o">,</span><span class="s2Zo4"> SQL_INSERT_ORDERS</span><span class="sMK4o">,</span><span class="s2Zo4"> gen_orders</span><span class="sMK4o">(</span><span class="s2Zo4">cust_ids</span><span class="sMK4o">,</span><span class="s2Zo4"> n_o</span><span class="sMK4o">,</span><span class="s2Zo4"> S</span><span class="sMK4o">,</span><span class="s2Zo4"> E</span><span class="sMK4o">))
</span></span><span class="line" line="240"><span emptylineplaceholder="true">
</span></span><span class="line" line="241"><span class="sTEyZ">        order_ids </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sTEyZ">r</span><span class="sMK4o">[</span><span class="sbssI">0</span><span class="sMK4o">]</span><span class="s7zQu"> for</span><span class="sTEyZ"> r </span><span class="s7zQu">in</span><span class="sTEyZ"> conn</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">SELECT id FROM orders WHERE order_date BETWEEN </span><span class="sbssI">%s</span><span class="sfazB"> AND </span><span class="sbssI">%s</span><span class="sMK4o">&quot;</span><span class="sMK4o">,</span><span class="sMK4o"> (</span><span class="s2Zo4">S</span><span class="sMK4o">,</span><span class="s2Zo4"> E</span><span class="sMK4o">))]
</span></span><span class="line" line="242"><span class="sTEyZ">        variant_ids </span><span class="sMK4o">=</span><span class="sMK4o"> [</span><span class="sTEyZ">r</span><span class="sMK4o">[</span><span class="sbssI">0</span><span class="sMK4o">]</span><span class="s7zQu"> for</span><span class="sTEyZ"> r </span><span class="s7zQu">in</span><span class="sTEyZ"> conn</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="sMK4o">&quot;</span><span class="sfazB">SELECT id FROM product_variants</span><span class="sMK4o">&quot;</span><span class="sMK4o">)]
</span></span><span class="line" line="243"><span class="s2Zo4">        execmany</span><span class="sMK4o">(</span><span class="s2Zo4">conn</span><span class="sMK4o">,</span><span class="s2Zo4"> SQL_INSERT_ORDER_ITEMS</span><span class="sMK4o">,</span><span class="s2Zo4"> gen_items</span><span class="sMK4o">(</span><span class="s2Zo4">order_ids</span><span class="sMK4o">,</span><span class="s2Zo4"> variant_ids</span><span class="sMK4o">,</span><span class="s2Zo4"> args</span><span class="sMK4o">.</span><span class="swJcz">max_items_per_order</span><span class="sMK4o">))
</span></span><span class="line" line="244"><span emptylineplaceholder="true">
</span></span><span class="line" line="245"><span class="s7zQu">        with</span><span class="sTEyZ"> conn</span><span class="sMK4o">.</span><span class="s2Zo4">cursor</span><span class="sMK4o">()</span><span class="s7zQu"> as</span><span class="sTEyZ"> cur</span><span class="sMK4o">:
</span></span><span class="line" line="246"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_UPDATE_ORDER_TOTALS</span><span class="sMK4o">,</span><span class="sMK4o"> (</span><span class="s2Zo4">S</span><span class="sMK4o">,</span><span class="s2Zo4"> E</span><span class="sMK4o">))
</span></span><span class="line" line="247"><span class="sTEyZ">        conn</span><span class="sMK4o">.</span><span class="s2Zo4">commit</span><span class="sMK4o">()
</span></span><span class="line" line="248"><span emptylineplaceholder="true">
</span></span><span class="line" line="249"><span class="s7zQu">        with</span><span class="sTEyZ"> conn</span><span class="sMK4o">.</span><span class="s2Zo4">cursor</span><span class="sMK4o">()</span><span class="s7zQu"> as</span><span class="sTEyZ"> cur</span><span class="sMK4o">:
</span></span><span class="line" line="250"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_STATS_COUNTS</span><span class="sMK4o">[</span><span class="sMK4o">&quot;</span><span class="sfazB">customers</span><span class="sMK4o">&quot;</span><span class="sMK4o">])</span><span class="sTEyZ">;
</span></span><span class="line" line="251"><span class="sTEyZ">            c_cnt </span><span class="sMK4o">=</span><span class="sTEyZ"> cur</span><span class="sMK4o">.</span><span class="s2Zo4">fetchone</span><span class="sMK4o">()[</span><span class="sbssI">0</span><span class="sMK4o">]
</span></span><span class="line" line="252"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_STATS_COUNTS</span><span class="sMK4o">[</span><span class="sMK4o">&quot;</span><span class="sfazB">products</span><span class="sMK4o">&quot;</span><span class="sMK4o">])</span><span class="sTEyZ">;
</span></span><span class="line" line="253"><span class="sTEyZ">            p_cnt </span><span class="sMK4o">=</span><span class="sTEyZ"> cur</span><span class="sMK4o">.</span><span class="s2Zo4">fetchone</span><span class="sMK4o">()[</span><span class="sbssI">0</span><span class="sMK4o">]
</span></span><span class="line" line="254"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_STATS_COUNTS</span><span class="sMK4o">[</span><span class="sMK4o">&quot;</span><span class="sfazB">variants</span><span class="sMK4o">&quot;</span><span class="sMK4o">])</span><span class="sTEyZ">;
</span></span><span class="line" line="255"><span class="sTEyZ">            v_cnt </span><span class="sMK4o">=</span><span class="sTEyZ"> cur</span><span class="sMK4o">.</span><span class="s2Zo4">fetchone</span><span class="sMK4o">()[</span><span class="sbssI">0</span><span class="sMK4o">]
</span></span><span class="line" line="256"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_STATS_COUNTS</span><span class="sMK4o">[</span><span class="sMK4o">&quot;</span><span class="sfazB">orders</span><span class="sMK4o">&quot;</span><span class="sMK4o">],</span><span class="sMK4o"> (</span><span class="s2Zo4">S</span><span class="sMK4o">,</span><span class="s2Zo4"> E</span><span class="sMK4o">))</span><span class="sTEyZ">;
</span></span><span class="line" line="257"><span class="sTEyZ">            o_cnt </span><span class="sMK4o">=</span><span class="sTEyZ"> cur</span><span class="sMK4o">.</span><span class="s2Zo4">fetchone</span><span class="sMK4o">()[</span><span class="sbssI">0</span><span class="sMK4o">]
</span></span><span class="line" line="258"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_STATS_COUNTS</span><span class="sMK4o">[</span><span class="sMK4o">&quot;</span><span class="sfazB">items</span><span class="sMK4o">&quot;</span><span class="sMK4o">],</span><span class="sMK4o"> (</span><span class="s2Zo4">S</span><span class="sMK4o">,</span><span class="s2Zo4"> E</span><span class="sMK4o">))</span><span class="sTEyZ">;
</span></span><span class="line" line="259"><span class="sTEyZ">            i_cnt </span><span class="sMK4o">=</span><span class="sTEyZ"> cur</span><span class="sMK4o">.</span><span class="s2Zo4">fetchone</span><span class="sMK4o">()[</span><span class="sbssI">0</span><span class="sMK4o">]
</span></span><span class="line" line="260"><span class="sTEyZ">            cur</span><span class="sMK4o">.</span><span class="s2Zo4">execute</span><span class="sMK4o">(</span><span class="s2Zo4">SQL_CHAOS_VALIDATION</span><span class="sMK4o">)</span><span class="sTEyZ">;
</span></span><span class="line" line="261"><span class="sTEyZ">            bad_by_cat </span><span class="sMK4o">=</span><span class="sTEyZ"> cur</span><span class="sMK4o">.</span><span class="s2Zo4">fetchall</span><span class="sMK4o">()
</span></span><span class="line" line="262"><span emptylineplaceholder="true">
</span></span><span class="line" line="263"><span class="s2Zo4">    print_box_summary</span><span class="sMK4o">(</span><span class="s2Zo4">S</span><span class="sMK4o">,</span><span class="s2Zo4"> E</span><span class="sMK4o">,</span><span class="s2Zo4"> c_cnt</span><span class="sMK4o">,</span><span class="s2Zo4"> p_cnt</span><span class="sMK4o">,</span><span class="s2Zo4"> v_cnt</span><span class="sMK4o">,</span><span class="s2Zo4"> o_cnt</span><span class="sMK4o">,</span><span class="s2Zo4"> i_cnt</span><span class="sMK4o">,</span><span class="s2Zo4"> args</span><span class="sMK4o">.</span><span class="swJcz">max_items_per_order</span><span class="sMK4o">,</span><span class="s2Zo4"> bad_by_cat</span><span class="sMK4o">)
</span></span><span class="line" line="264"><span emptylineplaceholder="true">
</span></span><span class="line" line="265"><span emptylineplaceholder="true">
</span></span><span class="line" line="266"><span class="s7zQu">if</span><span class="sTEyZ"> __name__ </span><span class="sMK4o">==</span><span class="sMK4o"> &quot;</span><span class="sfazB">__main__</span><span class="sMK4o">&quot;</span><span class="sMK4o">:
</span></span><span class="line" line="267"><span class="s2Zo4">    main</span><span class="sMK4o">()
</span></span></code><!--]--></pre></div><!--]--><div class="h-16 absolute inset-x-px bottom-px rounded-b-md flex items-center justify-center bg-gradient-to-t from-muted"><!--[--><!--[--><button type="button" data-state="closed" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors px-2.5 py-1.5 text-sm gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted group"><!--[--><!--[--><span class="iconify i-lucide:chevron-down shrink-0 size-5 group-data-[state=open]:rotate-180" aria-hidden="true" style=""></span><!--]--><!--[--><span class="truncate">Expand code</span><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--></div></div><p class="my-5 leading-7 text-pretty"><!--[-->After that, let&#39;s run the script and see if everything works as expected:<!--]--></p><div dir="ltr" data-orientation="horizontal" class="relative group *:not-first:!my-0 *:not-first:!static my-5"><!--[--><div class="relative flex items-center gap-1 border border-muted bg-default border-b-0 rounded-t-md overflow-x-auto p-2" tabindex="-1" data-orientation="horizontal" dir="ltr" style="outline:none;" role="tablist" aria-orientation="horizontal"><!--[--><!--v-if--><!--[--><button class="relative inline-flex items-center gap-1.5 text-default data-[state=active]:text-highlighted hover:bg-elevated/50 px-2 py-1.5 text-sm rounded-md disabled:cursor-not-allowed disabled:opacity-75 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary focus:outline-none transition-colors" data-reka-collection-item tabindex="-1" data-orientation="horizontal" data-active id="reka-tabs-v-0-5-4-0-41-0-trigger-0" role="tab" type="button" aria-selected="true" aria-controls="reka-tabs-v-0-5-4-0-41-0-content-0" data-state="active"><!--[--><!----><span class="truncate">Bash UV</span><!--]--></button><button class="relative inline-flex items-center gap-1.5 text-default data-[state=active]:text-highlighted hover:bg-elevated/50 px-2 py-1.5 text-sm rounded-md disabled:cursor-not-allowed disabled:opacity-75 focus-visible:ring-2 focus-visible:ring-inset focus-visible:ring-primary focus:outline-none transition-colors" data-reka-collection-item tabindex="-1" data-orientation="horizontal" id="reka-tabs-v-0-5-4-0-41-0-trigger-1" role="tab" type="button" aria-selected="false" aria-controls="reka-tabs-v-0-5-4-0-41-0-content-1" data-state="inactive"><!--[--><!----><span class="truncate">Bash Makefile</span><!--]--></button><!--]--><!--]--></div><!--[--><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" id="reka-tabs-v-0-5-4-0-41-0-content-0" role="tabpanel" data-state="active" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-41-0-trigger-0" tabindex="-1" style="animation-duration:0s;"><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" id="reka-tabs-v-0-5-4-0-41-0-content-0" role="tabpanel" data-state="active" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-41-0-trigger-0" tabindex="-1" style="animation-duration:0s;"><!--[--><code><span class="line" line="1"><span class="sBMFI">uv</span><span class="sfazB"> run</span><span class="sfazB"> generate_data.py</span><span class="sfazB"> --dsn</span><span class="sfazB"> postgresql://postgres:postgres@localhost:5432/postgres
</span></span></code><!--]--></pre></div><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" id="reka-tabs-v-0-5-4-0-41-0-content-1" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-41-0-trigger-1" hidden tabindex="-1" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" id="reka-tabs-v-0-5-4-0-41-0-content-1" role="tabpanel" data-state="inactive" data-orientation="horizontal" aria-labelledby="reka-tabs-v-0-5-4-0-41-0-trigger-1" hidden tabindex="-1" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">make</span><span class="sfazB"> generate-data
</span></span></code><!--]--></pre></div><!--]--><!--]--></div><p class="my-5 leading-7 text-pretty"><!--[-->The output should look like this:<!--]--></p><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><!----><span class="text-default text-sm/6">Bash Output</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sfazB">===</span><span class="sfazB"> Generating</span><span class="sfazB"> E-commerce</span><span class="sfazB"> Demo</span><span class="sfazB"> Data</span><span class="sfazB"> ===
</span></span><span class="line" line="2"><span class="sBMFI">Window:</span><span class="sfazB"> 2025-10-19T00:00:00+00:00</span><span class="sfazB"> →</span><span class="sfazB"> 2025-10-19T23:59:59.999999+00:00
</span></span><span class="line" line="3"><span class="sBMFI">Scale</span><span class="sfazB"> x1</span><span class="sMK4o"> |</span><span class="sBMFI"> Seed</span><span class="sbssI"> 42</span><span class="sMK4o"> |</span><span class="sBMFI"> Chaos</span><span class="sfazB"> 0.0%
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span class="sBMFI">✅</span><span class="sfazB"> Data</span><span class="sfazB"> generation</span><span class="sfazB"> complete
</span></span><span class="line" line="7"><span class="sBMFI">Window:</span><span class="sfazB"> 2025-10-19T00:00:00+00:00</span><span class="sfazB"> →</span><span class="sfazB"> 2025-10-19T23:59:59.999999+00:00
</span></span><span class="line" line="8"><span class="sBMFI">Counts</span><span class="sfazB"> —</span><span class="sfazB"> Customers:</span><span class="sbssI"> 100</span><span class="sMK4o"> |</span><span class="sBMFI"> Products:</span><span class="sbssI"> 50</span><span class="sMK4o"> |</span><span class="sBMFI"> Variants:</span><span class="sbssI"> 144
</span></span><span class="line" line="9"><span class="sBMFI">Window</span><span class="sfazB"> Facts</span><span class="sfazB"> —</span><span class="sfazB"> Orders:</span><span class="sbssI"> 500</span><span class="sMK4o"> |</span><span class="sBMFI"> Items:</span><span class="sfazB"> 1,487</span><span class="sMK4o"> |</span><span class="sBMFI"> MaxItems/Order:</span><span class="sbssI"> 5
</span></span><span class="line" line="10"><span class="sBMFI">Chaos</span><span class="sfazB"> check</span><span class="sTEyZ"> (invalid </span><span class="sfazB">sizes</span><span class="sfazB"> per</span><span class="sfazB"> category</span><span class="sTEyZ">):
</span></span><span class="line" line="11"><span class="sBMFI">  •</span><span class="sfazB"> accessories:</span><span class="sbssI"> 0</span><span class="sfazB"> invalid
</span></span><span class="line" line="12"><span class="sBMFI">  •</span><span class="sfazB"> hoodies:</span><span class="sbssI"> 0</span><span class="sfazB"> invalid
</span></span><span class="line" line="13"><span class="sBMFI">  •</span><span class="sfazB"> jackets:</span><span class="sbssI"> 0</span><span class="sfazB"> invalid
</span></span><span class="line" line="14"><span class="sBMFI">  •</span><span class="sfazB"> shoes:</span><span class="sbssI"> 0</span><span class="sfazB"> invalid
</span></span><span class="line" line="15"><span class="sBMFI">  •</span><span class="sfazB"> t-shirts:</span><span class="sbssI"> 0</span><span class="sfazB"> invalid
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->Cool! Now we&#39;re ready to start our Bruin Pipeline!<!--]--></p><details><summary>Click to expand the Script Argument List</summary><div class="relative my-5 overflow-x-auto"><table class="w-full border-separate border-spacing-0 rounded-md"><!--[--><thead class="bg-muted"><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Argument<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Type<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Default<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Description<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--dsn<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->str<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><strong><!--[-->(required)<!--]--></strong><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->PostgreSQL connection string (DSN). Example: <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->postgresql://user:pass@localhost:5432/ecommerce<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--customers<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->int<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->100<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Number of customers to generate.<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--products<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->int<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->50<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Number of products to generate.<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--orders<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->int<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->500<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Number of orders to generate.<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--max-items-per-order<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->int<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->5<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Maximum number of items per order. Each order will have 1–N items.<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--chaos-percent<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->float<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->0.0<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Percentage of product variants that should have <strong><!--[-->invalid sizes<!--]--></strong> (used for validation testing).<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--starting-at<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->str (ISO date)<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><strong><!--[-->Yesterday at 00:00 UTC<!--]--></strong><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Beginning of the generated data window. Example: <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->2024-01-01<!--]--></code>.<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--ending-at<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->str (ISO date)<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><strong><!--[-->Today at 23:59 UTC<!--]--></strong><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->End of the generated data window. Example: <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->2024-06-30<!--]--></code>.<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div></details><blockquote class="border-s-4 border-accented ps-4 italic"><!--[--><p class="my-5 leading-7 text-pretty"><!--[--><strong><!--[-->Note:<!--]--></strong> You can also run the script with the <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--help<!--]--></code> flag to see the available arguments.<!--]--></p><!--]--></blockquote><h2 id="_5-creating-the-bruin-pipeline" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_5-creating-the-bruin-pipeline" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->5) Creating the Bruin Pipeline<!--]--></a></h2><p class="my-5 leading-7 text-pretty"><!--[-->We have everything structured to start ingesting data into our Bruin Pipeline. So, first, we must create the assets.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->But before that, let&#39;s understand the structure of the Bruin Pipeline.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->A pipeline can be created using the Bruin CLI tool:<!--]--></p><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><!----><span class="text-default text-sm/6">Bruin CLI</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sHwdD"># Example Command
</span></span><span class="line" line="2"><span class="sBMFI">bruin</span><span class="sfazB"> init</span><span class="sfazB"> default</span><span class="sfazB"> some-feature
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->and it will always generate the same structure, where:<!--]--></p><ul class="list-disc ps-6 my-5 marker:text-(--ui-border-accented)"><!--[--><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[--><strong><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->.bruin.yml<!--]--></code><!--]--></strong><ul class="list-disc ps-6 my-5 marker:text-(--ui-border-accented)"><!--[--><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->The main configuration file for your Bruin environment.<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Defines <strong><!--[-->global settings<!--]--></strong> like default <strong><!--[-->connections<!--]--></strong>, variables, and <strong><!--[-->behavior<!--]--></strong> for all pipelines.<!--]--></li><!--]--></ul><!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[--><strong><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->some-feature/pipeline.yml<!--]--></code><!--]--></strong><ul class="list-disc ps-6 my-5 marker:text-(--ui-border-accented)"><!--[--><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Defines a specific pipeline for a domain or project (in this example, <em><!--[-->ecommerce<!--]--></em>).<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Describes the end-to-end data flow — which assets to run, their dependencies, and schedules.<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Pipelines are modular, so you can maintain separate ones for different business domains.<!--]--></li><!--]--></ul><!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[--><strong><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->some-feature/assets/*<!--]--></code><!--]--></strong><ul class="list-disc ps-6 my-5 marker:text-(--ui-border-accented)"><!--[--><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Contains all the assets — the building blocks of your data pipelines.<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Each asset handles a distinct task: ingesting raw data, transforming it, or generating analytical tables.<!--]--></li><li class="my-1.5 ps-1.5 leading-7 [&amp;&gt;ul]:my-0"><!--[-->Since every asset is a file, it’s <strong><!--[-->version-controlled, testable, and reusable<!--]--></strong> — just like code.<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><p class="my-5 leading-7 text-pretty"><!--[-->The important thing to remember is that Bruin will check all files nested inside the <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->assets<!--]--></code> folder for filenames with suffix <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->.asset.yml<!--]--></code>, which can be any type of asset <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->.asset.*<!--]--></code>.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->So, doesn&#39;t matter how you organize your pipeline assets, by nesting folders. If you follows the convention proposed, Bruin will understand automagically!<!--]--></p><h2 id="_6-raw-ingestion-assets" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_6-raw-ingestion-assets" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->6. Raw Ingestion Assets<!--]--></a></h2><p class="my-5 leading-7 text-pretty"><!--[-->Using <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->ingestr<!--]--></code>, we&#39;re able to retrieve data from a source database and ingest it into destination database.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->At our case, the goal is to ingest all the data generated from <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->PostgresSQL<!--]--></code> to <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->DuckDB<!--]--></code>, which will act as our analytical database.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->Let&#39;s take a look at our <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->assets<!--]--></code> and configuration.<!--]--></p><!--[--><!----><div class="relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md"><ul class="isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto" tabindex="-1" data-orientation="vertical" dir="ltr" style="outline:none;" role="tree"><!--[--><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-expanded="true" aria-level="1" data-indent="1" data-expanded><!--[--><button type="button" data-expanded="true" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-lucide:folder-open size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">orders-performance</span><span class="ms-auto inline-flex gap-1.5 items-center"><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[expanded=true]:rotate-180" aria-hidden="true" style=""></span></span></button><ul role="group" class="ms-4.5 border-s border-default"><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="false" aria-expanded="true" aria-level="2" data-indent="2" data-expanded><!--[--><button type="button" data-expanded="true" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-lucide:folder-open size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">assets</span><span class="ms-auto inline-flex gap-1.5 items-center"><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[expanded=true]:rotate-180" aria-hidden="true" style=""></span></span></button><ul role="group" class="ms-4.5 border-s border-default"><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="false" aria-expanded="true" aria-level="3" data-indent="3" data-expanded><!--[--><button type="button" data-expanded="true" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-lucide:folder-open size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">ingestion</span><span class="ms-auto inline-flex gap-1.5 items-center"><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[expanded=true]:rotate-180" aria-hidden="true" style=""></span></span></button><ul role="group" class="ms-4.5 border-s border-default"><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="true" aria-level="4" data-indent="4" data-selected data-expanded><!--[--><button type="button" data-expanded="true" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 text-highlighted before:bg-elevated"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">raw.customers.asset.yml</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="false" aria-level="4" data-indent="4"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">raw.orders_items.asset.yml</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="false" aria-level="4" data-indent="4"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">raw.orders.asset.yml</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="false" aria-level="4" data-indent="4"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">raw.product_variants.asset.yml</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="false" aria-level="4" data-indent="4"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">raw.products.asset.yml</span><!----></button><!----><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" class="ps-1.5 -ms-px" role="treeitem" aria-selected="false" aria-level="2" data-indent="2"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">pipeline.yml</span><!----></button><!----><!--]--></li><!--]--></ul><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">.bruin.yml</span><!----></button><!----><!--]--></li><!--]--><!--]--></ul><div class="overflow-hidden lg:col-span-2 flex flex-col [&amp;&gt;div]:my-0 [&amp;&gt;div]:flex-1 [&amp;&gt;div]:flex [&amp;&gt;div]:flex-col [&amp;&gt;div&gt;div]:border-0 [&amp;&gt;div&gt;pre]:border-b-0 [&amp;&gt;div&gt;pre]:border-s-0 [&amp;&gt;div&gt;pre]:border-e-0 [&amp;&gt;div&gt;pre]:rounded-l-none [&amp;&gt;div&gt;pre]:flex-1 [&amp;&gt;div]:overflow-y-auto"><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="text-default text-sm/6">orders-performance/assets/ingestion/raw.customers.asset.yml</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-yaml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="swJcz">name</span><span class="sMK4o">:</span><span class="sfazB"> raw.customers
</span></span><span class="line" line="2"><span class="swJcz">type</span><span class="sMK4o">:</span><span class="sfazB"> ingestr
</span></span><span class="line" line="3"><span class="swJcz">description</span><span class="sMK4o">:</span><span class="sfazB"> Ingest OLTP customers from Postgres into DuckDB raw layer.
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span class="swJcz">parameters</span><span class="sMK4o">:
</span></span><span class="line" line="6"><span class="swJcz">  source_connection</span><span class="sMK4o">:</span><span class="sfazB"> pg-default
</span></span><span class="line" line="7"><span class="swJcz">  source_table</span><span class="sMK4o">:</span><span class="sMK4o"> &quot;</span><span class="sfazB">public.customers</span><span class="sMK4o">&quot;
</span></span><span class="line" line="8"><span class="swJcz">  destination</span><span class="sMK4o">:</span><span class="sfazB"> duckdb
</span></span></code><!--]--></pre></div></div></div><!--]--><p class="my-5 leading-7 text-pretty"><!--[-->The pipeline could run everything concurrently, but we&#39;re going to run it in a sequential way by awaiting the dependencies to be processed/resolved.<!--]--></p><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-mermaid shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sTEyZ">flowchart TD
</span></span><span class="line" line="2"><span class="sTEyZ">    A[customers] --&gt;|feeds| D[orders]
</span></span><span class="line" line="3"><span class="sTEyZ">    B[products] --&gt;|defines| C[product_variants]
</span></span><span class="line" line="4"><span class="sTEyZ">    D --&gt;|requires| E[order_items]
</span></span><span class="line" line="5"><span class="sTEyZ">    C --&gt;|used by| E
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->In Airflow or Dagster, you write DAGs in Python — describing explicitly how tasks depend on one another.
Bruin takes a declarative approach: dependencies are simply listed in YAML under the depends: key, and the system automatically resolves execution order and lineage.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->Unlike Airflow (which just schedules tasks) or dbt (which only supports SQL), Bruin allows you to define transformations in both SQL and Python — directly tied to your ingestion assets.<!--]--></p><div class="relative my-5 overflow-x-auto"><table class="w-full border-separate border-spacing-0 rounded-md"><!--[--><thead class="bg-muted"><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Pipeline Layer<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Bruin Equivalent<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Ingestion (Airbyte, Fivetran)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->type: ingestr<!--]--></code> assets<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Transformation (dbt)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->type: transform<!--]--></code> assets (YML,SQL or Python)<!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Orchestration (Airflow, Dagster)<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Implicit asset graph with <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->depends:<!--]--></code><!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><p class="my-5 leading-7 text-pretty"><!--[-->Now, let&#39;s see if our ingestion layer is working as expected. Using the Bruin CLI, you must run the following command:<!--]--></p><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><!----><span class="text-default text-sm/6">Bruin CLI</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">bruin</span><span class="sfazB"> run</span><span class="sfazB"> orders-performance</span><span class="sfazB"> --tag</span><span class="sfazB"> raw
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->The output must be something like this:<!--]--></p><div class="relative [&amp;_pre]:h-[200px] [&amp;_pre]:overflow-hidden"><!--[--><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sBMFI">Analyzed</span><span class="sfazB"> the</span><span class="sfazB"> pipeline</span><span class="sMK4o"> &#39;</span><span class="sfazB">orders_performance</span><span class="sMK4o">&#39;</span><span class="sfazB"> with</span><span class="sbssI"> 15</span><span class="sfazB"> assets.
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span class="sBMFI">Pipeline:</span><span class="sfazB"> orders_performance</span><span class="sTEyZ"> (.)
</span></span><span class="line" line="4"><span class="sBMFI">  No</span><span class="sfazB"> issues</span><span class="sfazB"> found
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span class="sBMFI">✓</span><span class="sfazB"> Successfully</span><span class="sfazB"> validated</span><span class="sbssI"> 15</span><span class="sfazB"> assets</span><span class="sfazB"> across</span><span class="sbssI"> 1</span><span class="sfazB"> pipeline,</span><span class="sfazB"> all</span><span class="sfazB"> good.
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span class="sBMFI">Interval:</span><span class="sfazB"> 2025-10-17T00:00:00Z</span><span class="sfazB"> -</span><span class="sfazB"> 2025-10-17T23:59:59Z
</span></span><span class="line" line="9"><span class="sBMFI">Starting</span><span class="sfazB"> the</span><span class="sfazB"> pipeline</span><span class="sfazB"> execution...
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span class="sMK4o">[</span><span class="sTEyZ">20:24:23</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  raw.products
</span></span><span class="line" line="12"><span class="sMK4o">[</span><span class="sTEyZ">20:24:23</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  raw.customers
</span></span><span class="line" line="13"><span class="sMK4o">[</span><span class="sTEyZ">20:24:23</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  raw.orders
</span></span><span class="line" line="14"><span class="sMK4o">[</span><span class="sTEyZ">20:24:23</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  raw.product_variants
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span class="s2Zo4">...</span><span class="sfazB">[logs]</span><span class="s2Zo4">...
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span class="sBMFI">PASS</span><span class="sfazB"> raw.products</span><span class="sTEyZ"> 
</span></span><span class="line" line="19"><span class="sBMFI">PASS</span><span class="sfazB"> raw.customers</span><span class="sTEyZ"> 
</span></span><span class="line" line="20"><span class="sBMFI">PASS</span><span class="sfazB"> raw.orders</span><span class="sTEyZ"> 
</span></span><span class="line" line="21"><span class="sBMFI">PASS</span><span class="sfazB"> raw.order_items</span><span class="sTEyZ"> 
</span></span><span class="line" line="22"><span class="sBMFI">PASS</span><span class="sfazB"> raw.product_variants</span><span class="sTEyZ"> 
</span></span><span class="line" line="23"><span emptylineplaceholder="true">
</span></span><span class="line" line="24"><span class="sBMFI">bruin</span><span class="sfazB"> run</span><span class="sfazB"> completed</span><span class="sfazB"> successfully</span><span class="sfazB"> in</span><span class="sfazB"> 16.704s
</span></span><span class="line" line="25"><span emptylineplaceholder="true">
</span></span><span class="line" line="26"><span class="sBMFI"> ✓</span><span class="sfazB"> Assets</span><span class="sfazB"> executed</span><span class="sbssI">      5</span><span class="sfazB"> succeeded
</span></span></code><!--]--></pre></div><!--]--><div class="h-16 absolute inset-x-px bottom-px rounded-b-md flex items-center justify-center bg-gradient-to-t from-muted"><!--[--><!--[--><button type="button" data-state="closed" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors px-2.5 py-1.5 text-sm gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted group"><!--[--><!--[--><span class="iconify i-lucide:chevron-down shrink-0 size-5 group-data-[state=open]:rotate-180" aria-hidden="true" style=""></span><!--]--><!--[--><span class="truncate">Expand code</span><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--></div></div><blockquote class="border-s-4 border-accented ps-4 italic"><!--[--><p class="my-5 leading-7 text-pretty"><!--[-->Note that using the <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->--tag<!--]--></code> option we&#39;ll run only the assets that have the specified tag, avoiding the execution of unnecessary assets.<!--]--></p><!--]--></blockquote><h2 id="_7-implementing-quality-checks-staging-layer" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_7-implementing-quality-checks-staging-layer" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->7) Implementing Quality Checks (Staging layer)<!--]--></a></h2><p class="my-5 leading-7 text-pretty"><!--[-->The staging layer is where raw data gets <strong><!--[-->cleaned, validated, and prepared<!--]--></strong> for analytics. Unlike the raw layer (which mirrors source systems exactly), staging applies business rules, data quality checks, and standardized transformations that make downstream analysis reliable and consistent.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->In Bruin, the staging layer combines <strong><!--[-->SQL transformations<!--]--></strong> with <strong><!--[-->declarative quality checks<!--]--></strong> defined in your <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->columns<!--]--></code> inside an asset.<!--]--></p><!--[--><!----><div class="relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md"><ul class="isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto" tabindex="-1" data-orientation="vertical" dir="ltr" style="outline:none;" role="tree"><!--[--><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-expanded="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-lucide:folder size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">orders-performance</span><span class="ms-auto inline-flex gap-1.5 items-center"><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[expanded=true]:rotate-180" aria-hidden="true" style=""></span></span></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-yaml size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">glossary.yml</span><!----></button><!----><!--]--></li><!--]--><!--]--></ul><div class="overflow-hidden lg:col-span-2 flex flex-col [&amp;&gt;div]:my-0 [&amp;&gt;div]:flex-1 [&amp;&gt;div]:flex [&amp;&gt;div]:flex-col [&amp;&gt;div&gt;div]:border-0 [&amp;&gt;div&gt;pre]:border-b-0 [&amp;&gt;div&gt;pre]:border-s-0 [&amp;&gt;div&gt;pre]:border-e-0 [&amp;&gt;div&gt;pre]:rounded-l-none [&amp;&gt;div&gt;pre]:flex-1 [&amp;&gt;div]:overflow-y-auto"><!----></div></div><!--]--><p class="my-5 leading-7 text-pretty"><!--[-->You can work with column check by adding inside your asset the <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->columns<!--]--></code> the needed definitions for the output of the column that you will materialize:<!--]--></p><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="text-default text-sm/6">orders-performance/assets/staging/stg.customers.asset.sql</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sHwdD">/* @bruin
</span></span><span class="line" line="2"><span class="sHwdD">name: stg.customers
</span></span><span class="line" line="3"><span class="sHwdD">type: duckdb.sql
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span class="sHwdD">materialization:
</span></span><span class="line" line="6"><span class="sHwdD">  type: table
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span class="sHwdD">depends:
</span></span><span class="line" line="9"><span class="sHwdD">  - raw.customers
</span></span><span class="line" line="10"><span class="sHwdD">owner: daniel@gmail.com
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="12"><span class="sHwdD">columns: 
</span></span><span class="line highlight" line="13"><span class="sHwdD">  - name: customer_id 
</span></span><span class="line highlight" line="14"><span class="sHwdD">    type: integer
</span></span><span class="line highlight" line="15"><span class="sHwdD">    primary_key: true
</span></span><span class="line highlight" line="16"><span class="sHwdD">    checks:
</span></span><span class="line highlight" line="17"><span class="sHwdD">      - name: unique
</span></span><span class="line highlight" line="18"><span class="sHwdD">      - name: not_null
</span></span><span class="line" line="19"><span class="sHwdD">@bruin */
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span class="sbssI">SELECT</span><span class="sTEyZ"> 
</span></span><span class="line" line="22"><span class="sTEyZ">  id::</span><span class="spNyl">INT</span><span class="sbssI"> AS</span><span class="sTEyZ"> customer_id, 
</span></span><span class="line" line="23"><span class="s2Zo4">  COALESCE</span><span class="sTEyZ">(</span><span class="s2Zo4">TRIM</span><span class="sTEyZ">(email), </span><span class="sMK4o">&#39;&#39;</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="sTEyZ"> email,
</span></span><span class="line" line="24"><span class="s2Zo4">  COALESCE</span><span class="sTEyZ">(</span><span class="s2Zo4">TRIM</span><span class="sTEyZ">(country), </span><span class="sMK4o">&#39;</span><span class="sfazB">Unknown</span><span class="sMK4o">&#39;</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="sTEyZ"> country,
</span></span><span class="line" line="25"><span class="s2Zo4">  COALESCE</span><span class="sTEyZ">(age, </span><span class="sbssI">0</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="sTEyZ"> age,
</span></span><span class="line" line="26"><span class="sTEyZ">  created_at,
</span></span><span class="line" line="27"><span class="sTEyZ">  updated_at
</span></span><span class="line" line="28"><span class="sbssI">FROM</span><span class="sTEyZ"> raw.customers
</span></span><span class="line" line="29"><span class="sbssI">WHERE</span><span class="sTEyZ"> email </span><span class="sbssI">IS NOT NULL</span><span class="sTEyZ">;
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[--><strong><!--[-->Available Check Types<!--]--></strong><!--]--></p><div class="relative my-5 overflow-x-auto"><table class="w-full border-separate border-spacing-0 rounded-md"><!--[--><thead class="bg-muted"><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Check Type<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Purpose<!--]--></th><th class="py-3 px-4 font-semibold text-sm text-left border-e border-b first:border-s border-t border-muted"><!--[-->Example Configuration<!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->not_null<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Ensures no NULL values<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->- name: not_null<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->unique<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Ensures no duplicate values<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->- name: unique<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->range<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Validates numeric ranges<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->- name: range<!--]--></code><br><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->  min: 0<!--]--></code><br><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->  max: 100<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->accepted_values<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Validates against allowed values<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->- name: accepted_values<!--]--></code><br><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->  value:<!--]--></code><br><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->    - pending<!--]--></code><br><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->    - paid<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->positive<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Ensures positive numbers<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->- name: positive<!--]--></code><!--]--></td><!--]--></tr><tr class="[&amp;:first-child&gt;th:first-child]:rounded-tl-md [&amp;:first-child&gt;th:last-child]:rounded-tr-md [&amp;:last-child&gt;td:first-child]:rounded-bl-md [&amp;:last-child&gt;td:last-child]:rounded-br-md"><!--[--><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->regex<!--]--></code><!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[-->Pattern matching validation<!--]--></td><td class="py-3 px-4 text-sm text-left align-top border-e border-b first:border-s border-muted [&amp;_code]:text-xs/5 [&amp;_p]:my-0 [&amp;_p]:leading-6 [&amp;_ul]:my-0 [&amp;_ol]:my-0 [&amp;_ul]:ps-4.5 [&amp;_ol]:ps-4.5 [&amp;_li]:leading-6 [&amp;_li]:my-0.5"><!--[--><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->- name: regex<!--]--></code><br><code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->  pattern: &#39;^[A-Z]{3}-\d{4}$&#39;<!--]--></code><!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table></div><p class="my-5 leading-7 text-pretty"><!--[-->Bruin&#39;s approach to data quality is <strong><!--[-->declarative and reusable<!--]--></strong>. Instead of writing custom validation SQL for every table, you define <strong><!--[-->entities and attributes<!--]--></strong> in <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->glossary.yml<!--]--></code>, then reference them in your staging assets using the <code class="px-1.5 py-0.5 text-sm font-mono font-medium rounded-md inline-block border border-muted text-highlighted bg-muted"><!--[-->extends:<!--]--></code> keyword.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->Here&#39;s how the column check system works:<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[--><strong><!--[-->Entity Definition in glossary.yml:<!--]--></strong><!--]--></p><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-yaml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="swJcz">entities</span><span class="sMK4o">:
</span></span><span class="line" line="2"><span class="swJcz">  Customer</span><span class="sMK4o">:
</span></span><span class="line" line="3"><span class="swJcz">    description</span><span class="sMK4o">:</span><span class="sfazB"> Customer is an individual/business registered on our platform.
</span></span><span class="line" line="4"><span class="swJcz">    domains</span><span class="sMK4o">:
</span></span><span class="line" line="5"><span class="sMK4o">      -</span><span class="sfazB"> customer-management
</span></span><span class="line" line="6"><span class="swJcz">    attributes</span><span class="sMK4o">:
</span></span><span class="line" line="7"><span class="swJcz">      Email</span><span class="sMK4o">:
</span></span><span class="line" line="8"><span class="swJcz">        name</span><span class="sMK4o">:</span><span class="sfazB"> email
</span></span><span class="line" line="9"><span class="swJcz">        type</span><span class="sMK4o">:</span><span class="sfazB"> string
</span></span><span class="line" line="10"><span class="swJcz">        description</span><span class="sMK4o">:</span><span class="sfazB"> E-mail address used during registration.
</span></span><span class="line" line="11"><span class="swJcz">        checks</span><span class="sMK4o">:
</span></span><span class="line" line="12"><span class="sMK4o">          -</span><span class="swJcz"> name</span><span class="sMK4o">:</span><span class="sfazB"> not_null
</span></span><span class="line" line="13"><span class="swJcz">      Age</span><span class="sMK4o">:
</span></span><span class="line" line="14"><span class="swJcz">        name</span><span class="sMK4o">:</span><span class="sfazB"> age
</span></span><span class="line" line="15"><span class="swJcz">        type</span><span class="sMK4o">:</span><span class="sfazB"> integer
</span></span><span class="line" line="16"><span class="swJcz">        description</span><span class="sMK4o">:</span><span class="sfazB"> Age of the customer.
</span></span><span class="line" line="17"><span class="swJcz">        checks</span><span class="sMK4o">:
</span></span><span class="line" line="18"><span class="sMK4o">          -</span><span class="swJcz"> name</span><span class="sMK4o">:</span><span class="sfazB"> range
</span></span><span class="line" line="19"><span class="swJcz">            min</span><span class="sMK4o">:</span><span class="sbssI"> 0
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->Then, at your asset you could easily just extends it, avoiding duplicate validations across other assets:<!--]--></p><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sHwdD">/* @bruin
</span></span><span class="line" line="2"><span class="sHwdD">columns:
</span></span><span class="line" line="3"><span class="sHwdD">  - extends: Customer.Email    # Inherits not_null check
</span></span><span class="line" line="4"><span class="sHwdD">  - extends: Customer.Age      # Inherits range check (min: 0)
</span></span><span class="line" line="5"><span class="sHwdD">@bruin */
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->For complex validations that go beyond column-level checks, Bruin supports <strong><!--[-->custom checks<!--]--></strong> with SQL queries:<!--]--></p><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sTEyZ">custom_checks:
</span></span><span class="line" line="2"><span class="sMK4o">  -</span><span class="sbssI"> name</span><span class="sTEyZ">: validate product variant sizes
</span></span><span class="line" line="3"><span class="sbssI">    description</span><span class="sTEyZ">: |
</span></span><span class="line" line="4"><span class="sTEyZ">      Ensures that </span><span class="sbssI">if</span><span class="sTEyZ"> the product category </span><span class="sbssI">is</span><span class="sMK4o"> &#39;</span><span class="sfazB">shoes</span><span class="sMK4o">&#39;</span><span class="sTEyZ">, the </span><span class="sbssI">size</span><span class="sTEyZ"> must be </span><span class="spNyl">numeric</span><span class="sTEyZ">.
</span></span><span class="line" line="5"><span class="sTEyZ">      Otherwise, the </span><span class="sbssI">size</span><span class="sTEyZ"> must be one of [&#39;S&#39;, &#39;M&#39;, &#39;L&#39;].
</span></span><span class="line" line="6"><span class="sbssI">    value</span><span class="sTEyZ">: </span><span class="sbssI">0</span><span class="sTEyZ">  # Expected result (</span><span class="sbssI">0</span><span class="sMK4o"> =</span><span class="sbssI"> no</span><span class="sTEyZ"> violations)
</span></span><span class="line" line="7"><span class="sTEyZ">    query: |
</span></span><span class="line" line="8"><span class="sbssI">      SELECT</span><span class="s2Zo4"> COUNT</span><span class="sTEyZ">(</span><span class="sMK4o">*</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="sTEyZ"> invalid_count
</span></span><span class="line" line="9"><span class="sbssI">      FROM</span><span class="sTEyZ"> raw.product_variants v
</span></span><span class="line" line="10"><span class="sbssI">      JOIN</span><span class="sTEyZ"> stg.products p </span><span class="sbssI">ON</span><span class="sTEyZ"> p.product_id </span><span class="sMK4o">=</span><span class="sTEyZ"> v.product_id
</span></span><span class="line" line="11"><span class="sbssI">      WHERE
</span></span><span class="line" line="12"><span class="sTEyZ">        (p.category </span><span class="sMK4o">=</span><span class="sMK4o"> &#39;</span><span class="sfazB">shoes</span><span class="sMK4o">&#39;</span><span class="sbssI"> AND</span><span class="sbssI"> NOT</span><span class="sTEyZ"> (v.size ~ </span><span class="sMK4o">&#39;</span><span class="sfazB">^[0-9]+$</span><span class="sMK4o">&#39;</span><span class="sTEyZ">))
</span></span><span class="line" line="13"><span class="sbssI">        OR</span><span class="sTEyZ"> (p.category </span><span class="sMK4o">!=</span><span class="sMK4o"> &#39;</span><span class="sfazB">shoes</span><span class="sMK4o">&#39;</span><span class="sbssI"> AND</span><span class="sTEyZ"> v.size </span><span class="sbssI">NOT</span><span class="sbssI"> IN</span><span class="sTEyZ"> (</span><span class="sMK4o">&#39;</span><span class="sfazB">S</span><span class="sMK4o">&#39;</span><span class="sTEyZ">, </span><span class="sMK4o">&#39;</span><span class="sfazB">M</span><span class="sMK4o">&#39;</span><span class="sTEyZ">, </span><span class="sMK4o">&#39;</span><span class="sfazB">L</span><span class="sMK4o">&#39;</span><span class="sTEyZ">))
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->Now that we understood the basics of Bruin&#39;s data quality system, let&#39;s run the staging pipeline:<!--]--></p><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sHwdD"># Run all staging assets
</span></span><span class="line" line="2"><span class="sBMFI">bruin</span><span class="sfazB"> run</span><span class="sfazB"> orders-performance</span><span class="sfazB"> --tag</span><span class="sfazB"> staging
</span></span></code><!--]--></pre></div><p class="my-5 leading-7 text-pretty"><!--[-->The output must be like:<!--]--></p><div class="relative [&amp;_pre]:h-[200px] [&amp;_pre]:overflow-hidden"><!--[--><div class="relative my-5 group" style=""><!----><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-bash shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span emptylineplaceholder="true">
</span></span><span class="line" line="2"><span class="sBMFI">Analyzed</span><span class="sfazB"> the</span><span class="sfazB"> pipeline</span><span class="sMK4o"> &#39;</span><span class="sfazB">orders_performance</span><span class="sMK4o">&#39;</span><span class="sfazB"> with</span><span class="sbssI"> 15</span><span class="sfazB"> assets.
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span class="sBMFI">Pipeline:</span><span class="sfazB"> orders_performance</span><span class="sTEyZ"> (.)
</span></span><span class="line" line="5"><span class="sBMFI">  No</span><span class="sfazB"> issues</span><span class="sfazB"> found
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span class="sBMFI">✓</span><span class="sfazB"> Successfully</span><span class="sfazB"> validated</span><span class="sbssI"> 15</span><span class="sfazB"> assets</span><span class="sfazB"> across</span><span class="sbssI"> 1</span><span class="sfazB"> pipeline,</span><span class="sfazB"> all</span><span class="sfazB"> good.
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span class="sBMFI">Interval:</span><span class="sfazB"> 2025-10-17T00:00:00Z</span><span class="sfazB"> -</span><span class="sfazB"> 2025-10-17T23:59:59Z
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span class="sBMFI">Starting</span><span class="sfazB"> the</span><span class="sfazB"> pipeline</span><span class="sfazB"> execution...
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  stg.products
</span></span><span class="line" line="14"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  stg.order_items
</span></span><span class="line" line="15"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  stg.orders
</span></span><span class="line" line="16"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  stg.customers
</span></span><span class="line" line="17"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Finished: stg.products (</span><span class="sBMFI">28ms</span><span class="sTEyZ">)
</span></span><span class="line" line="18"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  stg.product_variants
</span></span><span class="line" line="19"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Finished: stg.orders (</span><span class="sBMFI">57ms</span><span class="sTEyZ">)
</span></span><span class="line" line="20"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Finished: stg.order_items (</span><span class="sBMFI">78ms</span><span class="sTEyZ">)
</span></span><span class="line" line="21"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Finished: stg.customers (</span><span class="sBMFI">101ms</span><span class="sTEyZ">)
</span></span><span class="line" line="22"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Finished: stg.product_variants (</span><span class="sBMFI">89ms</span><span class="sTEyZ">)
</span></span><span class="line" line="23"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Running:  stg.product_variants:custom-check:validate_product_variant_sizes
</span></span><span class="line" line="24"><span class="sMK4o">[</span><span class="sTEyZ">20:59:31</span><span class="sMK4o">]</span><span class="sTEyZ"> Finished: stg.product_variants:custom-check:validate_product_variant_sizes (</span><span class="sBMFI">6ms</span><span class="sTEyZ">)
</span></span><span class="line" line="25"><span emptylineplaceholder="true">
</span></span><span class="line" line="26"><span class="sfazB">==================================================
</span></span><span class="line" line="27"><span emptylineplaceholder="true">
</span></span><span class="line" line="28"><span class="sBMFI">PASS</span><span class="sfazB"> stg.products</span><span class="sTEyZ"> 
</span></span><span class="line" line="29"><span class="sBMFI">PASS</span><span class="sfazB"> stg.orders</span><span class="sTEyZ"> 
</span></span><span class="line" line="30"><span class="sBMFI">PASS</span><span class="sfazB"> stg.order_items</span><span class="sTEyZ"> 
</span></span><span class="line" line="31"><span class="sBMFI">PASS</span><span class="sfazB"> stg.customers</span><span class="sTEyZ"> 
</span></span><span class="line" line="32"><span class="sBMFI">PASS</span><span class="sfazB"> stg.product_variants</span><span class="sfazB"> .
</span></span><span class="line" line="33"><span emptylineplaceholder="true">
</span></span><span class="line" line="34"><span emptylineplaceholder="true">
</span></span><span class="line" line="35"><span class="sBMFI">bruin</span><span class="sfazB"> run</span><span class="sfazB"> completed</span><span class="sfazB"> successfully</span><span class="sfazB"> in</span><span class="sfazB"> 125ms
</span></span><span class="line" line="36"><span emptylineplaceholder="true">
</span></span><span class="line" line="37"><span class="sBMFI"> ✓</span><span class="sfazB"> Assets</span><span class="sfazB"> executed</span><span class="sbssI">      5</span><span class="sfazB"> succeeded
</span></span><span class="line" line="38"><span class="sBMFI"> ✓</span><span class="sfazB"> Quality</span><span class="sfazB"> checks</span><span class="sbssI">       1</span><span class="sfazB"> succeeded
</span></span></code><!--]--></pre></div><!--]--><div class="h-16 absolute inset-x-px bottom-px rounded-b-md flex items-center justify-center bg-gradient-to-t from-muted"><!--[--><!--[--><button type="button" data-state="closed" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors px-2.5 py-1.5 text-sm gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted group"><!--[--><!--[--><span class="iconify i-lucide:chevron-down shrink-0 size-5 group-data-[state=open]:rotate-180" aria-hidden="true" style=""></span><!--]--><!--[--><span class="truncate">Expand code</span><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--></div></div><p class="my-5 leading-7 text-pretty"><!--[-->Each asset runs its quality checks alongside transformations, keeping data accurate at every step. You can reuse validation rules across assets, add business context through glossaries, and rely on incremental checks that catch issues early.<!--]--></p><h2 id="_8-designing-your-analytics-layer-mart" class="relative text-2xl text-highlighted font-bold mt-12 mb-6 scroll-mt-[calc(48px+45px+var(--ui-header-height))] lg:scroll-mt-[calc(48px+var(--ui-header-height))] [&amp;&gt;a]:focus-visible:outline-primary [&amp;&gt;a&gt;code]:border-dashed hover:[&amp;&gt;a&gt;code]:border-primary hover:[&amp;&gt;a&gt;code]:text-primary [&amp;&gt;a&gt;code]:text-xl/7 [&amp;&gt;a&gt;code]:font-bold [&amp;&gt;a&gt;code]:transition-colors"><a href="#_8-designing-your-analytics-layer-mart" class="group lg:ps-2 lg:-ms-2"><span class="absolute -ms-8 top-1 opacity-0 group-hover:opacity-100 group-focus:opacity-100 p-1 bg-elevated hover:text-primary rounded-md hidden lg:flex text-muted transition"><span class="iconify i-lucide:hash size-4 shrink-0" aria-hidden="true" style=""></span></span><!--[-->8) Designing Your Analytics Layer (Mart)<!--]--></a></h2><p class="my-5 leading-7 text-pretty"><!--[-->The analytics (mart) layer turns curated staging tables into business-ready, well-structured datasets. Here we define models with a clear grain, apply final business rules, and expose KPIs for decision-making. These models typically power dashboards and self-service exploration.<!--]--></p><p class="my-5 leading-7 text-pretty"><!--[-->Just like in the Raw and Staging sections above, below is a code tree that shows how the mart is structured in our orders-performance pipeline. Each model consumes stg.* tables and produces clean, documented outputs.<!--]--></p><!--[--><!----><div class="relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md"><ul class="isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto" tabindex="-1" data-orientation="vertical" dir="ltr" style="outline:none;" role="tree"><!--[--><!--[--><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">mart.customers_by_age.asset.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">mart.customers_by_county.asset.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">mart.product_performance.asset.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="true" aria-level="1" data-indent="1" data-selected data-expanded><!--[--><button type="button" data-expanded="true" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 text-highlighted before:bg-elevated"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">mart.sales_daily.asset.sql</span><!----></button><!----><!--]--></li><li data-reka-collection-item tabindex="-1" data-orientation="vertical" role="treeitem" aria-selected="false" aria-level="1" data-indent="1"><!--[--><button type="button" data-expanded="false" class="relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2 hover:text-highlighted hover:before:bg-elevated/50 transition-colors before:transition-colors"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="truncate">mart.variant_profitability.asset.sql</span><!----></button><!----><!--]--></li><!--]--><!--]--></ul><div class="overflow-hidden lg:col-span-2 flex flex-col [&amp;&gt;div]:my-0 [&amp;&gt;div]:flex-1 [&amp;&gt;div]:flex [&amp;&gt;div]:flex-col [&amp;&gt;div&gt;div]:border-0 [&amp;&gt;div&gt;pre]:border-b-0 [&amp;&gt;div&gt;pre]:border-s-0 [&amp;&gt;div&gt;pre]:border-e-0 [&amp;&gt;div&gt;pre]:rounded-l-none [&amp;&gt;div&gt;pre]:flex-1 [&amp;&gt;div]:overflow-y-auto"><div class="relative group [&amp;&gt;pre]:rounded-t-none [&amp;&gt;pre]:my-0 my-5" style=""><div class="flex items-center gap-1.5 border border-muted bg-default border-b-0 relative rounded-t-md px-4 py-3"><span class="iconify i-vscode-icons:file-type-sql size-4 shrink-0" aria-hidden="true" style=""></span><span class="text-default text-sm/6">mart.sales_daily.asset.sql</span></div><!--[--><!--[--><button type="button" aria-label="Copy code to clipboard" tabindex="-1" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 text-xs gap-1.5 ring ring-inset ring-accented text-default bg-default hover:bg-elevated active:bg-elevated disabled:bg-default aria-disabled:bg-default focus:outline-none focus-visible:ring-2 focus-visible:ring-inverted p-1.5 absolute top-[11px] right-[11px] lg:opacity-0 lg:group-hover:opacity-100 transition"><!--[--><!--[--><span class="iconify i-lucide:copy shrink-0 size-4" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></button><!--]--><!--]--><pre class="group font-mono text-sm/6 border border-muted bg-muted rounded-md px-4 py-3 whitespace-pre-wrap break-words overflow-x-auto focus:outline-none language-sql shiki shiki-themes material-theme-lighter material-theme material-theme-palenight" style=""><!--[--><code><span class="line" line="1"><span class="sHwdD">/* @bruin
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span class="sHwdD">name: mart.sales_daily
</span></span><span class="line" line="4"><span class="sHwdD">type: duckdb.sql
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span class="sHwdD">materialization:
</span></span><span class="line" line="7"><span class="sHwdD">  type: table
</span></span><span class="line" line="8"><span class="sHwdD">  strategy: append
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span class="sHwdD">depends:
</span></span><span class="line" line="11"><span class="sHwdD">  - stg.order_items
</span></span><span class="line" line="12"><span class="sHwdD">  - stg.orders
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span class="sHwdD">columns:
</span></span><span class="line" line="15"><span class="sHwdD">  - name: sale_date
</span></span><span class="line" line="16"><span class="sHwdD">    type: date
</span></span><span class="line" line="17"><span class="sHwdD">    checks:
</span></span><span class="line" line="18"><span class="sHwdD">      - name: not_null
</span></span><span class="line" line="19"><span class="sHwdD">  - name: orders_count
</span></span><span class="line" line="20"><span class="sHwdD">    type: integer
</span></span><span class="line" line="21"><span class="sHwdD">    checks:
</span></span><span class="line" line="22"><span class="sHwdD">      - name: not_null
</span></span><span class="line" line="23"><span class="sHwdD">  - name: items_count
</span></span><span class="line" line="24"><span class="sHwdD">    type: integer
</span></span><span class="line" line="25"><span class="sHwdD">    checks:
</span></span><span class="line" line="26"><span class="sHwdD">      - name: not_null
</span></span><span class="line" line="27"><span class="sHwdD">  - name: revenue
</span></span><span class="line" line="28"><span class="sHwdD">    type: numeric
</span></span><span class="line" line="29"><span class="sHwdD">    checks:
</span></span><span class="line" line="30"><span class="sHwdD">      - name: not_null
</span></span><span class="line" line="31"><span emptylineplaceholder="true">
</span></span><span class="line" line="32"><span class="sHwdD">custom_checks:
</span></span><span class="line" line="33"><span class="sHwdD">  - name: total revenue non-negative
</span></span><span class="line" line="34"><span class="sHwdD">    value: 0
</span></span><span class="line" line="35"><span class="sHwdD">    query: SELECT COUNT(*) FROM mart.sales_daily WHERE revenue &lt; 0
</span></span><span class="line" line="36"><span emptylineplaceholder="true">
</span></span><span class="line" line="37"><span class="sHwdD">@bruin */
</span></span><span class="line" line="38"><span emptylineplaceholder="true">
</span></span><span class="line" line="39"><span class="sbssI">WITH</span><span class="sTEyZ"> daily_orders </span><span class="sbssI">AS</span><span class="sTEyZ"> (</span><span class="sbssI">SELECT</span><span class="s2Zo4"> CAST</span><span class="sTEyZ">(</span><span class="s2Zo4">CAST</span><span class="sTEyZ">(order_date </span><span class="sbssI">AS</span><span class="spNyl"> TIMESTAMP</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="spNyl"> DATE</span><span class="sTEyZ">)                               </span><span class="sbssI">AS</span><span class="sTEyZ"> sale_date,
</span></span><span class="line" line="40"><span class="s2Zo4">                             COUNT</span><span class="sTEyZ">(</span><span class="sMK4o">*</span><span class="sTEyZ">)                                                                  </span><span class="sbssI">AS</span><span class="sTEyZ"> orders_count,
</span></span><span class="line" line="41"><span class="s2Zo4">                             SUM</span><span class="sTEyZ">(</span><span class="sbssI">CASE</span><span class="sbssI"> WHEN</span><span class="sbssI"> status</span><span class="sbssI"> IN</span><span class="sTEyZ"> (</span><span class="sMK4o">&#39;</span><span class="sfazB">paid</span><span class="sMK4o">&#39;</span><span class="sTEyZ">, </span><span class="sMK4o">&#39;</span><span class="sfazB">shipped</span><span class="sMK4o">&#39;</span><span class="sTEyZ">) </span><span class="sbssI">THEN</span><span class="sTEyZ"> total_amount </span><span class="sbssI">ELSE</span><span class="sbssI"> 0</span><span class="sbssI"> END</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="sTEyZ"> revenue
</span></span><span class="line" line="42"><span class="sbssI">                      FROM</span><span class="sTEyZ"> stg.orders
</span></span><span class="line" line="43"><span class="sbssI">                      GROUP BY</span><span class="sbssI"> 1</span><span class="sTEyZ">),
</span></span><span class="line" line="44"><span class="sTEyZ">     daily_items </span><span class="sbssI">AS</span><span class="sTEyZ"> (</span><span class="sbssI">SELECT</span><span class="s2Zo4"> CAST</span><span class="sTEyZ">(</span><span class="s2Zo4">CAST</span><span class="sTEyZ">(o.order_date </span><span class="sbssI">AS</span><span class="spNyl"> TIMESTAMP</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="spNyl"> DATE</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="sTEyZ"> sale_date,
</span></span><span class="line" line="45"><span class="s2Zo4">                            COUNT</span><span class="sTEyZ">(</span><span class="sMK4o">*</span><span class="sTEyZ">)                                      </span><span class="sbssI">AS</span><span class="sTEyZ"> items_count
</span></span><span class="line" line="46"><span class="sbssI">                     FROM</span><span class="sTEyZ"> stg.order_items oi
</span></span><span class="line" line="47"><span class="sbssI">                            JOIN</span><span class="sTEyZ"> stg.orders o </span><span class="sbssI">ON</span><span class="sTEyZ"> o.order_id </span><span class="sMK4o">=</span><span class="sTEyZ"> oi.order_id
</span></span><span class="line" line="48"><span class="sbssI">                     GROUP BY</span><span class="sbssI"> 1</span><span class="sTEyZ">)
</span></span><span class="line" line="49"><span class="sbssI">SELECT</span><span class="sTEyZ"> d.sale_date,
</span></span><span class="line" line="50"><span class="sTEyZ">       d.orders_count,
</span></span><span class="line" line="51"><span class="s2Zo4">       COALESCE</span><span class="sTEyZ">(i.items_count, </span><span class="sbssI">0</span><span class="sTEyZ">) </span><span class="sbssI">AS</span><span class="sTEyZ"> items_count,
</span></span><span class="line" line="52"><span class="sTEyZ">       d.revenue
</span></span><span class="line" line="53"><span class="sbssI">FROM</span><span class="sTEyZ"> daily_orders d
</span></span><span class="line" line="54"><span class="sbssI">ORDER BY</span><span class="sTEyZ"> sale_date;
</span></span></code><!--]--></pre></div></div></div><!--]--><p class="my-5 leading-7 text-pretty"><!--[-->::<!--]--></p><ProseCodeTreeFromPath path="/examples/pipeline" default-value="main.sql" expand-all><p class="my-5 leading-7 text-pretty"><!--[-->::<!--]--></p></ProseCodeTreeFromPath><style>html pre.shiki code .swJcz, html code.shiki .swJcz{--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178}html pre.shiki code .sMK4o, html code.shiki .sMK4o{--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF}html pre.shiki code .sfazB, html code.shiki .sfazB{--shiki-light:#91B859;--shiki-default:#C3E88D;--shiki-dark:#C3E88D}html pre.shiki code .sbssI, html code.shiki .sbssI{--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C}html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sfNiH, html code.shiki .sfNiH{--shiki-light:#FF5370;--shiki-default:#FF9CAC;--shiki-dark:#FF9CAC}html pre.shiki code .sHwdD, html code.shiki .sHwdD{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#546E7A;--shiki-default-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic}html pre.shiki code .sTEyZ, html code.shiki .sTEyZ{--shiki-light:#90A4AE;--shiki-default:#EEFFFF;--shiki-dark:#BABED8}html pre.shiki code .s2Zo4, html code.shiki .s2Zo4{--shiki-light:#6182B8;--shiki-default:#82AAFF;--shiki-dark:#82AAFF}html pre.shiki code .spNyl, html code.shiki .spNyl{--shiki-light:#9C3EDA;--shiki-default:#C792EA;--shiki-dark:#C792EA}html pre.shiki code .sBMFI, html code.shiki .sBMFI{--shiki-light:#E2931D;--shiki-default:#FFCB6B;--shiki-dark:#FFCB6B}html pre.shiki code .s7zQu, html code.shiki .s7zQu{--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#89DDFF;--shiki-default-font-style:italic;--shiki-dark:#89DDFF;--shiki-dark-font-style:italic}html pre.shiki code .sHdIc, html code.shiki .sHdIc{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#EEFFFF;--shiki-default-font-style:italic;--shiki-dark:#BABED8;--shiki-dark-font-style:italic}</style></div><div data-orientation="horizontal" role="separator" class="flex items-center align-center text-center w-full flex-row"><!--[--><!--[--><div class="border-default w-full border-solid border-t"></div><!----><!--]--><!--]--></div><!--[--><!----><div class="grid grid-cols-1 sm:grid-cols-2 gap-8"><a href="/getting-started" class="group block px-6 py-8 rounded-lg border border-default hover:bg-elevated/50 focus-visible:outline-primary transition-colors"><!--[--><!--[--><!--[--><div class="inline-flex items-center rounded-full p-1.5 bg-elevated group-hover:bg-primary/10 ring ring-accented mb-4 group-hover:ring-primary/50 transition"><!--[--><span class="iconify i-lucide:house size-5 shrink-0 text-highlighted group-hover:text-primary transition-[color,translate] group-active:-translate-x-0.5" aria-hidden="true" style=""></span><!--]--></div><p class="font-medium text-[15px] text-highlighted mb-1 truncate"><!--[-->Introduction<!--]--></p><p class="text-sm text-muted line-clamp-2"><!--[-->Welcome to Bruin University.<!--]--></p><!--]--><!--]--><!--]--></a><span class="hidden lg:block"> </span></div><!--]--><!--]--></div><!--]--></div><!--[--><!----><!----><nav data-state="closed" class="sticky top-(--ui-header-height) z-10 bg-default/75 lg:bg-[initial] backdrop-blur -mx-4 px-4 sm:px-6 sm:-mx-6 overflow-y-auto max-h-[calc(100vh-var(--ui-header-height))] lg:col-span-2 order-first lg:order-last"><!--[--><div class="pt-4 sm:pt-6 pb-2.5 sm:pb-4.5 lg:py-8 border-b border-dashed border-default lg:border-0 flex flex-col"><!----><!--[--><button type="button" aria-controls aria-expanded="false" data-state="closed" class="group text-sm font-semibold flex-1 flex items-center gap-1.5 py-1.5 -mt-1.5 focus-visible:outline-primary lg:hidden"><!--[--><!--[--><!--[--><!--]--><span class="truncate"><!--[-->Table of Contents<!--]--></span><span class="ms-auto inline-flex gap-1.5 items-center"><!--[--><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[state=open]:rotate-180 lg:hidden" aria-hidden="true" style=""></span><!--]--></span><!--]--><!--]--></button><div class="data-[state=open]:animate-[collapsible-down_200ms_ease-out] data-[state=closed]:animate-[collapsible-up_200ms_ease-out] overflow-hidden focus:outline-none lg:hidden" id="reka-collapsible-content-v-0-5-4-0" hidden data-state="closed" style="--reka-collapsible-content-height:0px;--reka-collapsible-content-width:0px;"><!--v-if--></div><p class="group text-sm font-semibold flex-1 items-center gap-1.5 py-1.5 -mt-1.5 focus-visible:outline-primary hidden lg:flex"><!--[--><!--[--><!--]--><span class="truncate"><!--[-->Table of Contents<!--]--></span><span class="ms-auto inline-flex gap-1.5 items-center"><!--[--><span class="iconify i-lucide:chevron-down size-5 transform transition-transform duration-200 shrink-0 group-data-[state=open]:rotate-180 lg:hidden" aria-hidden="true" style=""></span><!--]--></span><!--]--></p><div class="data-[state=open]:animate-[collapsible-down_200ms_ease-out] data-[state=closed]:animate-[collapsible-up_200ms_ease-out] overflow-hidden focus:outline-none hidden lg:flex"><!----><!--[--><ul class="min-w-0"><!--[--><li class="min-w-0"><a href="#what-this-hands-on-tutorial-covers" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">What this hands-on tutorial covers</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_1-prerequisites-setup" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">1) Prerequisites &amp; Setup</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_2-understanding-the-data-model-oltp-analytics" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">2) Understanding the Data Model (OLTP → Analytics)</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_3-setting-up-the-source-database-docker-postgres" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">3) Setting Up the Source Database (Docker + Postgres)</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_4-populating-test-data" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">4) Populating Test Data</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_5-creating-the-bruin-pipeline" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">5) Creating the Bruin Pipeline</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_6-raw-ingestion-assets" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">6. Raw Ingestion Assets</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_7-implementing-quality-checks-staging-layer" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">7) Implementing Quality Checks (Staging layer)</span><!--]--></a><!----></li><li class="min-w-0"><a href="#_8-designing-your-analytics-layer-mart" class="group relative text-sm flex items-center focus-visible:outline-primary py-1 text-muted hover:text-default transition-colors"><!--[--><span class="truncate">8) Designing Your Analytics Layer (Mart)</span><!--]--></a><!----></li><!--]--></ul><!--]--></div><!--]--><div class="hidden lg:flex lg:flex-col gap-6 mt-6"><!--[--><div class="hidden lg:block space-y-6 !mt-6"><div data-orientation="horizontal" role="separator" class="flex items-center align-center text-center w-full flex-row"><!--[--><!--[--><div class="border-default w-full border-dashed border-t"></div><!----><!--]--><!--]--></div><nav class="flex flex-col gap-3"><p class="text-sm font-semibold flex items-center gap-1.5"><!--[-->Community<!--]--></p><ul class="flex flex-col gap-2"><!--[--><li class="relative"><!--[--><!--[--><a href="https://github.com/nuxt-ui-templates/docs/edit/main/content/2.tutorials/1.ecommerce-pipeline.md" rel="noopener noreferrer" target="_blank" class="group text-sm flex items-center gap-1.5 focus-visible:outline-primary text-muted hover:text-default transition-colors"><!--[--><!--[--><!--[--><span class="iconify i-lucide:external-link size-5 shrink-0" aria-hidden="true" style=""></span><!--]--><span class="truncate"><!--[-->Edit this page<!--]--><span class="iconify i-lucide:arrow-up-right size-3 absolute top-0 text-dimmed" aria-hidden="true" style=""></span></span><!--[--><!--]--><!--]--><!--]--></a><!--]--><!--]--></li><li class="relative"><!--[--><!--[--><a href="https://github.com/nuxt/ui" rel="noopener noreferrer" target="_blank" class="group text-sm flex items-center gap-1.5 focus-visible:outline-primary text-muted hover:text-default transition-colors"><!--[--><!--[--><!--[--><span class="iconify i-lucide:star size-5 shrink-0" aria-hidden="true" style=""></span><!--]--><span class="truncate"><!--[-->Star on GitHub<!--]--><span class="iconify i-lucide:arrow-up-right size-3 absolute top-0 text-dimmed" aria-hidden="true" style=""></span></span><!--[--><!--]--><!--]--><!--]--></a><!--]--><!--]--></li><li class="relative"><!--[--><!--[--><a href="https://ui.nuxt.com/docs/getting-started/installation/nuxt" rel="noopener noreferrer" target="_blank" class="group text-sm flex items-center gap-1.5 focus-visible:outline-primary text-muted hover:text-default transition-colors"><!--[--><!--[--><!--[--><span class="iconify i-lucide:book-open size-5 shrink-0" aria-hidden="true" style=""></span><!--]--><span class="truncate"><!--[-->Nuxt UI docs<!--]--><span class="iconify i-lucide:arrow-up-right size-3 absolute top-0 text-dimmed" aria-hidden="true" style=""></span></span><!--[--><!--]--><!--]--><!--]--></a><!--]--><!--]--></li><!--]--></ul></nav></div><!--]--></div></div><!--]--></nav><!--]--></div><!--]--><!--]--></div><!----></div><!--]--></div><!--]--></main><footer class="border-t border-default"><!----><div class="w-full max-w-(--ui-container) mx-auto px-4 sm:px-6 lg:px-8 py-8 lg:py-4 lg:flex lg:items-center lg:justify-between lg:gap-x-3"><!--[--><div class="lg:flex-1 flex items-center justify-center lg:justify-end gap-x-1.5 lg:order-3"><!--[--><!----><!--[--><!--[--><!--[--><a href="https://go.nuxt.com/discord" rel="noopener noreferrer" target="_blank" aria-label="Nuxt on Discord" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors text-sm gap-1.5 text-default hover:bg-elevated active:bg-elevated focus:outline-none focus-visible:bg-elevated hover:disabled:bg-transparent dark:hover:disabled:bg-transparent hover:aria-disabled:bg-transparent dark:hover:aria-disabled:bg-transparent p-1.5"><!--[--><!--[--><span class="iconify i-simple-icons:discord shrink-0 size-5" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></a><!--]--><!--]--><!--[--><!--[--><a href="https://go.nuxt.com/x" rel="noopener noreferrer" target="_blank" aria-label="Nuxt on X" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors text-sm gap-1.5 text-default hover:bg-elevated active:bg-elevated focus:outline-none focus-visible:bg-elevated hover:disabled:bg-transparent dark:hover:disabled:bg-transparent hover:aria-disabled:bg-transparent dark:hover:aria-disabled:bg-transparent p-1.5"><!--[--><!--[--><span class="iconify i-simple-icons:x shrink-0 size-5" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></a><!--]--><!--]--><!--[--><!--[--><a href="https://github.com/nuxt/ui" rel="noopener noreferrer" target="_blank" aria-label="Nuxt UI on GitHub" class="rounded-md font-medium inline-flex items-center disabled:cursor-not-allowed aria-disabled:cursor-not-allowed disabled:opacity-75 aria-disabled:opacity-75 transition-colors text-sm gap-1.5 text-default hover:bg-elevated active:bg-elevated focus:outline-none focus-visible:bg-elevated hover:disabled:bg-transparent dark:hover:disabled:bg-transparent hover:aria-disabled:bg-transparent dark:hover:aria-disabled:bg-transparent p-1.5"><!--[--><!--[--><span class="iconify i-simple-icons:github shrink-0 size-5" aria-hidden="true" style=""></span><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--><!--]--></a><!--]--><!--]--><!--]--><!--]--></div><div class="mt-3 lg:mt-0 lg:order-2 flex items-center justify-center"><!--[--><!--]--></div><div class="flex items-center justify-center lg:justify-start lg:flex-1 gap-x-1.5 mt-3 lg:mt-0 lg:order-1 text-sm text-muted"><!--[-->Built with Nuxt UI • © 2025<!--]--></div><!--]--></div><!----></footer><span></span><!--]--><!--]--><!--[--><!--]--><!--v-if--><!--]--><!--[--><!--]--><!--]--><!--]--></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/tutorials/ecommerce-pipeline/_payload.json?005c2f49-71f6-4db7-9ce9-af20ab351679">[{"state":1,"once":14,"_errors":15,"serverRendered":5,"path":17,"prerenderedAt":18},["Reactive",2],{"$scolor-mode":3,"$stoasts":7,"$ssite-config":8},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,[],{"_priority":9,"env":12,"name":13},{"name":10,"env":11},-10,-15,"production","nuxt-ui-template-docs",["Set"],["ShallowReactive",16],{"navigation":-1,"search":-1,"/tutorials/ecommerce-pipeline":-1,"/tutorials/ecommerce-pipeline-surround":-1},"/tutorials/ecommerce-pipeline",1760922605344]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{wsUrl:""},mdc:{components:{prose:true,map:{accordion:"ProseAccordion","accordion-item":"ProseAccordionItem",badge:"ProseBadge",callout:"ProseCallout",card:"ProseCard","card-group":"ProseCardGroup",caution:"ProseCaution","code-collapse":"ProseCodeCollapse","code-group":"ProseCodeGroup","code-icon":"ProseCodeIcon","code-preview":"ProseCodePreview","code-tree":"ProseCodeTree",collapsible:"ProseCollapsible",field:"ProseField","field-group":"ProseFieldGroup",icon:"ProseIcon",kbd:"ProseKbd",note:"ProseNote",steps:"ProseSteps",tabs:"ProseTabs","tabs-item":"ProseTabsItem",tip:"ProseTip",warning:"ProseWarning"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},preview:{api:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""}},app:{baseURL:"/",buildId:"005c2f49-71f6-4db7-9ce9-af20ab351679",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>